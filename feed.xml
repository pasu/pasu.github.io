<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en"><generator uri="https://jekyllrb.com/" version="4.4.1">Jekyll</generator><link href="https://pasu.github.io/feed.xml" rel="self" type="application/atom+xml"/><link href="https://pasu.github.io/" rel="alternate" type="text/html" hreflang="en"/><updated>2025-07-20T12:54:59+00:00</updated><id>https://pasu.github.io/feed.xml</id><title type="html">blank</title><subtitle>Personal website of Peter Lu </subtitle><entry><title type="html">DDG Discrete Curvatures</title><link href="https://pasu.github.io/blog/2025/GIS/" rel="alternate" type="text/html" title="DDG Discrete Curvatures"/><published>2025-07-18T00:00:00+00:00</published><updated>2025-07-18T00:00:00+00:00</updated><id>https://pasu.github.io/blog/2025/GIS</id><content type="html" xml:base="https://pasu.github.io/blog/2025/GIS/"><![CDATA[<h1 id="gis是天坑专业吗">GIS是“天坑专业”吗？</h1> <p>这是知乎上的一个问题，刚才休息时随手写一下回答，没想到越写越多，本着肥水不流外人田的原则，那就写在公众号吧。</p> <h2 id="从cs人的角度看gis融合交叉杂而精">从CS人的角度看GIS：融合、交叉、杂而精</h2> <p>严格来说，我不是GIS专业出身，但因工作机缘，进入GIS研发领域已有多年。本科时修过一门GIS必修课，与GIS专业的同学一起上过课。从那时起，我便开始从计算机科学（CS）的角度观察、理解这门交叉学科。</p> <p>我一直觉得，GIS本质上是一门高度融合的学科，像那句颇具争议但耐人寻味的话说的那样：“<strong>GIS is not science</strong>”。它的研究和应用范围极其广阔：上至宇宙建模，下至一个GPS点的精准定位。从这个角度看，GIS天然具备<strong>multi-level、多尺度、多维度</strong>的特征。它可以在 zoom in 与 zoom out 的过程中，寻找与“Geo”结合的“X”，从而衍生出各种“GeoX”的研究与应用方向。</p> <p>至于“IS”（Information System）部分，更是深深依附于计算机的发展。从操作系统、数据库、Web开发，到CPU、GPU、XR终端，再到元宇宙和AI，GIS技术就像痴情舔狗，紧跟CS技术的每一次进化。甚至可以说，哪怕是CS的“一坨屎”，GIS也能吃出花样来。</p> <h2 id="所以gis是天坑专业吗">所以GIS是“天坑专业”吗？</h2> <p>我不这么认为。相反，我觉得GIS是一门非常有价值、极具潜力，而且非常有趣的专业。</p> <p>一方面，它横跨众多领域，可以做的事情非常多——“他山之石，可以攻玉”。只要找到一个自己真正感兴趣的点，就有机会无限的连接微观与宏观，成为一个最有意义的小事。</p> <p>另一方面，GIS的很多应用都有着明确的现实价值。比如Google Maps、Google Earth等产品，成为我们日常生活不可或缺的工具。相比之下，很多游戏可能娱乐性强，但社会价值的讨论空间则要小一些。</p> <p>就我个人而言，虽然这些年只是国家发展中的一头牛马，但至少我知道，自己是在为国家和社会做一些有意义的事。这点让我感到自豪。当然，这只是个人很主观的看法。</p> <h2 id="cs人注重建模gis人善于想象">CS人注重建模，GIS人善于想象？</h2> <p>从个人经验来看，CS出身的人往往注重<strong>细节与建模</strong>，无论在高层还是底层，都倾向于用方法、公式和模型将问题量化。而GIS行业的一些从业者，则更擅长<strong>宏观叙述</strong>，更鼓励“格局要大”、“只要你敢想”，具体实现自然会有人来做。你要是讨论细节，很可能被视为“下面的人”。</p> <p>于是一个有趣的反差出现了：GIS领域有一本书叫“<strong>Modelling the World</strong>”，但真正沉下心来去建模、去实现的，往往却是CS背景的人。那些真正改变世界的GIS产品，比如Google Maps、Google Earth，其核心技术团队大多来自计算机科学领域。甚至可以说，口号喊得响的人,又有几个人读过《Modelling the World》这本书。</p> <p>所以，GIS是不是天坑？我仍坚持认为，不是GIS的问题，而是GISer们没有把这件事真正做出来。</p> <h2 id="为什么难做出来现实并不简单">为什么难做出来？现实并不简单</h2> <p>这个问题让GISer来背锅，也是不公平的。</p> <p>一方面，CS的前景与“钱景”都比GIS更加广阔，资金、人力、资源优势明显。很多人总以为，一个行业的发展要靠“大神”、“大牛”撑起来。但我更愿意从底层逻辑讲一句反话：只有行业的“人群基数”足够大，才能自然诞生出成比例的“大牛”。同理，也会有更多“SB”，Sun Boy，阳光男孩。每一个“牛人”都从天而降？其实更多的是在一个允许“试错”的行业中，成千上万个Sun Boy不断试、不断错，最终有些人成了“大牛”，有些人成了“垫脚石”。</p> <p>另一方面，GIS对从业者的知识结构要求很高。你需要对多个领域都具备至少80%的理解，才能支撑起系统的设计与实现。而这种“平均高水平”的知识掌握，并不是智商问题，而是学习效率问题。我的一个观点是：<strong>多数人都可以通过中规中矩的努力，高效掌握一个领域的80%内容。更重要的是，效率是非线性的，越学越快。</strong></p> <p>这样的人才，必须被聚集在一起，交流讨论，才能打造出真正优秀的GIS产品。</p> <p>我们经常能看到游戏开发者热血分享初心，比如《星露谷物语》的作者；也能看到CS工程师分享他们的产品梦想，比如Google Maps 的幕后故事（推荐读《Never Lost Again》）。但如果我对同事说，“我们将来可以建一个太阳系、银河系的模型”，设想旅行者一号现在的位置，思考双精度是否已经不够用时，他们反问的可能是：“这能赚钱吗？”</p> <p><strong>这是现实的压力</strong>。人有五种需求，一个行业也必须先满足最基本的“生存需求”，才谈得上“实现理想”。</p> <h2 id="cs在上gis在上体系的认知之争">CS在上？GIS在上？体系的认知之争</h2> <p>另一个让我印象深刻的，是GIS与CS之间在知识体系上的“认知差异”。</p> <p>很多GIS从业者认为，CS只是GIS体系中的一部分，GIS在更高的“应用整合层”；而CS人则可能认为GIS只是CS的一个分支，比如空间数据库、开放世界、GIS是计算机众多应用中的一种何交叉。</p> <p>这种差异，再次印证了那句话：“<strong>人心中的成见，就像一座大山，任你怎么努力也休想搬动。</strong>”</p> <h2 id="一个不小心就干了十几年我的gis之路">一个不小心就干了十几年：我的GIS之路</h2> <p>我本科专业是信息管理。还记得大一开学，系主任上第一门课时，问我们为什么选择这个专业。他点中了我，我当时觉得这问题就是为我量身定做的，顺口回答：“我来自山东，学校的计算机专业在我们省没招生，所以选了信息管理，因为课程重叠很多。”当时我没察觉到老师尴尬而不是礼貌的微笑。更有趣的是，毕业那年 2006，学校觉得管理学更洋气一些，把我们这个学科分到了管理学科而非工科，所以我本科学士服可是粉色带子的，我注定成为了时代中的一枚黑粉，BP in your area~</p> <p>毕业后，我进入了超图，误打误撞的进入了GIS领域。当时公司还在中科院地理所办公。找到工作后，舅舅让我拍张公司大楼照片发他，我拍了地理所的楼，但“战术性”地避开了那几个字。他看完后说：“嗯，是家大公司。”没想到，这一干就是十多年。</p> <p>现在，我的重心更多放在计算机技术与研究上，但也持续关注GIS领域的动态。</p> <p>所以，我个人认为，<strong>以计算机为基础，去解决GIS中的实际问题</strong>，是一件非常有意义且对我而言有趣的事情。</p>]]></content><author><name></name></author><category term="DDG"/><category term="Geometry"/><summary type="html"><![CDATA[GIS是“天坑专业”吗？]]></summary></entry><entry><title type="html">DDG Discrete Curvatures</title><link href="https://pasu.github.io/blog/2025/Discrete_Curvatures/" rel="alternate" type="text/html" title="DDG Discrete Curvatures"/><published>2025-07-12T00:00:00+00:00</published><updated>2025-07-12T00:00:00+00:00</updated><id>https://pasu.github.io/blog/2025/Discrete_Curvatures</id><content type="html" xml:base="https://pasu.github.io/blog/2025/Discrete_Curvatures/"><![CDATA[<p>原课件来自：https://brickisland.net/ddg-web/</p> <h2 id="discrete-curvature">Discrete Curvature</h2> <p>上一节中，平滑的曲面曲率有多种表达形式：</p> <ul> <li><strong>高斯曲率（Gauss Curvature）</strong>：$K = k_1 k_2$</li> <li><strong>平均曲率（Mean Curvature）</strong>：$H = (k_1 + k_2)/2$</li> <li><strong>主曲率（Principal Curvatures）</strong>： k_1, k_2（最大/最小曲率）</li> <li><strong>法曲率（Normal Curvature）</strong></li> <li><strong>测地曲率（Geodesic Curvature）</strong></li> </ul> <p>因此，光滑曲率的离散化看似有无数种不相关的方法，实际上存在统一框架可以解释大多数常见离散化选择。</p> <h3 id="统一视角unified-picture">统一视角（Unified Picture）</h3> <p>通过将光滑曲面与离散曲面建立联系，我们可以在统一的框架下理解许多散见于文献中的不同离散曲率定义。这样不仅有助于从微分几何的连续视角解释常用的离散曲率（如角缺陷(Angle Defect)、高斯曲率、平均曲率的边长度加权和等），还可以揭示它们与光滑情形中体积、面积及其变分的深刻对应关系，从而为几何处理、数值模拟和计算机图形学中的曲率计算提供更直观和理论一致的基础。</p> <h3 id="discrete-gaussian-curvature">Discrete Gaussian Curvature</h3> <h4 id="欧拉示性数-euler-characteristic">欧拉示性数 (Euler Characteristic)</h4> <p>对于多面体曲面（Polyhedral Surface），欧拉示性数定义为：</p> \[\chi = V - E + F\] <p>其中：</p> <ul> <li>$ V $：顶点数（Vertices）</li> <li>$ E $：边数（Edges）</li> <li>$ F $：面数（Faces）</li> </ul> <p><strong>示例</strong>：</p> <ul> <li><strong>球面（Sphere）</strong>：$\chi = 2$（如立方体：8顶点、12边、6面 → 8-12+6=2）</li> <li><strong>环面（Torus）</strong>：$\chi = 0$（如四边形环面：16顶点、32边、16面 → 16-32+16=0）</li> <li><strong>双环面（Genus-2 Surface）</strong>：$\chi = -2$（推广公式：$\chi = 2 - 2g$，$g$为亏格）</li> </ul> <h4 id="topological-invariance">Topological Invariance</h4> <p><strong>定理（L’Huilier）</strong>：</p> <p>欧拉示性数是多面体曲面的<strong>拓扑不变量</strong>，即：</p> <ul> <li>与顶点的具体位置无关</li> <li>与曲面的细分方式（Tessellation）无关<br/> 仅由曲面的<strong>拓扑类型（Topology）</strong>决定。</li> </ul> \[\chi = 2 - 2g\] <p>其中 $ g $ 是曲面的Genus（即“洞”的数量）, $\chi$是欧拉示性数。</p> <p>例如：</p> <ul> <li>球面（$g=0$）：$\chi = 2$</li> <li>环面（$g=1$）：$\chi = 0$</li> <li>双环面（$g=2$）：$\chi = -2$</li> </ul> <h4 id="angle-defect">Angle Defect</h4> <p>对于离散曲面（如三角网格）的顶点 $ i $，其角度缺损定义为：</p> \[\Omega_i = 2\pi - \sum_{ijk \in \text{St}(i)} \theta_i^{jk}\] <p>其中：</p> <ul> <li>$ \theta_i^{jk} $ 是顶点 $ i $ 在相邻三角形 $ ijk $ 中的内角，</li> <li>$ \text{St}(i) $ 表示顶点 $ i $ 的邻域（Star）。</li> </ul> <p>通过<strong>测地球（Geodesic Ball）</strong>的面积比较，离散高斯曲率 $ K_i $ 与角度缺损直接相关：</p> <p><strong>(1) 连续曲面的高斯曲率</strong></p> <p>在光滑曲面中，半径为 $ \epsilon $ 的测地球面积与平面圆面积 $ \pi \epsilon^2 $ 的偏差反映高斯曲率：</p> \[|B_g(\epsilon)| = \pi \epsilon^2 \left( 1 - \frac{K}{12} \epsilon^2 + O(\epsilon^3) \right)\] <p><strong>(2) 离散曲面的测地球面积</strong></p> <p>对于离散曲面：</p> <ul> <li> <table> <tbody> <tr> <td><strong>欧几里得圆面积</strong>：$</td> <td>B_{\mathbb{R}^2}(\epsilon)</td> <td>= \pi \epsilon^2 $。</td> </tr> </tbody> </table> </li> <li> <p><strong>测地楔形面积</strong>（Geodesic Wedge）：顶点 $ i $ 的贡献为：</p> \[W_i(\epsilon) = \frac{\theta_i}{2\pi} \cdot \pi \epsilon^2 = \frac{1}{2} \epsilon^2 \theta_i\] <p>其中 $ \theta_i $ 是顶点邻域的总角度。</p> </li> <li> <p><strong>总测地球面积</strong>：</p> \[|B_g(\epsilon)| = \sum_i W_i(\epsilon) = \frac{\epsilon^2}{2} \sum_i \theta_i\] </li> </ul> <p><strong>(3) 曲率与角度缺损的关系</strong></p> <p>对比连续与离散的面积公式：</p> \[\frac{\epsilon^2}{12} K_i \approx 1 - \frac{\sum_i \theta_i}{2\pi}\] <p>整理后得到：</p> \[\Omega_i = 2\pi - \sum_i \theta_i = \frac{\pi}{6} \epsilon^2 K_i\] <p>可以把角缺陷看作一种积分曲率：它不是在一点上给出曲率的瞬时值，而是将曲率在顶点周围的小邻域上积分后的结果。这样角缺陷就自然对应于光滑曲面上的高斯曲率积分（即Gauss-Bonnet定理中的项），为离散几何提供了与连续曲率概念一致的几何直觉。</p> <h4 id="边界曲率的离散化">边界曲率的离散化</h4> <p><strong>边界顶点特性</strong>：</p> <ol> <li><strong>高斯曲率为零</strong>：<br/> 边界邻域可展平到平面（无角度缺损，$ \Omega_i = 0 $）。</li> <li> <p><strong>测地曲率（Geodesic Curvature）</strong>：<br/> 通过边界顶点的<strong>外角缺损</strong>定义：</p> \[\kappa_i = \pi - \sum_{ijk \in \text{Boundary}} \theta_i^{jk}\] <p><strong>物理意义</strong>：度量边界“弯曲程度”（如直边 $ \kappa_i = 0 $）。</p> </li> </ol> <p><strong>离散高斯-博内定理（带边界）</strong>：</p> \[\sum_{i \in \text{Interior}} \Omega_i + \sum_{i \in \text{Boundary}} \kappa_i = 2\pi \chi\] <p><strong>高斯曲率的近似方法对比</strong></p> <table> <thead> <tr> <th><strong>方法</strong></th> <th><strong>优点</strong></th> <th><strong>缺点</strong></th> </tr> </thead> <tbody> <tr> <td><strong>角度缺损法</strong></td> <td>严格满足离散高斯-博内定理</td> <td>仅对特定顶点价数（4或6）收敛到连续曲率</td> </tr> <tr> <td><strong>二次曲面拟合</strong></td> <td>更接近光滑曲率定义</td> <td>不保证全局拓扑性质（如高斯-博内定理）</td> </tr> <tr> <td><strong>基于Mollification</strong></td> <td>物理直观（如Steiner公式）</td> <td>计算复杂</td> </tr> </tbody> </table> <ul> <li><strong>无统一最优方法</strong>，需根据应用选择（如拓扑分析优先角度缺损法，几何建模可选拟合方法）。</li> <li><strong>角度缺损法</strong>因保留拓扑性质，在理论推导中更受青睐。</li> </ul> <h3 id="curvature-normals">Curvature Normals</h3> <p><strong>三种基本曲率法向量</strong></p> <p>在微分几何中，曲面的几何信息可通过以下三种2-形式（2-forms）自然表达：</p> <table> <thead> <tr> <th><strong>类型</strong></th> <th><strong>光滑形式</strong></th> <th><strong>离散形式</strong></th> <th><strong>物理意义</strong></th> </tr> </thead> <tbody> <tr> <td><strong>面积法向量</strong></td> <td>$ \frac{1}{2} df \wedge df = N \, dA $</td> <td>$ \frac{1}{6} \sum_{ijk} f_j \times f_k $ （顶点邻域叉积和）</td> <td>曲面的定向面积</td> </tr> <tr> <td><strong>平均曲率法向量</strong></td> <td>$ \frac{1}{2} df \wedge dN = HN \, dA $</td> <td>$ \frac{1}{2} \sum_{ij} (\cot \alpha_{ij} + \cot \beta_{ij})(f_i - f_j) $</td> <td>曲面的平均弯曲程度</td> </tr> <tr> <td><strong>高斯曲率法向量</strong></td> <td>$ \frac{1}{2} dN \wedge dN = KN \, dA $</td> <td>$ \frac{1}{2} \sum_{ij} \frac{\varphi_{ij}}{\ell_{ij}} (f_j - f_i) $</td> <td>曲面的内在曲率（如“尖峰”或“鞍部”）</td> </tr> </tbody> </table> <p><strong>主曲率方向（Principal Directions）</strong></p> <ul> <li><strong>定义</strong>：主方向 $ X_1, X_2 $ 是曲面上弯曲最大和最小的方向，对应主曲率 $ \kappa_1, \kappa_2 $。</li> <li> <p><strong>关键关系</strong>：法向量的微分与曲面微分通过<strong>Weingarten方程</strong>关联：</p> \[dN(X_i) = -\kappa_i \, df(X_i)\] <p>这一关系是推导曲率法向量的核心。</p> </li> </ul> <p><strong>面积法向量的推导</strong></p> \[df \wedge df(X_1, X_2) = df(X_1) \times df(X_2) - df(X_2) \times df(X_1) = 2 \, df(X_1) \times df(X_2) = 2N dA\] <p><strong>平均曲率法向量的推导</strong> \(\begin{align*} df \wedge dN(X_1, X_2) &amp;= df(X_1) \times dN(X_2) - df(X_2) \times dN(X_1) \\ &amp;= -\kappa_2 df(X_1) \times df(X_2) + \kappa_1 df(X_2) \times df(X_1) \\ &amp;= (\kappa_1 + \kappa_2) \, df(X_1) \times df(X_2) \\ &amp;= 2H \, N \, dA(X_1, X_2) \end{align*}\)</p> <p><strong>高斯曲率法向量的推导</strong></p> \[\begin{align*} dN \wedge dN(X_1, X_2) &amp;= dN(X_1) \times dN(X_2) - dN(X_2) \times dN(X_1) \\ &amp;= \kappa_1 \kappa_2 \, df(X_1) \times df(X_2) - \kappa_2 \kappa_1 \, df(X_2) \times df(X_1) \\ &amp;= 2K \, N \, dA(X_1, X_2) \end{align*}\] <h4 id="离散化的实现">离散化的实现</h4> <p><strong>面积法向量（离散）</strong></p> <p>对顶点 $ i $ 的邻域面求和：</p> \[N_i = \frac{1}{6} \sum_{ijk \in \text{St}(i)} f_j \times f_k\] <p><strong>平均曲率法向量（离散）</strong></p> <p>通过 <strong>cotangent公式</strong>：</p> \[(HN)_i = \frac{1}{2} \sum_{ij \in E} (\cot \alpha_{ij} + \cot \beta_{ij})(f_i - f_j)\] <ul> <li><strong>推导依据</strong>： <ul> <li>积分 $ HN $ 对偶单元时，cotangent权重来自对偶边与原始边的长度比。</li> <li>与Laplace-Beltrami算子 $ \Delta f = 2HN $ 的离散化一致。</li> </ul> </li> </ul> <p><strong>高斯曲率法向量（离散）</strong></p> <p>假设法向量沿边在单位球面上弧线运动：</p> \[(KN)_i = \frac{1}{2} \sum_{ij \in E} \frac{\varphi_{ij}}{\ell_{ij}} (f_j - f_i)\] <ul> <li><strong>关键区别</strong>： <ul> <li>法向量 $ N $ 的非线性变化由二面角 $ \varphi_{ij} $ 描述。</li> <li>边长 $ \ell_{ij} $ 归一化保证尺度不变性。</li> </ul> </li> </ul> <h3 id="steiners-formula">Steiner’s Formula</h3> <p>对于多面体（离散曲面），直接求导得到的曲率要么为零（平面上），要么无定义（顶点/边处）。</p> <p><strong>Steiner方法</strong>通过以下步骤定义离散曲率：</p> <ol> <li><strong>平滑化（Mollification）</strong>：<br/> 将多面体与半径为 $ \varepsilon $ 的球 $ B_\varepsilon $ 做 <strong>Minkowski求和</strong>（即 $ P + B_\varepsilon $），得到一个光滑逼近的曲面。</li> <li><strong>极限分析</strong>：<br/> 计算平滑后曲面的曲率，并取 $ \varepsilon \to 0 $ 的极限，提取离散曲率的合理定义。</li> </ol> <p><strong>Minkowski求和与体积增长</strong></p> <p>对于凸体 $ A \subset \mathbb{R}^n $，其Minkowski求和的体积可表示为 $ \varepsilon $ 的多项式（<strong>Steiner公式</strong>）：</p> \[\text{Vol}(A + B_\varepsilon) = V_0 + \varepsilon \Phi_1 + \varepsilon^2 \Phi_2 + \cdots + \varepsilon^n \Phi_n\] <ul> <li> <p><strong>系数 $ \Phi_k $</strong>：称为 <strong>quermassintegrals</strong>，描述不同维度（面、边、顶点）对体积增长的贡献。</p> </li> <li> <p><strong>与曲率的关系</strong>：</p> <ul> <li>$ \Phi_1 $：表面积（零阶曲率）。</li> <li>$ \Phi_2 $：总平均曲率。</li> <li>$ \Phi_3 $：总高斯曲率（三维时为 $ 4\pi $ 的倍数）。</li> </ul> </li> </ul> <p><strong>多面体的Steiner多项式（三维）</strong></p> <p>对多面体 $ P $，平滑后的体积增长分解为：</p> \[\text{Vol}(P + B_\varepsilon) = V_0 + \varepsilon A + \frac{1}{2} \varepsilon^2 \sum_{\text{edges } ij} \ell_{ij} \varphi_{ij} + \frac{1}{3} \varepsilon^3 \sum_{\text{vertices } i} \Omega_i\] <ul> <li> <p><strong>各项意义</strong>：</p> <table> <thead> <tr> <th><strong>项</strong></th> <th><strong>几何贡献</strong></th> <th><strong>对应曲率</strong></th> </tr> </thead> <tbody> <tr> <td>$ \varepsilon A $</td> <td>面的“平板”体积（厚度 $ \varepsilon $）</td> <td>面积（零阶曲率）</td> </tr> <tr> <td>$ \varepsilon^2 $</td> <td>边的“圆柱楔”体积（$ \ell_{ij} \varphi_{ij} $）</td> <td>平均曲率（边弯曲）</td> </tr> <tr> <td>$ \varepsilon^3 $</td> <td>顶点的“球锥”体积（$ \Omega_i $）</td> <td>高斯曲率（顶点缺陷）</td> </tr> </tbody> </table> </li> </ul> <p><strong>非凸多面体</strong>：公式依然成立，但需注意符号（如二面角 $ \varphi_{ij} $ 可能为负）。</p> <p><strong>曲率提取与几何意义</strong></p> <p>通过对体积多项式的微分得到曲率：</p> \[\begin{align*} \text{Area}_\varepsilon &amp;= \frac{d}{d\varepsilon} \text{Vol}_\varepsilon = A + \varepsilon \sum \ell_{ij} \varphi_{ij} + \varepsilon^2 \sum \Omega_i, \\ \text{Mean Curvature}_\varepsilon &amp;= \frac{1}{2} \frac{d}{d\varepsilon} \text{Area}_\varepsilon = \frac{1}{2} \sum \ell_{ij} \varphi_{ij} + \varepsilon \sum \Omega_i, \\ \text{Gauss Curvature}_\varepsilon &amp;= \frac{d}{d\varepsilon} \text{Mean Curvature}_\varepsilon = \sum \Omega_i. \end{align*}\] <ul> <li><strong>当 $ \varepsilon \to 0 $</strong>： <ul> <li><strong>总平均曲率</strong>：$ \frac{1}{2} \sum \ell_{ij} \varphi_{ij} $（边贡献）。</li> <li><strong>总高斯曲率</strong>：$ \sum \Omega_i $（顶点角度缺损）。</li> </ul> </li> </ul> <p><strong>曲面上的Steiner公式</strong></p> <p>对光滑曲面 $ f: M \to \mathbb{R}^3 $，沿法向偏移 $ f_t = f + tN $ 时，面积变化为：</p> \[dA_t = (1 + 2tH + t^2 K) \, dA_0\] <ul> <li><strong>几何解释</strong>： <ul> <li>$ df \wedge df $：原始面积。</li> <li>$ df \wedge dN $：平均曲率（“混合面积”）。</li> <li>$ dN \wedge dN $：高斯曲率（球面像面积）。</li> </ul> </li> </ul> <h3 id="几何微分的基本原理">几何微分的基本原理</h3> <ol> <li><strong>方向</strong>：确定使几何量变化最快的移动方向</li> <li><strong>大小</strong>：计算在该方向上变化的速率</li> <li><strong>合成</strong>：将方向与大小结合得到梯度向量</li> </ol> <p>这种方法避免了繁琐的偏导数计算，直接利用几何直观解决问题。</p> <h4 id="角度导数的几何推导">角度导数的几何推导</h4> <p>计算两点(b,a)和(c,a)之间夹角θ关于点a坐标的梯度：</p> <ol> <li><strong>方向</strong>：垂直于ab连线（这是改变角度最有效的方向）</li> <li> <table> <tbody> <tr> <td><strong>大小</strong>：1/</td> <td>b-a</td> <td>（源自圆周运动的角度变化率）</td> </tr> </tbody> </table> </li> <li> <table> <tbody> <tr> <td><strong>合成</strong>：∇ₐθ = J(b-a)/</td> <td>b-a</td> <td>²，其中J是90度旋转矩阵</td> </tr> </tbody> </table> </li> </ol> <h4 id="微分策略比较">微分策略比较</h4> <table> <thead> <tr> <th>方法</th> <th>优点</th> <th>缺点</th> </tr> </thead> <tbody> <tr> <td>闭式微分</td> <td>快速准确</td> <td>耗时，难以修改</td> </tr> <tr> <td>自动微分</td> <td>准确高效</td> <td>需要修改代码</td> </tr> <tr> <td>数值微分</td> <td>直接可用</td> <td>不精确，成本高</td> </tr> <tr> <td>符号微分</td> <td>精确</td> <td>表达式可能过于复杂</td> </tr> </tbody> </table> <p>几何微分融合了闭式微分的效率与几何直观性，是处理几何问题的理想选择。</p> <h3 id="curvature-variations">Curvature Variations</h3> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>体积 -&gt; 面积 -&gt; 平均曲率 -&gt; 高斯曲率 -&gt; 0
</code></pre></div></div> <h4 id="离散体积的梯度">离散体积的梯度</h4> <p>对于离散曲面网格，顶点i处的<strong>体积梯度</strong>可表示为：</p> \[\nabla_i V = \frac{1}{6} \sum (f_j \times f_k) = N_i A_i\] <p>这个等式建立了三个关键几何量的联系：</p> <ol> <li><strong>体积变化率</strong>（左项）：顶点移动时包围体积的变化</li> <li><strong>向量面积</strong>（中项）：通过相邻三角形边界的叉积和</li> <li><strong>法向量积分</strong>（右项）：顶点邻域的法向量面积分</li> </ol> <p>当移动一个顶点时，体积变化主要来自相邻四面体的体积变化,这是离散版本的$\delta V = N \mathrm{d}A$</p> <h4 id="离散面积的梯度">离散面积的梯度</h4> <p>对于离散曲面，顶点 $i$ 的<strong>面积梯度</strong>可以用两种互补的形式表示：</p> \[\nabla_i A = \sum_{\triangle} \frac{1}{2} N_i \times e_i = \frac{1}{2} \sum_{j \in \mathcal{N}(i)} (\cot \alpha_{ij} + \cot \beta_{ij})(f_i - f_j)\] <p>其中，第一个求和遍历以 $i$ 为顶点的三角形，第二个求和遍历与顶点 $i$ 相邻的边。</p> <p><strong>单个三角形的面积梯度：</strong></p> <ul> <li>若移动顶点 $p$，其引起的面积变化率为</li> </ul> \[\nabla_p A = \frac{1}{2} N \times e\] <ul> <li>方向垂直于对边 $e$ 和三角形法向 $N$，即沿高度方向。</li> <li> <table> <tbody> <tr> <td>大小与对边长度成正比（因为 $A = \frac{1}{2}</td> <td>e</td> <td>h$）。</td> </tr> </tbody> </table> </li> </ul> <p><strong>整体曲面的面积梯度：</strong></p> <ul> <li>是相邻三角形梯度的线性叠加。</li> <li>可以简洁地重写为边权重形式，权重为 $\cot \alpha + \cot \beta$。</li> <li>这些余切权重不仅压缩了几何信息，还编码了局部曲率特征。</li> </ul> <h5 id="曲率与变分的几何联系">曲率与变分的几何联系</h5> <ul> <li>这样我们在离散中完美复现了光滑几何中的关系 $\delta A = HN$。</li> <li>其中 $\frac{1}{2}(\cot \alpha + \cot \beta)$ 就是离散平均曲率密度。</li> <li>梯度方向给出了面积最速下降的“展平”方向，自然成为形变优化的驱动场。</li> </ul> <h4 id="离散平均曲率的梯度">离散平均曲率的梯度</h4> <p>离散曲面的<strong>总平均曲率</strong>由边积分给出：</p> \[H_{total} = \frac{1}{2} \sum \ell_{ij} \varphi_{ij}\] <p>其中$\ell_{ij}$为边长，$\varphi_{ij}$为二面角。</p> <h5 id="schläfli公式的深刻内涵与应用">Schläfli公式的深刻内涵与应用</h5> <p>对于$\mathbb{R}^3$中的闭多面体，在顶点任意运动下保持：</p> \[\sum \ell_{ij} \mathrm{d} \varphi_{ij} = 0\] <p>其中$\ell_{ij}$为边长度，$\varphi_{ij}$为对应的二面角。 因此梯度简化为纯边长度变化项。</p> <p>对于顶点位置$ f_i $，总平均曲率的梯度为：</p> \[\nabla_{f_i} H_{\text{total}} = \frac{1}{2} \sum_{j \in \mathcal{N}(i)} \frac{\varphi_{ij}}{\ell_{ij}} (f_i - f_j)\] <p>其中：</p> <ul> <li>$\varphi_{ij}$是边$ij$的二面角</li> <li>$\ell_{ij}$是边长度</li> <li>$\mathcal{N}(i)$表示顶点$i$的邻域</li> </ul> <ol> <li><strong>Schläfli公式</strong>： <ul> <li>原始表达式包含两项：边长变化和二面角变化</li> <li>根据Schläfli公式，二面角变化项相互抵消</li> <li>最终仅保留边长变化主导的简洁形式</li> </ul> </li> <li><strong>曲率流</strong>： <ul> <li>梯度方向自动指向最优曲率调节方向</li> <li>权重系数$\varphi_{ij}/\ell_{ij}$编码了局部曲率信息</li> <li>完美再现连续情形的$\delta \text{mean} = KN$关系</li> </ul> </li> </ol> <h4 id="离散高斯曲率的拓扑不变性">离散高斯曲率的拓扑不变性</h4> <p>离散曲面的<strong>总高斯曲率</strong>由顶点角缺陷求和：</p> \[K_{\text{total}} = \sum_{i} (2\pi - \sum_{jk} \theta_i^{jk})\] <p>其中$\theta_i^{jk}$是顶点$i$处三角形$ijk$的内角。</p> <p><strong>离散高斯-博内定理</strong></p> <p>该定理揭示：</p> \[K_{\text{total}} = 2\pi\chi\] <p>其中欧拉示性数$\chi = V - E + F$是拓扑不变量。</p> <h4 id="关键性质">关键性质</h4> <ol> <li><strong>梯度为零</strong>： <ul> <li>任意顶点运动下$K_{\text{total}}$保持不变</li> <li>变分序列自然终止：$\delta \text{Gauss} = 0$</li> </ul> </li> <li><strong>几何解释</strong>： <ul> <li>局部角缺陷变化相互抵消</li> <li>保持整体拓扑约束不变</li> <li>反映曲面的内在刚性</li> </ul> </li> </ol> <h3 id="曲率流">曲率流</h3> <ol> <li><strong>曲率计算</strong>：在每个顶点处评估曲率量（平均/H/Gauss曲率）</li> <li><strong>运动方向</strong>：沿法向移动顶点 $ f_i^{k+1} = f_i^k - \tau \nabla E $</li> <li><strong>迭代优化</strong>：重复直至收敛</li> </ol> <h4 id="数值实现关键">数值实现关键</h4> <p>采用前向欧拉格式：</p> <p>$ \frac{f_i^{k+1} - f_i^k}{τ} = - \nabla_{f_i} E(f^k) $</p> <p>其中梯度项自动包含曲率信息：</p> <ul> <li><strong>平均曲率流</strong>：$ \nabla A = HN $</li> <li><strong>Willmore流</strong>：$ \nabla(H^2) = \Delta H + 2H(H^2-K)N $</li> </ul> <h4 id="典型应用对比">典型应用对比</h4> <table> <thead> <tr> <th>流类型</th> <th>能量函数</th> <th>梯度表达式</th> <th>主要应用</th> </tr> </thead> <tbody> <tr> <td>平均曲率流</td> <td>表面积</td> <td>$ \frac{1}{2}∑(\cotα+\cotβ)(f_i-f_j) $</td> <td>表面平滑</td> </tr> <tr> <td>逆平均曲率流</td> <td>体积</td> <td>$ \frac{1}{6}∑(f_j×f_k) $</td> <td>体积膨胀</td> </tr> <tr> <td>Willmore流</td> <td>$ ∫H^2dA $</td> <td>包含双拉普拉斯项</td> <td>保特征平滑</td> </tr> </tbody> </table> <h4 id="willmore流的特殊处理">Willmore流的特殊处理</h4> <ol> <li><strong>能量最小化</strong>：寻找$ ∫H^2dA $的临界点</li> <li><strong>数值挑战</strong>：需要处理四阶导数项</li> <li><strong>稳定技巧</strong>： <ul> <li>采用隐式时间积分</li> <li>添加面积约束项</li> <li>使用混合有限元离散化</li> </ul> </li> </ol> <p>这种基于曲率流的处理方法，通过几何量的自然变分实现了：</p> <ul> <li>噪声表面的自适应平滑</li> <li>特征结构的保持</li> <li>拓扑优化的自动化</li> </ul> <h3 id="总结">总结</h3> <p>离散微分几何通过统一的曲率框架，将连续曲面的几何特性（如高斯曲率、平均曲率）优雅地推广到离散网格，建立了基于顶点角缺陷、边二面角等几何量的离散曲率定义，并通过变分原理揭示了”体积→面积→平均曲率→高斯曲率”的层级关系，为曲面处理算法（如曲率流、网格平滑）提供了理论基础和高效实现方法，在计算机图形学、几何建模和物理仿真等领域具有重要应用价值。</p>]]></content><author><name></name></author><category term="DDG"/><category term="Geometry"/><summary type="html"><![CDATA[原课件来自：https://brickisland.net/ddg-web/]]></summary></entry><entry><title type="html">DDG Smooth Curvatures</title><link href="https://pasu.github.io/blog/2025/Smooth_Curvatures/" rel="alternate" type="text/html" title="DDG Smooth Curvatures"/><published>2025-07-05T00:00:00+00:00</published><updated>2025-07-05T00:00:00+00:00</updated><id>https://pasu.github.io/blog/2025/Smooth_Curvatures</id><content type="html" xml:base="https://pasu.github.io/blog/2025/Smooth_Curvatures/"><![CDATA[<p>原课件来自：https://brickisland.net/ddg-web/</p> <h2 id="curvature">Curvature</h2> <p>DDG课程里面无数次的提到了曲率，就像某剧里的经典场景一样反复出现，莉香总说”希望这是最后一次”，而我们也总以为这该是最后一次介绍曲率了。</p> <p>曲率是描述几何形状弯曲程度的核心概念，它不仅帮助我们理解物体的形状，更在众多领域发挥着关键作用。在物理学中，曲率解释了从微观分子到宏观宇宙的运行规律；在计算机图形学中，它是三维建模和动画模拟的基础；而在宇宙学中，爱因斯坦正是通过曲率来描述时空的本质特性。</p> <h3 id="平面曲线的曲率">平面曲线的曲率</h3> <p>曲率（Curvature）是描述平面曲线在某一点处弯曲程度的几何量，其数学定义为：</p> \[k(s):=&lt;N(s),\frac{\mathrm{d}}{\mathrm{d}s}T\left( s \right) &gt; \\ =&lt;N(s),\frac{\mathrm{d}^2}{\mathrm{d}s^2}\gamma \left( s \right) &gt;\] <p><strong>等价定义</strong></p> <p>若曲线以角度 $ \theta(s) $ 表示切向量的倾斜角，则曲率也可表示为：</p> \[\kappa(s) = \frac{\mathrm{d}\theta}{\mathrm{d}s}\] <p>即“单位弧长内角度的变化率”。</p> <h3 id="frenet-serret-equation">Frenet-Serret equation</h3> <p>《DDG (13): Smooth Curves》介绍过的Frenet-Serret：曲率$\kappa$ 和挠率 $\tau$完全决定了曲线的形状。<strong>矩阵形式</strong>：</p> \[\frac{d}{ds} \begin{bmatrix} T \\ N \\ B \end{bmatrix} = \begin{bmatrix} 0 &amp; -\kappa &amp; 0 \\ \kappa &amp; 0 &amp; -\tau \\ 0 &amp; \tau &amp; 0 \end{bmatrix} \begin{bmatrix} T \\ N \\ B \end{bmatrix}\] <p>这里，$ N(s) = \frac{T’(s)}{|T’(s)|} = \frac{\gamma’‘(s)}{\kappa(s)} $，法线的方向指向曲率中心。</p> <h3 id="曲面曲线的曲率">曲面曲线的曲率</h3> <p>当曲线位于某个曲面上时，我们可以采用另一种分解方式：<strong>法曲率（normal curvature）</strong>和<strong>测地曲率（geodesic curvature）</strong>，它们分别描述曲线在曲面中的“弯曲”行为。</p> <h4 id="法曲率normal-curvature">法曲率（Normal Curvature）</h4> <p>衡量曲线在曲面<strong>法向</strong>的弯曲程度，即曲线如何“贴合”曲面的形状。</p> \[\kappa_n = \langle N_M, \frac{\mathrm{d}T}{\mathrm{d}s} \rangle\] <p>其中：</p> <ul> <li>$ N_M $ 是<strong>曲面的单位法向量</strong>（不同于曲线的Frenet法向量！）</li> <li>$ \frac{\mathrm{d}T}{\mathrm{d}s} $ 是曲线的曲率向量</li> </ul> <p><strong>几何意义</strong>：</p> <ul> <li>法曲率反映曲线沿曲面法向的弯曲，与曲面的局部几何直接相关。</li> <li>若曲线是曲面的“法截线”（由法平面切割曲面得到），则其曲率就是法曲率。</li> </ul> <h4 id="测地曲率geodesic-curvature">测地曲率（Geodesic Curvature）</h4> <p>衡量曲线在曲面<strong>切平面内</strong>的弯曲程度，即曲线如何“偏离”曲面的测地线（最短路径）。</p> \[\kappa_g = \langle B_M, \frac{\mathrm{d}T}{\mathrm{d}s} \rangle\] <p>其中：</p> <ul> <li>$ B_M = T \times N_M $ 是曲面的<strong>副法向量</strong>（由曲线切向量和曲面法向量定义）</li> </ul> <p><strong>几何意义</strong>：</p> <ul> <li>测地曲率刻画曲线在曲面内部的“内在弯曲”，与曲面的嵌入方式无关。</li> <li><strong>测地线</strong>（曲面的“直线”）的测地曲率 $ \kappa_g = 0 $。</li> </ul> <h4 id="曲率分解关系">曲率分解关系</h4> <p>曲面的总曲率 $ \kappa $ 可分解为法曲率和测地曲率的组合：</p> \[\kappa^2 = \kappa_n^2 + \kappa_g^2\] <p>这一分解类似于向量的正交分解，其中：</p> <ul> <li>$ \kappa_n $ 依赖曲面的形状（外在性质）。</li> <li>$ \kappa_g $ 仅依赖曲面的内在几何（如度量）。</li> </ul> <p>好比你在山区开车，$ \kappa_n $体现了是弯曲的地势，而$ \kappa_g $则是你对方向盘的操作。</p> <h3 id="weingarten-map">Weingarten Map</h3> <p>Weingarten映射 $ \mathrm{d}N $ 是<strong>高斯映射 $ N $ 的微分</strong>，描述曲面法向量沿切方向的变化：</p> <ul> <li>输入：切向量 $ X \in T_pM $</li> <li>输出：法向量的变化量 $ \mathrm{d}N(X) $，且 $ \mathrm{d}N(X) \in T_pM $（因为单位法向量的变化必正交于自身）</li> </ul> <p><strong>几何解释</strong>：</p> <p>将曲面上沿 $ X $ 的微小移动，映射为球面 $ S^2 $ 上法向量的切向变化（如图）。</p> \[dN: T_pM \to T_pM\] <p>这是一个线性算子，称为<strong>形状算子（Shape Operator）</strong>，它将曲面在某点的切空间中的向量，线性地映射到该点法向量的变化方向。在几何上，这个映射有一个直观的解释：当我们把曲面在一点附近的所有切方向对应的法向量变化绘制在单位球面 $ S^2 $ 上时，这些变化量会形成一个<strong>椭圆</strong>。这个椭圆的长短轴方向就是曲面的<strong>主方向</strong>，而半轴长度则对应<strong>主曲率</strong>，分别描述了曲面在该点处弯曲最剧烈和最平缓的方向及其程度。</p> <h3 id="法曲率与主曲率">法曲率与主曲率</h3> <p><strong>法曲率（Normal Curvature）</strong></p> <p><strong>定义</strong>：给定曲面上的曲线，其<strong>法曲率</strong>衡量曲线在曲面法向的弯曲程度：</p> \[\kappa_N(X) := \frac{\langle df(X), dN(X) \rangle}{| df(X)|^2}\] <p>法曲率 $\kappa_N(X)$ 是曲面 $M$ 上沿切方向 $X$ 的弯曲程度的度量，其几何定义为：</p> <ol> <li>在点 $p \in M$ 处，取切向量 $df(X) \in T_pM$ 和曲面法向量 $N$。</li> <li>用由 $df(X)$ 和 $N$ 张成的平面（称为 <strong>法截面</strong>）切割曲面，得到一条平面曲线 $\gamma$。</li> <li>该曲线 $\gamma$ 在 $p$ 点的曲率即为法曲率 $\kappa_N(X)$。</li> </ol> <p><strong>主曲率（Principal Curvatures）</strong></p> <p><strong>定义</strong>：法曲率的极值 $ \kappa_1 $ 和 $ \kappa_2 $，对应正交的<strong>主方向</strong> $ X_1 $、$ X_2 $。</p> <ul> <li> <p>数学上，是Weingarten映射 $ dN $ 的特征值：</p> \[dN(X_i) = \kappa_i df(X_i)\] </li> </ul> <h3 id="shape-operator">Shape Operator</h3> <p>形状算子 $ S $ 是一个<strong>线性映射</strong>，将切向量 $ X $ 映射为法向量 $ N $ 的变化量在切平面上的投影：</p> \[df(SX)=dN(X)\] <p>形状算子的<strong>特征值与特征向量</strong>直接给出曲面的主曲率和主方向：</p> <ul> <li><strong>主方向</strong> $ X_1, X_2 $：$ S $ 的特征向量，即法向量变化最剧烈/平缓的方向。</li> <li><strong>主曲率</strong> $ \kappa_1, \kappa_2 $：$ S $ 的特征值，表示沿主方向的弯曲程度。</li> </ul> <p><strong>数学表达</strong>：<br/> \(S(X_i) = \kappa_i X_i\)</p> <p><strong>非对称性与正交性</strong></p> <ul> <li><strong>非对称性</strong>：$ S $ 的矩阵表示在标准坐标系中通常不是对称矩阵。</li> <li><strong>度量正交性</strong>：主方向在曲面<strong>内蕴度量</strong> $ g $ 下正交（$ g(X_1, X_2) = 0 $），但在 $ \mathbb{R}^3 $ 中未必正交。</li> </ul> <p>形状算子 $ S $ 的非对称性导致 Weingarten 映射将切平面的单位圆扭曲为椭圆。</p> <p><strong>例子</strong>（斜圆柱面）：</p> <p>对于圆柱面 $ f(u,v) = (\cos u, \sin u, v) $：</p> <ul> <li> <p><strong>df</strong>：</p> \[df = [ (-\sin u, \cos u, 0) \,\, (0, 0, 1) ]\] </li> <li><strong>N</strong>：法向量 $ N = (\cos u, \sin u, 0) $。</li> <li> <p><strong>dN</strong>：</p> \[dN = [ (-\sin u, \cos u, 0) \,\, (0, 0, 0) ]\] </li> <li><strong>形状算子</strong>：<br/> 由 $ dN = df \cdot S $，解得 $ S = \begin{bmatrix} 1 &amp; 0 \ 0 &amp; 0 \end{bmatrix} $，对应主曲率 $ \kappa_1 = 1 $（圆周方向）和 $ \kappa_2 = 0 $（直线方向）。</li> </ul> <h4 id="umbilic-points">Umbilic Points</h4> <p>脐点是曲面上<strong>主曲率相等</strong>的点，即满足 $ \kappa_1 = \kappa_2 $。</p> <ul> <li><strong>典型例子</strong>： <ul> <li>球面上所有点均为脐点（$ \kappa_1 = \kappa_2 = 1/R $）。</li> <li>平面上的点也是脐点（$ \kappa_1 = \kappa_2 = 0 $）。</li> </ul> </li> </ul> <h4 id="主曲率线网">主曲率线网</h4> <ul> <li><strong>定义</strong>：沿着曲面“最弯”或“最平”方向（主方向）画出的曲线。</li> <li><strong>特点</strong>： <ul> <li>每条线代表一个主方向（κ₁或κ₂方向）。</li> <li>整个曲面的主曲率线构成网状结构，称为<strong>主曲率线网</strong>。</li> </ul> </li> </ul> <p><strong>主曲率线的三种情况</strong></p> <ol> <li><strong>终止于脐点</strong>（分离线） <ul> <li>脐点是主曲率相等的点（如球面上所有点都是脐点）。</li> <li>分离线像“分界线”，将曲面分成规则区域（如椭球面被分成四块）。</li> </ul> </li> <li><strong>闭合循环</strong> <ul> <li>主曲率线首尾相连（如圆柱面的竖直直线或水平圆圈）。</li> </ul> </li> <li><strong>无限延伸或螺旋</strong> <ul> <li>多数曲面中，曲率线既不停下也不闭合，而是复杂延伸（如马鞍面）。</li> </ul> </li> </ol> <h3 id="gaussian-and-mean-curvature">Gaussian and Mean Curvature</h3> <ul> <li> <p><strong>高斯曲率（Gaussian Curvature）</strong>：<br/> $ K = \kappa_1 \kappa_2 $</p> </li> <li> <p><strong>平均曲率（Mean Curvature）</strong>：<br/> $ H = \frac{1}{2} (\kappa_1 + \kappa_2 ) $</p> </li> </ul> <p><strong>几何意义</strong></p> <table> <thead> <tr> <th>曲率类型</th> <th>描述</th> <th>示例场景</th> </tr> </thead> <tbody> <tr> <td><strong>高斯曲率 K</strong></td> <td>曲面局部面积的”伸缩比”</td> <td>- 球面：$ K &gt; 0 $（所有点相同）<br/>- 圆柱：$ K = 0 $<br/>- 马鞍面：$ K &lt; 0 $</td> </tr> <tr> <td><strong>平均曲率 H</strong></td> <td>曲面局部朝向的”平均弯曲程度”</td> <td>- 最小曲面：$ H = 0 $（如肥皂膜）<br/>- 球面：$ H = 1/R $</td> </tr> </tbody> </table> <p><strong>关键特性</strong></p> <ul> <li><strong>高斯曲率</strong>是<strong>内蕴性质</strong>（仅依赖曲面本身的度量，与外部空间无关）</li> <li><strong>平均曲率</strong>是<strong>外蕴性质</strong>（依赖曲面在空间中的嵌入方式）</li> </ul> <p><strong>与算子关系</strong></p> <ul> <li>高斯曲率 $ K = \det(S) $（形状算子的行列式）</li> <li>平均曲率 $ H = \frac{1}{2} \text{tr}(S) $（形状算子的迹）</li> </ul> <h4 id="局部几何的偏离">局部几何的偏离</h4> <p>高斯曲率 $ K $ 直观表达了曲面局部与欧氏平面 ($ \mathbb{R}^2 $) 的差异：</p> \[K \propto 1 - \frac{|B_g|}{|B_{\mathbb{R}^2}|}\] \[|B_g| = \pi\epsilon^2 \left(1 - \frac{K}{12}\epsilon^2 + O(\epsilon^4)\right)\] <ul> <li> <table> <tbody> <tr> <td>$</td> <td>B_g</td> <td>$：曲面上半径为 $ \epsilon $ 的<strong>测地圆</strong>（geodesic ball）的面积或周长。</td> </tr> </tbody> </table> </li> <li> <table> <tbody> <tr> <td>$</td> <td>B_{\mathbb{R}^2}</td> <td>$：欧氏平面中相同半径圆的面积（$ \pi\epsilon^2 $）或周长（$ 2\pi\epsilon $）。</td> </tr> </tbody> </table> </li> <li><strong>比例关系</strong>：高斯曲率 $ K $ 正比于曲面局部几何与平面几何的“偏离程度”。</li> </ul> <p><strong>几何意义</strong></p> <ul> <li><strong>$ K &gt; 0 $</strong>（如球面）：<br/> $ |B_g| &lt; \pi\epsilon^2 $，测地圆比平面圆更小（正曲率收缩）。<br/> <strong>例子</strong>：地球极区的圆周小于赤道同半径圆。</li> <li><strong>$ K &lt; 0 $</strong>（如马鞍面）：<br/> $ |B_g| &gt; \pi\epsilon^2 $，测地圆比平面圆更大（负曲率扩张）。</li> <li><strong>$ K = 0 $</strong>（如平面、圆柱）：<br/> $ |B_g| = \pi\epsilon^2 $，局部与欧氏几何一致。</li> </ul> <p><strong>为什么是内蕴性质</strong></p> <p>高斯曲率 $ K $ 仅依赖曲面的<strong>度量</strong>（第一基本形式 $ g $），与外部空间嵌入无关。例如：</p> <ul> <li><strong>圆柱</strong>与<strong>平面</strong>：局部度量相同（$ K=0 $），尽管圆柱在三维空间中“看起来”弯曲。</li> </ul> <h3 id="gauss-bonnet-theorem">Gauss-Bonnet Theorem</h3> <p>对于<strong>封闭、紧致、可定向</strong>的曲面 $ M $，其总高斯曲率与欧拉示性数 $ \chi $ 满足：</p> \[\int_M K \, dA = 2\pi \chi\] <p>其中：</p> <ul> <li>$ K $ 是高斯曲率（局部弯曲）。</li> <li>$ \chi = 2 - 2g $（$ g $ 为曲面genus，即“洞”的数量）。</li> </ul> <p><strong>边界推广</strong>：若曲面有边界 $ \partial M $，则：</p> \[\int_M K \, dA + \int_{\partial M} \kappa_g \, ds = 2\pi \chi\] <ul> <li>$ \kappa_g $ 为边界曲线的测地曲率。</li> <li>此时 $ \chi = 2 - 2g - b $（$ b $ 为number of boundary components）。</li> </ul> <p><strong>几何意义</strong></p> <ul> <li><strong>全局拓扑约束局部几何</strong>：无论曲面如何弯曲，总曲率始终由拓扑（欧拉示性数）决定。</li> <li><strong>边界贡献</strong>：边界上的“转弯”补偿内部曲率（如平面圆盘的总边界曲率为 $ 2\pi $）。</li> </ul> <h4 id="总平均曲率">总平均曲率</h4> <p>闵可夫斯基（Minkowski）定理指出：对于<strong>封闭凸曲面</strong> $ M \subset \mathbb{R}^3 $，其总平均曲率满足以下不等式：</p> \[\int_M H \, dA \geq \sqrt{4\pi A}\] <p>其中：</p> <ul> <li>$ H $ 为平均曲率（$ H = \frac{1}{2}(\kappa_1 + \kappa_2) $）</li> <li>$ A $ 为曲面面积</li> </ul> <h3 id="i--ii-fundamental-form">I &amp; II Fundamental Form</h3> <p>第一基本形式 $ I $ 是曲面的<strong>黎曼度量</strong> $ g $，描述曲面上的内蕴几何（长度、角度、面积）：</p> \[I(X, Y) = g(X, Y) = \langle df(X), df(Y) \rangle\] <p>其中 $ df $ 是曲面的微分映射，$ X, Y $ 为切向量。</p> <p>第二基本形式 $ II $ 描述曲面在空间中的<strong>外蕴弯曲</strong>，通过法向变化量化：</p> \[II(X, Y) = \langle dN(X), df(Y) \rangle\] <p>其中 $ N $ 为单位法向量，$ dN $ 为 Weingarten 映射。</p> <p><strong>与法曲率的关系</strong>：</p> \[\kappa_N(X) = \frac{II(X, X)}{I(X, X)}\] <p>即，法曲率可以看作是第二基本形式 $II$ 与第一基本形式 $I$ 的比值。而高斯曲率虽然表面上依赖于 $II$，但其实借助结构方程（Gauss–Codazzi–Mainardi 方程），可以将第二基本形式完全表示为 <strong>第一基本形式及其导数</strong> 的函数。这也正是为什么：</p> <blockquote> <p>你无法在不产生拉伸或压缩的情况下，将地球的表面（球面）完整地摊平成平面（地图总会带有畸变）。</p> </blockquote>]]></content><author><name></name></author><category term="DDG"/><category term="Geometry"/><summary type="html"><![CDATA[原课件来自：https://brickisland.net/ddg-web/]]></summary></entry><entry><title type="html">DDG Discrete Surfaces</title><link href="https://pasu.github.io/blog/2025/Discrete_Surfaces/" rel="alternate" type="text/html" title="DDG Discrete Surfaces"/><published>2025-06-30T00:00:00+00:00</published><updated>2025-06-30T00:00:00+00:00</updated><id>https://pasu.github.io/blog/2025/Discrete_Surfaces</id><content type="html" xml:base="https://pasu.github.io/blog/2025/Discrete_Surfaces/"><![CDATA[<p>原课件来自：https://brickisland.net/ddg-web/</p> <h2 id="离散曲面模型">离散曲面模型</h2> <p>在离散微分几何中，曲面主要有两种模型：</p> <ul> <li><strong>单纯形模型（Simplicial）</strong> (图左) <ul> <li>曲面由<strong>simplicial 2-manifolds</strong>（单纯形2-流形）构成</li> <li>天然适配<strong>discrete exterior calculus</strong>（离散外积分）</li> </ul> </li> <li><strong>网格模型（Nets）</strong> (图左) <ul> <li>曲面由分段整数格（<strong>piecewise integer lattices</strong>）组成</li> <li>天然适配<strong>discrete integrable systems</strong>（离散可积系统）</li> </ul> </li> </ul> <p>在应用中，单纯形模型更为常见，也是本课程的重点。</p> <h3 id="单纯形曲面simplicial-surface">单纯形曲面（Simplicial Surface）</h3> <p>简单来说，<strong>单纯形曲面</strong>可以理解为一个“三角形网格”（triangle mesh）。然而，通过更严谨的定义，我们可以将“三角形网格”与微分几何的概念联系起来。</p> <p>与光滑曲面类似，单纯形曲面也需要满足一定的<strong>正则性条件</strong>，以确保其几何性质良好：</p> <ul> <li><strong>拓扑条件（topology）</strong>：网格的连通性必须满足<strong>流形（manifold）</strong>性质。 <ul> <li>每条边最多属于两个三角形（边界边则属于一个）。</li> <li>每个顶点周围的三角形必须构成一个单连通的环（边界顶点则为路径）。</li> </ul> </li> <li><strong>几何条件（geometry）</strong>：顶点的坐标必须构成一个<strong>单纯形浸入（simplicial immersion）</strong>，即局部单射映射，避免自交或退化。</li> </ul> <p>通过这样的定义，离散的三角形网格就能在微分几何的框架下进行严格的数学分析。</p> <h3 id="抽象单纯形曲面abstract-simplicial-surface">抽象单纯形曲面（Abstract Simplicial Surface）</h3> <p><strong>抽象单纯形曲面</strong>是指一个满足流形条件的单纯形2-复形（manifold simplicial 2-complex），其定义如下：</p> <ul> <li><strong>基本结构</strong>： <ul> <li>最高维的单纯形是三角形（2-单纯形）</li> <li>每条边（1-单纯形）必须属于两个三角形（若在边界上则属于一个）</li> <li>每个顶点（0-单纯形）周围的三角形必须构成一个单连通的环（边界顶点则为路径）</li> </ul> </li> <li><strong>数学表示</strong>：通常记作 $ K = (V, E, F) $，其中： <ul> <li>$ V $：顶点集合</li> <li>$ E $：边集合</li> <li>$ F $：面（三角形）集合</li> </ul> </li> </ul> <p><strong>核心思想</strong>：抽象单纯形曲面仅描述<strong>连接关系（connectivity）</strong>，不涉及具体的几何形状或空间嵌入。这种纯粹的拓扑结构为后续引入几何映射（如单纯形浸入）提供了基础框架。</p> <h3 id="单纯形映射simplicial-map">单纯形映射（Simplicial Map）</h3> <p>单纯形映射的数学核心在于<strong>定义域的构造</strong>。我们需要明确：抽象单纯形复形本身仅包含离散的顶点、边和面（作为集合的子集），但映射 $ f $ 需要作用于整个几何化的“曲面”上，包括单纯形内部的点。以下是关键步骤：</p> <h4 id="从抽象复形到几何载体"><strong>从抽象复形到几何载体</strong></h4> <ul> <li><strong>抽象单纯形复形</strong> $ K = (V, E, F) $ 仅描述连接关系（如“顶点 $ v_1 $ 和 $ v_2 $ 通过一条边相连”）。</li> <li>但映射 $ f $ 需要处理的是每个单纯形（如三角形）<strong>内部的点</strong>，而不仅仅是顶点。</li> </ul> <h4 id="重心坐标的作用"><strong>重心坐标的作用</strong></h4> <ul> <li> <p>通过<strong>重心坐标 $ (t_0, t_1, t_2) $</strong>，我们将每个抽象三角形 $ \sigma = {v_i, v_j, v_k} $ 关联到一个<strong>标准单纯形</strong>（即二维空间中的单位三角形）：</p> \[\sigma \mapsto \left\{ (t_0, t_1, t_2) \mid t_0 + t_1 + t_2 = 1, \, t_i \geq 0 \right\}\] </li> <li> <p>例如：顶点 $ v_i $ 对应 $ (1, 0, 0) $，边 $ v_i v_j $ 对应 $ (t, 1-t, 0) $，三角形内部点则为 $ (t_0, t_1, t_2) $。</p> </li> </ul> <h4 id="定义域">定义域</h4> <p><strong>定义</strong>：单纯形映射 $ f $ 的定义域，是通过把抽象三角网格的每个三角形”撑开”成标准三角形后，再把它们按照原来的连接方式粘起来形成的连续曲面。</p> <p><strong>两步构造法</strong>：</p> <ol> <li><strong>无交并（Disjoint Union）</strong> <ul> <li>把网格的每个三角形都当作一个独立的”纸片”</li> <li>此时相邻三角形虽然共享边，但这些边还是分开的（就像两片没粘好的折纸）</li> </ul> </li> <li><strong>沿共享边粘合（Gluing）</strong> <ul> <li>把那些在抽象网格中本应相连的边（如图中的边jk）严格对齐粘合</li> <li>粘合规则：共享边的对应点必须完全重合（比如两个三角形的中点要粘在同一个位置）</li> </ul> </li> </ol> <p><strong>核心思想</strong>：单纯形映射的域是抽象复形的“几何实现”，通过重心坐标和粘合操作，将<strong>离散</strong>的组合结构转化为<strong>连续</strong>的几何对象。这一过程是离散微分几何中模拟光滑曲面的关键步骤。</p> <h3 id="离散微分discrete-differential">离散微分（Discrete Differential）</h3> <ol> <li><strong>离散映射 $ f $ 的性质</strong> <ul> <li>$ f $ 是一个离散的、$ \mathbb{R}^n $-值的 <strong>0-形式</strong>，即它为每个顶点 $ i $ 赋予一个坐标向量 $ f_i \in \mathbb{R}^n $。</li> </ul> </li> <li><strong>离散微分 $ df $ 的定义</strong> <ul> <li>$ df $ 是 $ f $ 的<strong>离散外导数</strong>，作为 <strong>1-形式</strong>，它为每条有向边 $ ij $ 赋予一个值：<br/> \((df)_{ij} := f_j - f_i\)</li> <li><strong>几何解释</strong>：$ (df)_{ij} $ 就是连接顶点 $ i $ 和 $ j $ 的<strong>边向量</strong>（从 $ f_i $ 指向 $ f_j $）。</li> </ul> </li> <li><strong>与光滑理论的类比</strong> <ul> <li>在光滑曲面中，微分 $ df $ 作用于切向量 $ X $，输出方向导数 $ df(X) $。</li> <li>在离散情况下，边 $ ij $ 可视为“离散切向量”，而 $ (df)_{ij} = f_j - f_i $ 直接给出了该方向的变化量。</li> </ul> </li> <li><strong>反对称性</strong> <ul> <li> <p>对反向边 $ ji $，有：</p> \[(df)_{ji} = f_i - f_j = - (df)_{ij}\] <p>这与经典微分几何中 1-形式的定向一致性一致。</p> </li> </ul> </li> </ol> <p>若将 $ df $ 视为光滑 1-形式的离散版本，则：</p> \[(df)_{ij} \approx \int_{\sigma_{ij}} df = f_j - f_i\] <p>离散微分 $ df $ 用简单的边向量 $ f_j - f_i $，在离散网格上复现了光滑微分的关键性质。</p> <h3 id="immersion-discrete-immersion与simplicial-immersion">Immersion, Discrete Immersion与Simplicial Immersion</h3> <p>参数化曲面 $ f $ 是浸入，若其微分 $ df $ 处处非退化（即 $ df(X) = 0 $ 当且仅当 $ X = 0 $）。</p> <p><strong>几何意义</strong>：</p> <ul> <li>曲面无“折叠”或“退化”区域，保证切空间处处维数正确。</li> <li>是定义曲率、法向量等微分量的基础条件。</li> </ul> <h4 id="离散浸入discrete-immersion">离散浸入（Discrete Immersion）</h4> <p><strong>问题</strong>：</p> <ul> <li>若仅要求离散微分 $ df $ 的边向量非零（即边长 $ |f_j - f_i| &gt; 0 $），仍可能丢失光滑浸入的关键性质。</li> </ul> <p><strong>分支点（Branch Points）</strong>：</p> <ul> <li>在左边的离散网格中，围绕顶点 $0$ 的三角形拼接得很好，如果你沿着 $0$ 走一圈，刚好走完一次，总角度是 $2\pi$。</li> <li>在右边的映射图中，通过映射 $f$，这些点被映射到 $f_0, f_1, \dots, f_9$。现在围绕 $f_0$ 的面 <strong>会绕中心多转几圈</strong>，即围绕 $f_0$ 的总角度大于 $2\pi$。</li> <li>这意味着这个映射在 $f_0$ 处是 <strong>locally many-to-one</strong>（局部多值），在离散域中绕 $f_0$ 走一圈，映射后会绕 $f_0$ 转多圈。这正是所谓的 <strong>branch point</strong>（类似复分析中全纯函数出现 $z \mapsto z^n$ 的情形）。</li> </ul> <h4 id="单纯形浸入simplicial-immersion">单纯形浸入（Simplicial Immersion）</h4> <p><strong>修正定义</strong>：</p> <ul> <li>要求单纯形映射 $ f $ 是<strong>局部单射</strong>（locally injective），即每个顶点邻域（star）在映射下无重叠或翻转。</li> <li><strong>等价条件</strong>： <ul> <li>每个顶点邻域的三角形在 $ \mathbb{R}^n $ 中<strong>嵌入</strong>（无自交或退化）。</li> <li>所有三角形面积非零，且相邻三角形法向量方向一致。</li> </ul> </li> </ul> <p><strong>示例</strong>：</p> <ul> <li><strong>合法</strong>：两个相邻三角形共享边，且张开角度 $ \theta \in (0, 2\pi) $。</li> <li><strong>非法</strong>： <ol> <li>边长和面积为0</li> <li>dihedral角度为0</li> <li>不满足locally injective</li> </ol> </li> </ul> <p><strong>必要非充分条件</strong>：<br/> 边长、面积、角度非零仅是单纯形浸入的必要条件，但还需局部单射性。</p> <h3 id="离散高斯映射discrete-gauss-map">离散高斯映射（Discrete Gauss Map）</h3> <p><strong>定义</strong>：<br/> 对于离散浸入曲面，<strong>高斯映射</strong>即为每个三角形的单位法向量 $ N_f \in \mathbb{R}^3 $（属于对偶离散0-形式）。</p> <p><strong>几何表现</strong>：</p> <ul> <li>将每个三角形法向量可视作单位球面上的点（如图）。</li> <li>连接相邻法向量的弧线对应于<strong>共享边的正交法向族</strong>（即所有包含该边的三角形的法向量在球面上的轨迹）。</li> </ul> <p><strong>局限性</strong>：</p> <ul> <li>仅定义在三角形面片层级，无法直接给出顶点或边的法向。</li> </ul> <h4 id="顶点法向的传统问题">顶点法向的传统问题</h4> <ul> <li> <table> <tbody> <tr> <td><strong>均匀平均面法向</strong>：$ N_v = \frac{1}{</td> <td>F(v)</td> <td>} \sum_{f \in F(v)} N_f $</td> </tr> </tbody> </table> <ul> <li>问题：结果依赖网格剖分密度，几何意义不明确（如图中不同细分导致法向偏移）。</li> </ul> </li> </ul> <h4 id="基于向量面积的离散法向discrete-vector-area">基于向量面积的离散法向（Discrete Vector Area）</h4> <p><strong>光滑理论回顾</strong>：<br/> 向量面积 $ \int_\Omega N \, dA = \frac{1}{2} \int_{\partial \Omega} f \times df $。</p> <p><strong>离散版本</strong>：</p> <ul> <li> <p>对顶点 $ v $ 的邻域 $ \Omega $，积分 $ N \, dA $ 转化为对邻域边界的求和：</p> \[\frac{1}{3} \int_\Omega N \mathrm{d}A = \frac{1}{6} \int_{\partial \Omega} f \times \mathrm{d}f = \frac{1}{6} \sum_{ij \in \partial \Omega} \int_{e_{ij}} f \times \mathrm{d}f\] \[N_v = \frac{1}{2} \sum_{ij \in \partial \Omega} f_i \times f_j\] </li> <li> <p><strong>关键性质</strong>：</p> <ul> <li>与顶点坐标 $ p $ 无关（仅依赖邻域顶点位置）。</li> </ul> </li> </ul> <h4 id="其他自然定义">其他自然定义</h4> <ul> <li><strong>面积加权</strong>：适合需要物理精确性的场景（如曲率计算）。</li> <li><strong>角度加权</strong>：适合几何处理（如网格平滑、去噪），因其对网格质量不敏感。</li> </ul> <h3 id="discrete-exterior-calculus-on-curved-surfaces">Discrete Exterior Calculus on Curved Surfaces</h3> <ul> <li><strong>光滑曲面</strong>：外微积分在 $ \mathbb{R}^n $ 中定义后，通过调整 <strong>霍奇星算子（Hodge star）</strong> 推广到弯曲曲面，该算子编码了几何信息（长度、角度、面积等）。</li> <li><strong>离散曲面</strong>：单纯形曲面（如三角网格）的每个面片本身是平的，因此可直接沿用 $ \mathbb{R}^2 $ 中的离散霍奇星算子公式，无需修改！</li> </ul> <p>我们可以直接将平面中的离散霍奇星算子公式(DDG (11): Discrete Exterior Calculus)应用于曲面上。</p> <ul> <li><strong>内蕴性</strong>：霍奇星算子的作用仅依赖于曲面的 <strong>内蕴几何</strong>（如边长、内角），与曲面如何嵌入 $ \mathbb{R}^3 $ 无关。</li> <li><strong>平坦性</strong>：每个三角形局部是欧几里得的，因此 $ \mathbb{R}^2 $ 的离散公式可直接应用。</li> </ul> <h4 id="关键性质">关键性质</h4> <ul> <li><strong>局部性</strong>：每个算子的计算仅依赖相邻单元（如顶点邻域或边邻域）。</li> <li><strong>兼容性</strong>：与离散外导数 $ d $ 结合后，可构建离散拉普拉斯算子等微分工具。</li> <li><strong>几何无关性</strong>：即使曲面在 $ \mathbb{R}^3 $ 中弯曲，公式仍仅用原始边长和内角计算。</li> </ul> <h4 id="离散-laplace-beltrami-算子">离散 Laplace-Beltrami 算子</h4> <p>在光滑曲面中，Laplace-Beltrami 算子定义为：</p> \[\Delta = \star d \star d \phi\] <p>在离散下，通过组合 $ \star $ 和 $ d $，我们得到著名的 <strong>cotan 公式</strong>，实现了连续拉普拉斯算子的自然离散化：</p> \[(\Delta u)_i = \frac{1}{2} \sum_{j \in \mathcal{N}(i)} (\cot \alpha_{ij} + \cot \beta_{ij}) (u_j - u_i)\] <p>其中：</p> <ul> <li>$ \mathcal{N}(i) $ 是顶点 $ i $ 的邻接顶点集合，形成$e_{ij}$</li> <li>$ \alpha_{ij} $ 和 $ \beta_{ij} $ 是边 $ ij $ 的两个对角</li> </ul> <h4 id="cotan-公式的几何解释">Cotan 公式的几何解释</h4> <ul> <li><strong>权重意义</strong>：$ \frac{1}{2}(\cot \alpha_{ij} + \cot \beta_{ij}) $ 实际上表示边 $ ij $ 的对偶边长</li> <li><strong>内在性质</strong>：只依赖于局部边长和内角，与曲面在空间中的弯曲方式无关</li> <li><strong>保角性</strong>：cotan 权重自然地捕捉了曲面的共形结构</li> </ul> <h3 id="离散曲面的重建问题">离散曲面的重建问题</h3> <p>在微分几何中，许多几何对象可以通过其微分量唯一确定（需初始条件）：</p> <ul> <li><strong>平面曲线</strong>：由曲率函数 + 初始点/方向确定</li> <li><strong>空间曲线</strong>：由曲率和挠率确定</li> <li><strong>光滑曲面</strong>：由第一/第二基本形式确定</li> <li><strong>凸曲面</strong>：由黎曼度量唯一确定</li> </ul> <p>如果给定一个离散高斯映射（即所有三角形法向），能否重建顶点位置？</p> <p><strong>离散重建算法</strong>：</p> <ol> <li><strong>边方向确定</strong>：相邻三角形法向 $ N_1 $, $ N_2 $ 的叉积给出共享边方向 $ N_1 \times N_2 $</li> <li><strong>角度计算</strong>：通过边方向的点积计算三角形内角</li> <li><strong>三角形重建</strong>：根据三边方向+内角确定三角形形状（尺度未定）</li> <li><strong>全局拼接</strong>：将所有三角形按共享边匹配，恢复完整网格</li> </ol> <h4 id="光滑情形的局限性">光滑情形的局限性</h4> <p>| 特性 | 离散曲面 | 光滑曲面 | |———————|—————————-|—————————-| | 重建所需数据 | 法向 + 连接关系 | 法向 + 参数化（如弧长参数） | | 唯一性 | 唯一（模去刚体变换） | 需额外条件才唯一 | | 核心约束 | 组合结构（连接关系） | 微分方程的可积条件 |</p> <p>以平面曲线为例：</p> <ul> <li><strong>给定法向场</strong>：$ N(s) = (\cos\theta(s), \sin\theta(s)) $</li> <li><strong>重建问题</strong>：需解微分方程 $ \frac{df}{ds} = R_{90^\circ}N(s) $（$ R_{90^\circ} $为旋转矩阵）</li> <li><strong>关键缺陷</strong>：<br/> 除非已知弧长参数 $ s $，否则 $ \theta(s) $ 可任意重参数化 → <strong>无穷多解</strong>（如图1）</li> </ul> <h4 id="从度量重建曲面">从度量重建曲面</h4> <p><strong>光滑曲面（Cohn-Vossen定理）</strong>：</p> <ul> <li>凸光滑曲面由其黎曼度量<strong>唯一确定</strong>（差一个刚体运动）</li> <li>度量 $ g $ 编码了曲面的所有内蕴几何（长度、角度、面积等）</li> </ul> <p><strong>离散曲面（Alexandrov-Connelly定理）</strong>：</p> <ul> <li>凸多面体由其<strong>边长</strong>唯一确定</li> <li>非凸情形不成立：存在不同构的多面体具有相同边长</li> </ul> <h5 id="重建网格算法">重建网格算法</h5> <p><strong>Chern等（2018）的”Shape from Metric”方法</strong>：</p> <ol> <li><strong>输入</strong>：离散度量（所有边长 $ \ell_{ij} $）</li> <li><strong>核心步骤</strong>： <ul> <li>构造离散<strong>浸入条件</strong>（Discrete Immersion）</li> <li>引入离散<strong>自旋结构</strong>（Discrete Spin Structure）</li> <li>求解非线性优化问题，使边长匹配目标度量</li> </ul> </li> <li><strong>输出</strong>：顶点坐标 $ f_i \in \mathbb{R}^3 $</li> </ol> <p><strong>总结</strong>：离散微分几何通过单纯形映射和组合结构，在三角网格上重建了光滑曲面的微分几何框架——从离散微分、霍奇星算子到Laplace-Beltrami算子，其核心在于利用边长和内角等内蕴几何量保持微分几何的本质特性。离散情形的独特刚性（如从法向或度量重建曲面）揭示了组合结构与几何的深刻联系，为几何处理算法提供了既严谨又高效的理论基础，也彰显了”离散逼近连续”在计算应用中的强大优势。</p>]]></content><author><name></name></author><category term="DDG"/><category term="Geometry"/><summary type="html"><![CDATA[原课件来自：https://brickisland.net/ddg-web/]]></summary></entry><entry><title type="html">DDG Smooth Surfaces II</title><link href="https://pasu.github.io/blog/2025/Smooth_Surfaces_2/" rel="alternate" type="text/html" title="DDG Smooth Surfaces II"/><published>2025-06-29T00:00:00+00:00</published><updated>2025-06-29T00:00:00+00:00</updated><id>https://pasu.github.io/blog/2025/Smooth_Surfaces_2</id><content type="html" xml:base="https://pasu.github.io/blog/2025/Smooth_Surfaces_2/"><![CDATA[<p>原课件来自：https://brickisland.net/ddg-web/</p> <h2 id="光滑曲面-ii">光滑曲面 II</h2> <p>好久不看DDG，导致每次看，感觉上次写的自己都看不懂，什么玩意，都需要在简单的温故一下，然后有会觉得有一些上次学习忽略的地方。不管怎样，今天无论如何都要看完Surface II。</p> <h3 id="第一节高斯映射gauss-map">第一节：高斯映射（Gauss Map）</h3> <h4 id="1-基本概念">1. 基本概念</h4> <p>高斯映射是微分几何中描述曲面法向量方向的重要工具，它将曲面上的每一点映射到其单位法向量，从而建立从曲面到单位球面 $ S^2 $ 的对应关系。</p> <ul> <li> <p><strong>单位法向量</strong>：对于曲面 $ M $，其高斯映射定义为：</p> \[N: M \to S^2, \quad p \mapsto N(p)\] <p>其中 $ N(p) $ 是点 $ p $ 处的单位法向量，满足 $ N(p) \perp T_pM $（与切空间正交）。</p> </li> <li> <p><strong>非唯一性</strong>：法向量本身可以有不同方向和长度，但高斯映射标准化为单位长度，仅保留方向信息（正反方向需一致）。</p> </li> </ul> <p><strong>几何意义</strong>：高斯映射通过记录曲面上各点的法向，反映曲面的弯曲和形状特征。例如：</p> <ul> <li>平面映射到球面的一个固定点（法向量恒定）。</li> <li>球面映射到整个单位球面（法向量方向全覆盖）。</li> </ul> <h4 id="2-可定向性orientability">2. 可定向性（Orientability）</h4> <p>并非所有曲面都能全局定义高斯映射，其存在性取决于曲面的<strong>可定向性</strong>：</p> <ul> <li><strong>可定向曲面</strong>（如球面、环面）：可定义连续的高斯映射。</li> <li><strong>不可定向曲面</strong>（如莫比乌斯带）：法向量沿环路移动时会反转，导致高斯映射矛盾。</li> </ul> <p><strong>关键结论</strong>：</p> <ul> <li>高斯映射的全局定义要求曲面可定向。</li> <li>不可定向曲面的法向量场存在拓扑障碍（如莫比乌斯带的单侧性）。</li> </ul> <h4 id="3-示例">3. 示例</h4> <p>通过参数化曲面的切向量计算高斯映射：</p> <ol> <li> <p>给定参数化 $ f(u,v) $，计算切向量：</p> \[\mathrm{d}f_u = \frac{\partial f}{\partial u}, \quad \mathrm{d}f_v = \frac{\partial f}{\partial v}\] </li> <li> <p>法向量由叉积得到：</p> \[N = \frac{\mathrm{d}f_u \times \mathrm{d}f_v}{\|\mathrm{d}f_u \times \mathrm{d}f_v\|}\] <p><strong>条件</strong>：切向量必须线性独立（叉积非零）。</p> </li> </ol> <p><strong>球面例子</strong>：</p> <ul> <li>参数化 $ f(u,v) = (\cos u \sin v, \sin u \sin v, \cos v) $</li> <li> <p>切向量：</p> <p>$ \mathrm{d}f(\frac{\partial}{\partial u}) = (-\sin u \sin v, \cos u \sin v, 0) $,<br/> $ \mathrm{d}f(\frac{\partial}{\partial v}) = (\cos u \cos v, \sin u \cos v, -\sin v) $。</p> </li> <li> <p>叉积结果：</p> <p>$ \mathrm{d}f(\frac{\partial}{\partial u}) \times \mathrm{d}f(\frac{\partial}{\partial v}) = -\sin v \cdot f(u,v) $。</p> </li> <li>单位法向量：$ N = -f(u,v) $（与球心对称，直接取反即可）。</li> </ul> <h4 id="4-满射性surjectivity">4. 满射性（Surjectivity）</h4> <p><strong>问题</strong>：高斯映射是否能覆盖整个单位球面？</p> <ul> <li><strong>封闭凸曲面</strong>（如椭球）：满射（所有法向量方向均存在）。</li> <li><strong>非凸或非闭曲面</strong>（如圆柱、平面）：非满射。 <ul> <li>圆柱面映射到赤道圆，平面映射到单点。</li> </ul> </li> </ul> <p><strong>数学意义</strong>：</p> <ul> <li>满射性反映曲面法向方向的完备性，与曲率分布紧密相关。</li> <li><strong>应用</strong>：在曲面设计中，需控制法向覆盖范围以满足需求（如纹理映射）。</li> </ul> <h4 id="5-向量面积vector-area">5. 向量面积（Vector Area）</h4> <p><strong>定义</strong>：对曲面片 $ \Omega $，向量面积是法向量的加权积分：</p> \[\text{Vector Area} = \int_\Omega N \, \mathrm{d}A = \frac{1}{2} \int_\Omega \mathrm{d}f \wedge \mathrm{d}f\] \[A = \frac{1}{2} \mathrm{d}f \wedge \mathrm{d}f\] <h3 id="exterior-calculus-on-immersed-surfaces">Exterior Calculus on Immersed Surfaces</h3> <h4 id="基本概念">基本概念</h4> <p>Immersed surface是指通过光滑映射 $ f: M \to \mathbb{R}^3 $ 定义的曲面，其中微分 $ \mathrm{d}f $ 处处非退化（即切空间维度保持为2）。</p> <h4 id="induced-area-2-form">Induced Area 2-Form</h4> <ul> <li> <p><strong>定义</strong>：给定参数域中的向量 $ X, Y $，其映射后的有向面积由叉积给出：</p> \[\mathrm{d}A(X, Y) = \| \mathrm{d}f(X) \times \mathrm{d}f(Y) \| \cdot \text{orientation}\] </li> <li> <p><strong>坐标表达式</strong>：若 $ f(u,v) $ 是参数化，则：</p> \[\mathrm{d}A = \| f_u \times f_v \| \, du \wedge dv\] </li> <li> <p><strong>与法向量的关系</strong>：</p> \[\mathrm{d}f \wedge \mathrm{d}f = 2 (\mathrm{d}f(X) \times \mathrm{d}f(Y)) \, du \wedge dv = 2 N \, \mathrm{d}A\] <p>（$ \mathrm{d}f \wedge \mathrm{d}f $ 的方向与单位法向量 $ N $ 一致，大小为 $ 2 \, \mathrm{d}A $）。</p> </li> </ul> <h4 id="hodge-star">Hodge Star</h4> <p>在浸入曲面 $ f(M) $ 上，霍奇星算子需根据微分形式的阶数分别定义：</p> <h5 id="0-forms">0-Forms</h5> <ul> <li> <p><strong>定义</strong>：</p> <p>给定面积2-形式 $ \mathrm{d}A $ 和标量函数（0-形式）$ \phi $，定义：</p> \[\star \phi := \phi \, \mathrm{d}A\] </li> <li> <p><strong>几何意义</strong>：</p> <p>将函数 $ \phi $ 的值作为权重，缩放曲面的局部面积形式 $ \mathrm{d}A $，生成一个<strong>带权面积2-形式</strong>。<br/> <strong>示例</strong>：<br/> 若 $ \phi $ 表示曲面的温度分布，则 $ \star \phi $ 表示“温度加权的面积微元”。</p> </li> </ul> <h5 id="2-forms">2-Forms</h5> <ul> <li> <p><strong>定义</strong>：</p> <p>对任意2-形式 $ \omega $，存在唯一的标量函数 $ \phi $ 使得：</p> \[\omega = \phi \, \mathrm{d}A\] <p>则定义其霍奇对偶为：</p> \[\star \omega := \phi\] </li> <li> <p><strong>几何意义</strong>：</p> <p>将2-形式 $ \omega $ 分解为面积形式 $ \mathrm{d}A $ 和一个标量函数 $ \phi $，提取该函数作为霍奇对偶。</p> <p><strong>示例</strong>：<br/> 若 $ \omega = \sin v \, du \wedge dv $ 且 $ \mathrm{d}A = \sin v \, du \wedge dv $，则 $ \star \omega = 1 $。</p> </li> </ul> <h3 id="complex-structure">Complex Structure</h3> <h4 id="基本定义">基本定义</h4> <p>复结构 $ J $ 是浸入曲面 $ f: M \to \mathbb{R}^3 $ 切空间上的线性算子，满足以下核心性质：</p> <ol> <li><strong>旋转特性</strong>：$ J^2 = -\text{Id} $，即对任意切向量连续应用两次 $ J $ 等价于反向。</li> <li> <p><strong>几何实现</strong>：通过法向量叉积定义切向量的旋转：</p> \[\mathrm{d}f(JX) = N \times \mathrm{d}f(X), \quad \forall X \in T_p M\] <p>其中 $ N $ 是单位法向量，$ \mathrm{d}f $ 是微分映射。</p> </li> </ol> <p>在 $ \mathbb{R}^2 $ 中，标准复结构为固定矩阵：</p> \[J_{\mathbb{R}^2} = \begin{bmatrix} 0 &amp; -1 \\ 1 &amp; 0 \end{bmatrix}, \quad \text{对应旋转} \begin{bmatrix} x \\ y \end{bmatrix} \mapsto \begin{bmatrix} -y \\ x \end{bmatrix}\] <p>曲面上的 $ J $ 是此概念的弯曲推广，其矩阵形式依赖局部几何。</p> <h4 id="显式计算与度量依赖">显式计算与度量依赖</h4> <p>复结构可通过雅可比矩阵 $ A = [\mathrm{d}f_u \ \mathrm{d}f_v] $ 和法向量叉积矩阵 $ \hat{N} $ 显式求解：</p> \[J = (A^T A)^{-1} A^T \hat{N} A\] <p><strong>关键步骤</strong>：</p> <ol> <li><strong>度量矩阵</strong>：$ A^T A $ 是诱导度量 $ g $ 的坐标表示。</li> <li> <p><strong>叉积矩阵</strong>：</p> \[\hat{N} = \begin{bmatrix} 0 &amp; -N_z &amp; N_y \\ N_z &amp; 0 &amp; -N_x \\ -N_y &amp; N_x &amp; 0 \end{bmatrix}\] </li> <li><strong>方程意义</strong>：$ A J = \hat{N} A $ 确保参数域旋转与 $ \mathbb{R}^3 $ 叉积旋转一致。</li> </ol> <h4 id="共形浸入的判定">共形浸入的判定</h4> <p>浸入 $ f $ 是共形（保角）的充要条件为：</p> \[J = J_{\mathbb{R}^2}\] <p>此时曲面仅允许局部伸缩，角度保持不变。</p> \[\mathrm{d}f(JX) = N \times \mathrm{d}f(X) \Rightarrow J = (A^T A)^{-1} A^T \hat{N} A\] <h5 id="hodge-star-on-1-forms">Hodge star on 1-forms</h5> <p>对于浸入曲面 $f: M \to \mathbb{R}^3$ 上的 1-形式 $\alpha$，其Hodge star运算定义为：</p> \[(\star_f \alpha)(X) = \alpha(\mathcal{J}_f X)\] <p>其中：</p> <ul> <li>$X$ 是 $ T_p M$ 中的任意切向量。</li> <li> <p>$\mathcal{J}_f$ 就是你前面定义的曲面上的复结构（局部90度旋转）：</p> \[\mathrm{d}f(\mathcal{J}_f X) = N \times \mathrm{d}f(X)\] </li> </ul> <p><strong>几何理解</strong>：</p> <ul> <li>在 $\mathbb{R}^2$ 中，$\star$ 对 1-形式相当于把向量旋转 $90^\circ$。</li> <li>在曲面 $M$ 上，$\star_f$ 就通过局部法向量来确定“哪边是左，哪边是右”，从而将切向量场沿着面内旋转 $90^\circ$，再用 $\alpha$ 取值。</li> </ul> <h6 id="与其他阶霍奇星的统一性">与其他阶霍奇星的统一性</h6> <ul> <li><strong>0-形式</strong>：$ \star_f \phi = \phi \, \mathrm{d}A $</li> <li><strong>1-形式</strong>：$ \star_f \alpha(X) = \alpha(\mathcal{J}_f X) $</li> <li><strong>2-形式</strong>：$ \star_f (\phi \, \mathrm{d}A) = \phi $</li> </ul> <h4 id="metric-area-form-and-complex-structure">Metric, Area Form, and Complex Structure</h4> <p>在曲面上，黎曼度规 $ g(X,Y) $ 可以分解为<strong>面积形式 $ \mathrm{d}A $</strong> 和<strong>复结构 $ J $</strong> 的组合：</p> \[g(X, Y) = \mathrm{d}A(X, JY)\] <p>其中：</p> <ul> <li>$ \mathrm{d}A $ 是曲面的有向面积2-形式（$ \mathrm{d}A(X,Y) = |X \times Y| $）。</li> <li>$ J $ 是切空间中的90度旋转算子（复结构），满足 $ J^2 = -\text{Id} $。</li> </ul> <h5 id="二维平面-mathbbr2-中的类比">二维平面（$ \mathbb{R}^2 $）中的类比</h5> <p>在平面上，Metric、Cross和Complex Structure $ J $ 满足类似关系：</p> \[X \cdot Y = X \times (JY)\] <p><strong>推导</strong>：</p> <ol> <li>设 $ X = (x_1, x_2) $，$ Y = (y_1, y_2) $，平面复结构 $ J = \begin{bmatrix} 0 &amp; -1 \ 1 &amp; 0 \end{bmatrix} $。</li> <li>计算 $ JY = (-y_2, y_1) $。</li> <li>叉积 $ X \times (JY) = x_1 y_1 + x_2 y_2 = X \cdot Y $。</li> </ol> <p><strong>几何意义</strong>：</p> <ul> <li>左边 $ X \cdot Y $ 是向量的点积（度量内积）。</li> <li>右边 $ X \times (JY) $ 通过旋转 $ Y $ 后与 $ X $ 叉积，结果等于点积。</li> <li><strong>本质</strong>：点积与叉积通过复结构 $ J $ 联系起来。</li> </ul> <h4 id="曲面上的sharp与flat算子">曲面上的Sharp（♯）与Flat（♭）算子</h4> <p>在曲面 $ f: M \to \mathbb{R}^3 $ 上，<strong>诱导度量 $ g $</strong> 允许我们在<strong>向量场</strong>和<strong>1-形式</strong>之间转换：</p> <ul> <li><strong>Flat（♭）</strong>：将向量场 $ X $ 转换为对应的1-形式 $ X^b $。</li> <li><strong>Sharp（♯）</strong>：将1-形式 $ \alpha $ 转换为对应的向量场 $ \alpha^# $。</li> </ul> <h5 id="flat-算子">Flat 算子（♭）</h5> <p>对向量场 $ X $，定义其对应的1-形式 $ X^b $ 为：</p> \[X^b(Y) := g(X, Y) = \langle \mathrm{d}f(X), \mathrm{d}f(Y) \rangle_{\mathbb{R}^3}\] <h5 id="sharp-算子">Sharp 算子（♯）</h5> <p>对1-形式 $ \alpha $，定义其对应的向量场 $ \alpha^# $ 为：</p> \[g(\alpha^\#, Y) := \alpha(Y), \quad \forall Y\]]]></content><author><name></name></author><category term="DDG"/><category term="Geometry"/><summary type="html"><![CDATA[原课件来自：https://brickisland.net/ddg-web/]]></summary></entry><entry><title type="html">DDG Discrete Curves</title><link href="https://pasu.github.io/blog/2025/Discrete_Curve/" rel="alternate" type="text/html" title="DDG Discrete Curves"/><published>2025-06-11T10:27:00+00:00</published><updated>2025-06-11T10:27:00+00:00</updated><id>https://pasu.github.io/blog/2025/Discrete_Curve</id><content type="html" xml:base="https://pasu.github.io/blog/2025/Discrete_Curve/"><![CDATA[<h2 id="平面中的离散曲线">平面中的离散曲线</h2> <p>在离散微分几何中，<strong>离散曲线</strong>被定义为一种<strong>分段线性参数化曲线</strong>，即由一系列点通过直线段连接而成的几何对象。形式上，给定一组有序点 $\gamma_0, \gamma_1, \ldots, \gamma_n \in \mathbb{R}^2$，离散曲线 $\gamma$ 是由这些点依次相连构成的折线。其参数化表示为：</p> \[\gamma(s) = (1-t)\gamma_i + t\gamma_{i+1}, \quad \text{其中} \ s \in [s_i, s_{i+1}], \ t = \frac{s-s_i}{s_{i+1}-s_i}.\] <p>为简化记号，常用 $\gamma_i$ 表示 $\gamma(s_i)$，即第 $i$ 个顶点的位置。</p> <p>关键特性有：</p> <ol> <li><strong>分段线性</strong>：曲线在每对相邻点之间是直线段，整体呈现折线形态。</li> <li><strong>连续性与参数化</strong>：尽管离散，曲线仍是连续的参数化映射，但与传统光滑曲线的解析表达式不同。</li> <li><strong>离散微分形式</strong>：可通过抽象单纯复形和离散0-形式（顶点坐标）定义，利用Whitney基函数（如“帽子函数”）实现边上的插值。</li> </ol> <h3 id="示例">示例</h3> <p>一个简单的例子是由两段线段组成的L形曲线：</p> \[\gamma(s) = \begin{cases} (s, 0), &amp; 0 \leq s \leq 1, \\ (1, s-1), &amp; 1 \leq s \leq 2. \end{cases}\] <p>此曲线从点 $(0,0)$ 水平延伸至 $(1,0)$，再垂直延伸至 $(1,1)$。</p> <h3 id="离散曲线的微分">离散曲线的微分</h3> <p>在光滑曲线的理论中，微分 $d\gamma$ 描述了曲线在每一点的切向量场。对于离散曲线，这一概念可以通过<strong>离散外微积分</strong>（Discrete Exterior Calculus）自然地推广：</p> <p>离散曲线的微分 $d\gamma$ 被定义为<strong>边向量</strong>的集合。对于相邻顶点 $\gamma_i$ 和 $\gamma_j$，其对应的边向量为：</p> \[(d\gamma)_{ij} = \gamma_j - \gamma_i.\] <p>这一表达式直接类比于光滑曲线中微分 $d\gamma = \frac{d\gamma}{ds}ds$ 的离散形式，其中边向量 $(d\gamma)_{ij}$ 取代了连续情形下的切向量 $\frac{d\gamma}{ds}$。</p> <h3 id="离散切线向量">离散切线向量</h3> <p>在光滑曲线中，切线方向由导数 $\frac{d\gamma}{ds}$ 给出。对于离散曲线，我们通过归一化<strong>边向量</strong>来定义切线，但需要特别注意离散几何与连续几何的关键差异：</p> <p>对于离散曲线的每一条边 $ij$（连接顶点 $\gamma_i$ 和 $\gamma_j$），其<strong>离散切线向量</strong> $T_{ij}$ 定义为：</p> <p>$ T_{ij} = \frac{(d\gamma)<em>{ij}}{|(d\gamma)</em>{ij}|} = \frac{\gamma_j - \gamma_i}{|\gamma_j - \gamma_i|}. $</p> <p>这表示该边的单位方向向量，与光滑曲线中切线的局部方向作用类似。</p> <h3 id="离散法向量">离散法向量</h3> <p>在平面离散曲线中，法向量的定义延续了光滑曲线中的直观几何思想——通过切线旋转90度得到。然而，离散特性为其带来了独特的性质和应用限制。对于离散曲线的每一条边 $ij$，其<strong>离散法向量</strong> $N_{ij}$ 由对应的单位切线 $T_{ij}$ 逆时针旋转90度生成：</p> \[N_{ij} = \mathcal{J}T_{ij}\] <p>在二维平面中，若 $T_{ij} = (a, b)$，则法向量为 $N_{ij} = (-b, a)$。</p> <h3 id="正则离散曲线与离散浸入">正则离散曲线与离散浸入</h3> <p>在离散微分几何中，为了保证离散曲线具有与光滑曲线类似的良好性质，我们需要引入<strong>正则性</strong>（regularity）的概念。对于光滑曲线 其正则性要求等价于参数化是<strong>局部单射</strong>的（无自交或尖点）。</p> <p>离散化后，直接推广会面临新问题：</p> <ol> <li><strong>边长度非零</strong>： <ul> <li>若边长度为零（$\gamma_i = \gamma_j$），则微分 $(d\gamma)_{ij} = 0$，破坏了正则性。</li> <li>但仅此条件不足，因相邻边可能形成零夹角。</li> </ul> </li> <li><strong>局部单射性</strong>： <ul> <li>更强的要求是曲线作为映射是<strong>局部单射</strong>的，即排除以下情况： <ul> <li>边重叠（如两条边共线且部分重合）。</li> <li>顶点自交（如一条边的端点穿过另一条边）。</li> </ul> </li> </ul> </li> </ol> <h3 id="离散曲率">离散曲率</h3> <p>在《DDG(2)：Curvature》已经提到了如下的定义：</p> <h3 id="离散平面曲线的基本定理">离散平面曲线的基本定理</h3> <p>对于正则离散平面曲线，<strong>在刚体运动（平移/旋转）意义下，曲线由其边长度序列 ${l_{ij}}$ 和转角序列 ${\theta_i}$ 唯一确定</strong>。</p> <p>其中：</p> <ul> <li><strong>边长度</strong> $l_{ij} = |\gamma_j - \gamma_i|$</li> <li><strong>转角</strong> $\theta_i$ 为相邻边 $ (i-1,i) $ 与 $ (i,i+1) $ 的有向夹角（逆时针为正）。</li> </ul> <p>给定 ${l_{ij}}, {\theta_i}$ 和初始点 $\gamma_0$，按以下步骤重构曲线：</p> <ol> <li> <p><strong>计算累积转角</strong></p> <p>从初始方向 $T_0 = (1,0)$ 开始，逐顶点计算边的全局方向角 $\varphi_i$：</p> \[\varphi_i = \varphi_{i-1} + \theta_{i-1}, \quad \text{其中} \ \varphi_0 = 0.\] </li> <li> <p><strong>生成单位切向量</strong></p> <p>将方向角转换为单位切向量：</p> \[T_i = (\cos \varphi_i, \sin \varphi_i).\] </li> <li> <p><strong>逐边积分求顶点坐标</strong></p> <p>通过累加边长与切向量的乘积得到顶点位置：<br/> \(\gamma_i = \gamma_{i-1} + l_{i-1,i} \cdot T_{i-1}.\)</p> </li> </ol> <h4 id="示例演示">示例演示</h4> <p><strong>给定数据</strong>：</p> <ul> <li>边长度：$l_{01} = 1, l_{12} = 1, l_{23} = 1$</li> <li>转角：$\theta_0 = 0°, \theta_1 = 90°, \theta_2 = 0°$</li> <li>初始点：$\gamma_0 = (0,0)$</li> </ul> <p><strong>重建过程</strong>：</p> <ol> <li> <p>计算方向角：</p> <ul> <li>$\varphi_0 = 0°$</li> <li>$\varphi_1 = 0° + 0° = 0°$</li> <li>$\varphi_2 = 0° + 90° = 90°$</li> <li>$\varphi_3 = 90° + 0° = 90°$</li> </ul> </li> <li> <p>切向量：</p> <ul> <li>$T_0 = (1,0)$</li> <li>$T_1 = (1,0)$</li> <li>$T_2 = (0,1)$</li> <li>$T_3 = (0,1)$</li> </ul> </li> <li> <p>顶点坐标：</p> <ul> <li>$\gamma_1 = (0,0) + 1 \cdot (1,0) = (1,0)$</li> <li>$\gamma_2 = (1,0) + 1 \cdot (0,1) = (1,1)$</li> <li>$\gamma_3 = (1,1) + 1 \cdot (0,1) = (1,2)$</li> </ul> </li> </ol> <p>最终曲线为直角折线，验证定理正确性。</p> <h3 id="离散whitney-graustein定理">离散Whitney-Graustein定理</h3> <p>对于<strong>局部单射的正则离散平面曲线</strong>，其<strong>正则同伦类</strong>（即在不违反局部单射性的连续变形下的等价类）完全由离散转向数（Discrete Turning Number）决定，完美类比于光滑曲线的Whitney-Graustein定理。</p> <table> <thead> <tr> <th>方法</th> <th>提出者</th> <th>核心思想</th> <th>适用场景</th> </tr> </thead> <tbody> <tr> <td><strong>构造性算法</strong></td> <td>Mehlhorn &amp; Yap (1991)</td> <td>通过案例分析将曲线逐步变形为标准多边形</td> <td>计算几何实现</td> </tr> <tr> <td><strong>凸多面体法</strong></td> <td>Pinkall (1994)</td> <td>将曲线提升到三维空间构造凸包，利用投影性质</td> <td>理论分析</td> </tr> </tbody> </table> <p><strong>共同策略</strong>：</p> <ol> <li>将目标曲线变形为<strong>标准参考曲线</strong>（如正多边形）。</li> <li>通过组合两条曲线到参考曲线的路径得到同伦。</li> </ol> <h3 id="离散空间曲线">离散空间曲线</h3> <p>同理，<strong>离散空间曲线</strong>是三维空间中的分段线性参数化曲线，由有序顶点序列 ${\gamma_i} \in \mathbb{R}^3$ 通过直线段连接而成，其数学表示为：</p> \[\gamma(s) = (1-t)\gamma_i + t\gamma_{i+1}, \quad t \in [0,1], \ s \in [s_i,s_{i+1}].\] <h3 id="离散空间曲线基本定理">离散空间曲线基本定理</h3> <p>在刚体运动（平移+旋转）意义下，<strong>正则离散空间曲线</strong>由以下数据唯一确定：</p> <ol> <li><strong>边长度</strong> ${l_{ij}}$（替代弧长参数）</li> <li><strong>顶点曲率</strong> ${\kappa_i}$（相邻边外角）</li> <li><strong>边挠率</strong> ${\tau_{ij}}$（法向量扭转角）</li> </ol> <p>与光滑理论的类比</p> <table> <thead> <tr> <th>光滑曲线</th> <th>离散曲线</th> <th>几何意义</th> </tr> </thead> <tbody> <tr> <td>弧长参数 $s$</td> <td>边长度 $l_{ij}$</td> <td>局部尺度度量</td> </tr> <tr> <td>曲率 $\kappa(s)$</td> <td>顶点外角 $\kappa_i$</td> <td>局部弯曲程度</td> </tr> <tr> <td>挠率 $\tau(s)$</td> <td>边扭转角 $\tau_{ij}$</td> <td>局部扭转程度</td> </tr> </tbody> </table> <h4 id="曲线重构算法">曲线重构算法</h4> <p><strong>输入</strong>：</p> <ul> <li>边长度 ${l_{01}, l_{12}, …, l_{n-1,n}}$</li> <li>顶点曲率 ${\kappa_1, \kappa_2, …, \kappa_{n-1}}$</li> <li>边挠率 ${\tau_{01}, \tau_{12}, …, \tau_{n-1,n}}$</li> <li>初始条件：$\gamma_0 \in \mathbb{R}^3$, 初始标架 $(T_0, N_0, B_0)$</li> </ul> <p><strong>逐边递推</strong>：</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
       <span class="c1"># 计算下一顶点位置
</span>       <span class="n">γ</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">γ</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
       
       <span class="c1"># 曲率旋转：绕当前法向量N旋转κ_i
</span>       <span class="n">R_κ</span> <span class="o">=</span> <span class="nf">rotation_matrix</span><span class="p">(</span><span class="n">N</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">κ</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
       <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">R_κ</span> <span class="o">@</span> <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
       <span class="n">B_temp</span> <span class="o">=</span> <span class="n">R_κ</span> <span class="o">@</span> <span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
       
       <span class="c1"># 挠率旋转：绕新切向量T[i+1]旋转τ_i
</span>       <span class="n">R_τ</span> <span class="o">=</span> <span class="nf">rotation_matrix</span><span class="p">(</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">τ</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
       <span class="n">N</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">R_τ</span> <span class="o">@</span> <span class="n">N</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
       <span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">R_τ</span> <span class="o">@</span> <span class="n">B_temp</span>
</code></pre></div></div> <h3 id="曲率流">曲率流</h3> <p>曲率流描述曲线随时间演化，其运动速度由曲率函数决定：</p> \[\frac{\partial \gamma}{\partial t} = V(\kappa)N\] <p>其中 $V(\kappa)$ 是曲率 $\kappa$ 的标量函数，$N$ 为单位法向量。</p> <h3 id="length-shortening-flow">Length Shortening Flow</h3> <p>长度缩短流是最基础的曲率流，其演化方程由曲线长度的变分直接导出：</p> \[\frac{\partial \gamma}{\partial t} = \kappa N\] <p>其中曲率 $\kappa$ 和法向量 $N$ 共同决定了曲线的收缩速度。</p> <ol> <li><strong>凸性保持</strong> <ul> <li>初始凸的曲线保持凸性</li> <li>非凸曲线会产生拐点（根据Gage-Hamilton定理）</li> </ul> </li> <li><strong>封闭曲线演化</strong><br/> | 阶段 | 现象 | 数学描述 |<br/> |——|——|———-|<br/> | 早期 | 高频振荡快速平滑 | $|\kappa|_{max}$ 递减 |<br/> | 中期 | 渐近圆形化 | $\text{偏心率} \to 0$ |<br/> | 末期 | 收敛到圆点 | $\text{面积} \sim O(t_f-t)$ |</li> </ol> <h4 id="gage-grayson-hamilton">Gage-Grayson-Hamilton</h4> <p>质心守恒定理 渐近圆形化（Round Points） 嵌入性保持（Embeddedness）</p> <h3 id="离散长度缩短流">离散长度缩短流</h3> <p>给定连续方程：</p> \[\frac{d}{dt} \gamma(s, t) = -\kappa(s, t) N(s, t)\] <p>离散化为显式欧拉格式，这里的$\tau$是离散下的$\Delta t$：</p> \[\frac{\gamma^{k+1}(s) - \gamma^k(s)}{\tau} = -\kappa^k(s) N^k(s)\] <p>最终得到顶点更新公式：</p> \[\gamma_i^{k+1} = \gamma_i^k - \tau \kappa_i^k N_i^k\] <h3 id="elastic-flow-弹性流">Elastic Flow 弹性流</h3> <p>弹性流以<strong>弯曲能最小化</strong>为目标，其连续形式能量泛函为欧拉-伯努利能量：</p> \[E(\gamma) = \int_\gamma \kappa^2 \, ds\] <p>对应的梯度流方程为：</p> \[\frac{\partial \gamma}{\partial t} = -\left( \frac{\partial^2 \kappa}{\partial s^2} + \frac{1}{2}\kappa^3 \right)N\] <h4 id="isometric-elastic-flow-等距弹性流">Isometric Elastic Flow 等距弹性流</h4> <p>通过<strong>直接调整离散曲率</strong>（转角）实现曲线平滑，同时严格保持边长不变。其优势在于：</p> <ul> <li><strong>刚性保持</strong>：不改变边长度（等距约束）</li> <li><strong>数值稳定性</strong>：避免显式处理高阶导数</li> <li><strong>几何直观</strong>：曲率缩放对应物理上的”弯曲刚度”调节</li> </ul> <p>曲线还有很多其他的应用，具体可以查看slides以及对应的videos，比如：</p> <ol> <li><strong>弹性杆 (Elastic Rods)</strong> <ul> <li><strong>核心量</strong>：曲率κ + 挠率τ</li> <li><strong>能量</strong>：$E = \int (\alpha \kappa^2 + \beta \tau^2) ds$</li> <li><strong>应用</strong>：头发/电缆模拟</li> </ul> </li> <li><strong>粘性丝线 (Viscous Threads)</strong> <ul> <li><strong>核心量</strong>：曲率κ + 黏度η</li> <li><strong>方程</strong>：$\gamma_t = \eta (\kappa N)_t$</li> <li><strong>特性</strong>：拉伸时变细，松弛时回弹</li> </ul> </li> <li><strong>解结算法 (Untangling Knots)</strong> <ul> <li><strong>方法</strong>：Möbius能量最小化</li> <li> <table> <tbody> <tr> <td><strong>能量</strong>：$E = \iint \frac{1}{</td> <td>\gamma(s)-\gamma(t)</td> <td>^2} ds dt$</td> </tr> </tbody> </table> </li> <li><strong>用途</strong>：分子生物学/拓扑优化</li> </ul> </li> <li><strong>排斥曲线 (Repulsive Curves)</strong> <ul> <li><strong>核心</strong>：几何排斥势 $E = \sum e^{-d_{ij}^2/\sigma}$</li> <li><strong>优势</strong>：避免自交同时保持光滑</li> </ul> </li> <li><strong>烟环流 (Smoke Ring Flow)</strong> <ul> <li><strong>方程</strong>：$\gamma_t = \kappa B$ (Binormal流)</li> <li><strong>特性</strong>：保持涡丝环量</li> <li><strong>离散</strong>：Hashimoto离散格式</li> </ul> </li> <li><strong>气泡环与墨水晶灯 (Bubble Rings &amp; Ink Chandeliers)</strong> <ul> <li><strong>现象</strong>：流体-固体耦合中的三维涡环</li> <li><strong>关键</strong>：浸入边界法 + 表面张力模型</li> </ul> </li> </ol> <h2 id="总结">总结</h2> <ul> <li><strong>离散曲线</strong>：由顶点序列 ${\gamma_i}$ 和连接它们的直线段（边）构成的分段线性曲线。</li> <li><strong>参数化</strong>：$γ(s) = (1-t)γ_i + tγ_{i+1}$，其中 $t \in [0,1]$ 为局部参数。</li> <li><strong>正则性</strong>：要求无自交、无退化边（边长 $&gt;0$），且局部单射。</li> <li><strong>长度缩短流</strong>：$\gamma_t = -\kappa N$ <ul> <li>特性：收缩曲线，凸性保持，封闭曲线收敛到圆点（Gage-Grayson-Hamilton定理）。</li> </ul> </li> <li><strong>弹性流</strong>：最小化弯曲能 $E = \int \kappa^2 ds$，方程为 $\gamma_t = -(\kappa_{ss} + \frac{1}{2}\kappa^3)N$。</li> <li><strong>等距弹性流</strong>：缩放曲率但保持边长不变，适用于刚性变形。</li> </ul>]]></content><author><name></name></author><category term="DDG"/><category term="Geometry"/><summary type="html"><![CDATA[平面中的离散曲线]]></summary></entry><entry><title type="html">DDG Smooth Surfaces</title><link href="https://pasu.github.io/blog/2025/Smooth_Surfaces_1/" rel="alternate" type="text/html" title="DDG Smooth Surfaces"/><published>2025-06-11T10:27:00+00:00</published><updated>2025-06-11T10:27:00+00:00</updated><id>https://pasu.github.io/blog/2025/Smooth_Surfaces_1</id><content type="html" xml:base="https://pasu.github.io/blog/2025/Smooth_Surfaces_1/"><![CDATA[<h2 id="光滑曲面">光滑曲面</h2> <p>在上一部分中，我们研究了一维曲线的几何性质，包括光滑曲线（如参数化曲线、弧长参数化、曲率等）和离散曲线（如折线、离散曲率等）。现在，我们将视角扩展到二维曲面，探讨如何将曲线的概念推广到更高维度的几何对象。</p> <h4 id="局部视角">局部视角</h4> <p>最初，我们通过<strong>局部几何</strong>来描述曲面。与曲线类似，曲面的<strong>参数化</strong>提供了一种<strong>外在描述</strong>，即曲面如何嵌入在空间中。例如，给定一个二维区域 ( U \subset \mathbb{R}^2 ) 和一个映射 ( f: U \to \mathbb{R}^3 )，我们可以通过 ( f ) 的像 ( f(U) ) 来表示曲面。这种描述依赖于曲面的具体位置和形状在空间中的表现。</p> <h4 id="全局视角">全局视角</h4> <p>通过将多个局部参数化片段拼接在一起，可以描述整个曲面。这种<strong>全局描述</strong>仍然是外在的，因为它依赖于曲面在空间中的嵌入方式。例如，球面可以通过多个局部参数化（如经纬度坐标）覆盖，最终组合成一个完整的几何对象。</p> <h3 id="内蕴视角-intrinsic">内蕴视角 (Intrinsic)</h3> <p>从全局描述出发，我们可以进一步“抛弃”曲面的空间嵌入，仅保留其<strong>内蕴几何</strong>。此时，曲面的形状信息由<strong>黎曼度量</strong>（Riemannian metric）编码，它记录了曲面上每一点的切空间中的长度和角度关系。</p> <ul> <li>黎曼度量 ( g(X, Y) ) 是一个光滑变化的双线性形式，满足正定性。</li> <li>通过度量，可以计算曲线的长度、区域的面积、切向量的夹角等，而无需知道曲面如何嵌入更高维空间。</li> <li><strong>关键思想</strong>：内蕴几何不依赖于外部空间，甚至可以描述无法嵌入低维空间的几何对象（如双曲平面）。</li> </ul> <h4 id="离散视角">离散视角</h4> <p>在离散几何中，曲面的几何性质可以通过<strong>边长</strong>（内蕴）而非顶点坐标（外在）来定义。例如，三角形网格的几何完全由边长和夹角决定，无需显式指定顶点在空间中的位置。</p> <p>这种从局部到全局再到内蕴的视角，不仅适用于光滑曲面，也为离散几何的研究提供了重要工具。</p> <h3 id="参数化曲面parameterized-surface">参数化曲面（Parameterized Surface）</h3> <p>一个<strong>参数化曲面</strong>是指从二维区域 $ U \subset \mathbb{R}^2 $ 到空间 $ \mathbb{R}^n $的映射：</p> \[f: U \to \mathbb{R}^n, \quad (u, v) \mapsto f(u, v)\] <p>其中：</p> <ul> <li>$ U $ 是参数域（如单位圆盘、矩形等）。</li> <li>$ f $ 的像 $ f(U) $ 称为曲面的<strong>图像（image）</strong>，表示曲面在空间中的实际形状。</li> </ul> <p>通常，平滑曲面具有如下的性质：<strong>连续性（Continuous）</strong>，<strong>可微性（Differentiable）</strong>，<strong>光滑性（Smooth, $ C^\infty $）</strong>。</p> <h4 id="示例鞍面saddle-surface">示例：鞍面（Saddle Surface）</h4> <p>鞍面（双曲抛物面）的标准参数化可表示为：</p> \[f(u, v) = (u, v, u^2 - v^2), \quad \text{其中} \quad (u, v) \in U \subset \mathbb{R}^2\] <p>这里，参数域 $ U $ 通常取单位圆盘 $ U = {(u, v) \mid u^2 + v^2 \leq 1} $ 或其他有界区域。</p> <h3 id="曲面的重新参数化reparameterization">*曲面的重新参数化（Reparameterization）</h3> <p>重新参数化是指用<strong>不同的参数域映射</strong>描述<strong>同一个几何曲面</strong>。例如，鞍面可以表示为：</p> \[f(u,v) = (u, v, u^2 - v^2) \quad \text{或} \quad \hat{f}(s,t) = (s+t, s-t, 4st)\] <p>尽管参数形式不同，但它们的像（即实际曲面）完全相同。</p> <h4 id="重新参数化的意义">重新参数化的意义</h4> <ol> <li><strong>数学灵活性</strong> <ul> <li>某些计算（如积分、曲率）在特定参数化下更简单（如保角参数化）。</li> </ul> </li> <li><strong>应用需求</strong> <ul> <li>在计算机图形学中，不同的参数化可能影响纹理映射的质量或数值模拟的稳定性。</li> </ul> </li> <li><strong>几何不变性</strong> <ul> <li>曲面的本质属性（如高斯曲率）与参数化无关，但显式计算依赖参数选择。</li> </ul> </li> </ol> <p>重新参数化揭示了曲面描述中的自由度，既是理论研究的工具，也是实际应用中需解决的难题（如形状匹配）。理解这一概念有助于区分几何的<strong>本质属性</strong>与<strong>描述方式</strong>的差异。</p> <h3 id="嵌入曲面embedded-surface">嵌入曲面（Embedded Surface）</h3> <p>一个<strong>嵌入曲面</strong>是指通过参数化映射 $ f: U \to \mathbb{R}^3 $ 将二维区域 $ U $ <strong>无自交</strong>、<strong>无撕裂</strong>地放入三维空间，且保持原域的基本拓扑结构。</p> <ul> <li><strong>关键要求</strong>：曲面不能“穿过自身”（无自交），也不能出现“粘合”（如将圆柱两端粘合为环面时需特殊处理）。</li> </ul> <p>参数化 $ f $ 是一个<strong>嵌入</strong>，若满足：</p> <ol> <li><strong>连续双射</strong>：$ f $ 是 $ U $ 到 $ f(U) $ 的一一对应连续映射。</li> <li><strong>逆映射连续</strong>：$ f^{-1}: f(U) \to U $ 也连续。</li> </ol> <h3 id="曲面微分differential-of-a-surface">曲面微分（Differential of a Surface）</h3> <p>曲面的微分 $ \mathrm{d}f $ 是一个关键工具，它描述了<strong>参数域上的切向量</strong>如何被“推前”（push forward）到<strong>三维空间的切平面</strong>中。</p> <p>$ \mathrm{d}f $ 将参数平面的“微小箭头” $ X $ 拉伸、旋转为曲面上的切向量，揭示了曲面的局部线性近似。</p> <h4 id="坐标表示differential-in-coordinates">坐标表示（Differential in Coordinates）</h4> <p>曲面的微分 $ \mathrm{d}f $ 可以显式表示为参数化的<strong>外导数</strong>，它将参数域 $ U \subset \mathbb{R}^2 $ 上的向量场 $ X $ 映射到曲面切空间中的向量 $ \mathrm{d}f(X) $。</p> <p>给定参数化 $ f: U \to \mathbb{R}^3 $，其微分 $ \mathrm{d}f $ 可展开为：</p> \[\mathrm{d}f = \frac{\partial f}{\partial u} \mathrm{d}u + \frac{\partial f}{\partial v} \mathrm{d}v\] <p>其中：</p> <ul> <li>$ \mathrm{d}u $ 和 $ \mathrm{d}v $ 是参数域的<strong>对偶基</strong>（1-形式），表示沿 $ u $、$ v $ 方向的微小变化。</li> <li>$ \frac{\partial f}{\partial u} $ 和 $ \frac{\partial f}{\partial v} $ 是曲面的<strong>切向量</strong>（Jacobian 矩阵的列）。</li> </ul> <p><strong>几何解释</strong>：</p> <p>$ \mathrm{d}f $ 将参数平面的向量 $ X = a \partial_u + b \partial_v $ 线性组合为曲面切向量：</p> \[\mathrm{d}f(X) = a \frac{\partial f}{\partial u} + b \frac{\partial f}{\partial v}\] <h5 id="推前向量场push-forward">推前向量场（Push Forward）</h5> <p>若参数域上有向量场 $ X = \alpha(u,v) \partial_u + \beta(u,v) \partial_v $，则其推前 $ \mathrm{d}f(X) $ 为：</p> \[\mathrm{d}f(X) = \alpha(u,v) \frac{\partial f}{\partial u} + \beta(u,v) \frac{\partial f}{\partial v}\] <h5 id="鞍面示例">鞍面示例</h5> <p>考虑鞍面 $ f(u,v) = (u, v, u^2 - v^2) $：</p> <ol> <li> <p><strong>求偏导</strong>：</p> \[\frac{\partial f}{\partial u} = (1, 0, 2u), \quad \frac{\partial f}{\partial v} = (0, 1, -2v)\] </li> <li> <p><strong>向量场推前</strong>：对 $ X = \frac{3}{4} (\partial_u - \partial_v) $，有：</p> \[\mathrm{d}f(X) = \frac{3}{4} \left( (1,0,2u) - (0,1,-2v) \right) = \frac{3}{4} (1, -1, 2(u + v))\] <p>在点 $ (u,v) = (0,0) $ 处，$ \mathrm{d}f(X) = \left( \frac{3}{4}, -\frac{3}{4}, 0 \right) $。</p> </li> </ol> <h3 id="雅可比矩阵jacobian">雅可比矩阵（Jacobian）</h3> <p>对于映射 $ f: \mathbb{R}^n \to \mathbb{R}^m $，其<strong>雅可比矩阵</strong> $ J_f $ 是一个 $ m \times n $ 矩阵，表示 $ f $ 的微分 $ \mathrm{d}f $ 在标准基下的线性变换：</p> \[J_f := \begin{bmatrix} \frac{\partial f^1}{\partial x^1} &amp; \cdots &amp; \frac{\partial f^1}{\partial x^n} \\ \vdots &amp; \ddots &amp; \vdots \\ \frac{\partial f^m}{\partial x^1} &amp; \cdots &amp; \frac{\partial f^m}{\partial x^n} \end{bmatrix}\] <p>其中 $ f^1, \ldots, f^m $ 是 $ f $ 的分量函数，$ x^1, \ldots, x^n $ 是 $ \mathbb{R}^n $ 的坐标。</p> <h4 id="几何意义">几何意义</h4> <ol> <li> <p><strong>微分的作用</strong>：<br/> 雅可比矩阵将输入空间 $ \mathbb{R}^n $ 的切向量 $ X $ 线性映射到输出空间 $ \mathbb{R}^m $ 的切向量：</p> \[\mathrm{d}f(X) = J_f X\] <ul> <li><strong>曲线</strong>（$ n=1 $）：$ J_f $ 是切向量 $ \gamma’(t) $。</li> <li><strong>曲面</strong>（$ n=2, m=3 $）：$ J_f $ 的列向量张成切平面（如 $ \partial_u f, \partial_v f $）。</li> </ul> </li> <li> <p><strong>局部线性近似</strong>：</p> <p>$ J_f $ 描述了 $ f $ 在一点附近的<strong>最佳线性逼近</strong>，即：</p> \[f(p + h) \approx f(p) + J_f h \quad \text{（当 } \|h\| \to 0\text{）}\] </li> </ol> <h3 id="浸入曲面immersed-surface">浸入曲面（Immersed Surface）</h3> <p>一个参数化映射 $ f: U \to \mathbb{R}^n $ 称为<strong>浸入（immersion）</strong>，如果其微分 $ \mathrm{d}f $ 在每一点 $ p \in U $ 都是<strong>非退化的</strong>，即：</p> \[\mathrm{d}f(X)|_p = 0 \iff X|_p = 0 \quad \forall p \in U.\] <ul> <li><strong>几何意义</strong>：曲面的切空间在每点都保持二维性，没有“压扁”或“退化”。</li> <li><strong>关键性质</strong>：即使曲面全局自交（如自交的 Klein 瓶），局部仍可定义切平面、法向量等几何量。</li> </ul> <h4 id="示例球面参数化">示例：球面参数化</h4> <p>考虑球面的标准参数化：</p> \[f(u,v) = (\cos u \sin v, \sin u \sin v, \cos v), \quad v \in (0, \pi)\] <p>其微分 ( \mathrm{d}f ) 的矩阵表示为：</p> \[J_f = \begin{bmatrix} -\sin u \sin v &amp; \cos u \cos v \\ \cos u \sin v &amp; \sin u \cos v \\ 0 &amp; -\sin v \end{bmatrix}\] <ul> <li><strong>问题</strong>：当 $ v = 0 $ 或 $ v = \pi $（两极）时，$ \frac{\partial f}{\partial u} = (0, 0, 0) $，微分退化 （无法向东西或南北行走）。</li> <li><strong>结论</strong>：球面参数化在<strong>两极不是浸入</strong>（无法定义东西方向的切向量）。</li> </ul> <p>浸入是微分几何中“最弱”的光滑性条件，允许全局复杂性（如自交）但保留局部可计算性。理解浸入有助于处理实际中的非理想曲面（如扫描重建的噪声模型）。</p> <h4 id="浸入immersion与嵌入embedding的对比">浸入（Immersion）与嵌入（Embedding）的对比</h4> <table> <thead> <tr> <th><strong>特性</strong></th> <th><strong>浸入（Immersion）</strong></th> <th><strong>嵌入（Embedding）</strong></th> </tr> </thead> <tbody> <tr> <td><strong>自交性</strong></td> <td>允许全局自交（如 Klein 瓶在 $ \mathbb{R}^3 $）</td> <td>禁止自交（如球面、环面）</td> </tr> <tr> <td><strong>局部性质</strong></td> <td>每点处微分 $ \mathrm{d}f $ 满秩，切空间二维</td> <td>浸入 + 全局单射（无自交）</td> </tr> <tr> <td><strong>拓扑保持</strong></td> <td>仅局部同胚于平面</td> <td>全局同胚于参数域的拓扑</td> </tr> <tr> <td><strong>物理合理性</strong></td> <td>非物理（自交）</td> <td>物理可实现（无自交）</td> </tr> </tbody> </table> <h3 id="正则同伦regular-homotopy">正则同伦（Regular Homotopy）</h3> <p>正则同伦描述了两个浸入曲面 $ f_0, f_1: U \to \mathbb{R}^3 $ 之间通过一系列“良好形变”相互转化的过程。具体表现为：</p> <p>存在连续映射 $ h: U \times [0,1] \to \mathbb{R}^3 $，使得：</p> <ol> <li><strong>边界条件</strong>：$ h(x,0) = f_0(x) $，$ h(x,1) = f_1(x) $；</li> <li><strong>浸入保持</strong>：对任意固定 $ t \in [0,1] $，映射 $ h(\cdot, t) $ 仍是浸入（即微分 $ d h_t $ 处处满秩）。</li> </ol> <p><strong>几何意义</strong>：形变过程中不允许曲面出现“捏缩”（pinches）、“尖锐褶皱”（sharp creases）或“停顿”（stops），始终保持局部光滑性。</p> <h3 id="圆与球面的外翻circle-eversion-vs-sphere-eversion">圆与球面的外翻（Circle Eversion vs. Sphere Eversion）</h3> <ul> <li>平面闭合曲线的<strong>正则同伦类</strong>由其<strong>环绕数（Turning Number）</strong> $ k $ 决定。</li> <li><strong>环绕数</strong>：单位切向量绕原点的旋转次数（逆时针为 $ +1 $，顺时针为 $ -1 $）。</li> <li><strong>结论</strong>： <ul> <li>标准圆 $ k=+1 $ 无法通过浸入形变（正则同伦）变为 $ k=-1 $ 的“内翻圆”。</li> <li>二维平面上不允许曲线自交时穿过自身（需第三维空间）。</li> </ul> </li> </ul> <p><strong>反直觉的突破</strong></p> <ul> <li>在三维空间中，球面可通过<strong>自交浸入</strong>实现外翻（Inside-Out），且过程中始终保持光滑（正则同伦）。</li> <li><strong>关键区别</strong>：三维空间提供了额外的自由度，允许自交曲线动态移动并最终消除。</li> </ul> <ol> <li><strong>历史与人物</strong> <ul> <li><strong>Bernhard Morin（1976）</strong>：首位给出具体外翻方法的数学家（虽本人失明，但通过触觉想象完成）。</li> <li><em>Outside In</em>（1994）：几何中心制作的经典动画，直观展示外翻过程。</li> <li><strong>Optiverse</strong>：Francis、Kusner、Sullivan 提出的“最优”外翻路径（能量最小化）。</li> </ul> </li> <li><strong>外翻步骤（直观描述）</strong> <ul> <li><strong>阶段1</strong>：引入“凹陷”使球面自交为环形。</li> <li><strong>阶段2</strong>：逐步推动自交环向两极移动并消失。</li> <li><strong>结果</strong>：初始外表面最终变为内表面。</li> </ul> </li> </ol> <blockquote> <p><em>“我们的空间想象源于手的操作…而非视觉。”</em><br/> ——Bernhard Morin（以触觉“看见”几何的盲人数学家）</p> </blockquote> <p>从圆的不可外翻到球面的可外翻，揭示了维度对几何形变的深刻影响。这一现象不仅是微分拓扑的经典课题，也是连接数学理论与可视化技术的桥梁。</p> <h3 id="黎曼度量riemannian-metric">黎曼度量（Riemannian Metric）</h3> <p>黎曼度量 $ g $ 是光滑流形（如曲线、曲面）上的一种结构，用于测量<strong>切向量的长度</strong>和<strong>夹角</strong>。具体表现为：</p> <ul> <li> <p>对每一点 $ p $ 的切空间 $ T_p M $，$ g $ 给出一个正定对称双线性形式：</p> \[g_p: T_p M \times T_p M \to \mathbb{R}, \quad (X, Y) \mapsto g_p(X, Y).\] </li> </ul> <p>黎曼度量 $ g $ 不同于距离函数 $ d(x, y) $，后者是全局的测地线长度。</p> <ol> <li><strong>长度与角度</strong>： <ul> <li>向量 $ X $ 的长度：$ |X| = \sqrt{g(X, X)} $。</li> <li>两向量 $ X, Y $ 的夹角：$ \theta = \arccos\left( \frac{g(X, Y)}{|X| |Y|} \right) $。</li> </ul> </li> <li><strong>局部几何</strong>：$ g $ 决定了曲面的<strong>第一基本形式</strong>（如曲率、测地线）。</li> </ol> <h3 id="浸入诱导的度量metric-induced-by-an-immersion">浸入诱导的度量（Metric Induced by an Immersion）</h3> <p>对于浸入（immersion）$ f: U \to \mathbb{R}^n $，如何正确测量其参数域 $ U \subset \mathbb{R}^2 $ 上切向量 $ X, Y $ 的内积？</p> <ul> <li><strong>错误做法</strong>：直接使用参数域 $ U $ 的欧氏内积 $ \langle X, Y \rangle_{\mathbb{R}^2} $。</li> <li><strong>原因</strong>：参数域的平面内积无法反映曲面在空间中的实际几何（如拉伸或弯曲）。</li> </ul> <p><strong>正确方法：诱导度量（Induced Metric）</strong></p> <p>定义曲面上的内积为推前切向量的欧氏内积：</p> \[g(X, Y) := \langle \mathrm{d}f(X), \mathrm{d}f(Y) \rangle_{\mathbb{R}^n},\] <p>其中 $ \mathrm{d}f $ 是微分（雅可比矩阵），将参数域的向量 $ X $ 映射到曲面的切空间。</p> <h3 id="诱导度量induced-metric的矩阵表示与计算">诱导度量（Induced Metric）的矩阵表示与计算</h3> <p>诱导度量 $ g $ 可以表示为一个对称正定的 $ 2 \times 2 $ 矩阵 $ \mathbf{I} $，称为<strong>第一基本形式</strong>。其定义如下：</p> <p>$ g(X, Y) = X^\top \mathbf{I} Y, $</p> <p>其中：</p> <ul> <li>$ X, Y $ 是参数域 $ U \subset \mathbb{R}^2 $ 上的切向量。</li> <li> <p>矩阵 $ \mathbf{I} $ 的分量为：</p> \[I_{ij} = g\left( \frac{\partial}{\partial x^i}, \frac{\partial}{\partial x^j} \right) = \left\langle \mathrm{d}f\left( \frac{\partial}{\partial x^i} \right), \mathrm{d}f\left( \frac{\partial}{\partial x^j} \right) \right\rangle.\] </li> </ul> <p><strong>关键点</strong>：</p> <ul> <li>$ \mathbf{I} $ 通过曲面的微分 $ \mathrm{d}f $ 定义，编码了参数化导致的拉伸和扭曲。</li> <li> <p>矩阵 $ \mathbf{I} $ 也可以由雅可比矩阵 $ J_f $ 计算：</p> \[\mathbf{I} = J_f^\top J_f.\] </li> </ul> <h4 id="saddle-示例">Saddle 示例</h4> <p><strong>参数化曲面</strong>：</p> \[f(u, v) = (u, v, u^2 - v^2), \quad (u, v) \in U \subset \mathbb{R}^2.\] <p><strong>步骤1：计算微分 $ \mathrm{d}f $ 和雅可比矩阵 $ J_f $</strong></p> <ul> <li> <p>切向量的偏导数：</p> \[\frac{\partial f}{\partial u} = (1, 0, 2u), \quad \frac{\partial f}{\partial v} = (0, 1, -2v).\] </li> <li> <p>雅可比矩阵：</p> \[J_f = \begin{bmatrix} 1 &amp; 0 \\ 0 &amp; 1 \\ 2u &amp; -2v \end{bmatrix}.\] </li> </ul> <p><strong>步骤2：计算第一基本形式 $ \mathbf{I} = J_f^\top J_f $</strong></p> \[\mathbf{I} = \begin{bmatrix} 1 &amp; 0 &amp; 2u \\ 0 &amp; 1 &amp; -2v \end{bmatrix} \begin{bmatrix} 1 &amp; 0 \\ 0 &amp; 1 \\ 2u &amp; -2v \end{bmatrix} = \begin{bmatrix} 1 + 4u^2 &amp; -4uv \\ -4uv &amp; 1 + 4v^2 \end{bmatrix}.\] <p><strong>分量解释</strong>：</p> <ul> <li>$ E = 1 + 4u^2 $：$ u $-方向的拉伸系数（含 $ 2u $ 的扭曲项）。</li> <li>$ F = -4uv $：$ u $ 和 $ v $-方向的耦合项（反映曲面的非正交性）。</li> <li>$ G = 1 + 4v^2 $：$ v $-方向的拉伸系数。</li> </ul> <h5 id="3-几何意义"><strong>3. 几何意义</strong></h5> <ul> <li> <p><strong>长度计算</strong>：向量 $ X = (a, b)^\top $ 的长度为：</p> \[\|X\| = \sqrt{g(X, X)} = \sqrt{a^2 (1 + 4u^2) + 2ab (-4uv) + b^2 (1 + 4v^2)}.\] </li> <li> <p><strong>角度计算</strong>：两向量 $ X, Y $ 的夹角 $ \theta $ 满足：</p> \[\cos \theta = \frac{g(X, Y)}{\|X\| \|Y\|} = \frac{X^\top \mathbf{I} Y}{\sqrt{X^\top \mathbf{I} X \cdot Y^\top \mathbf{I} Y}}.\] </li> </ul> <p>在点 $ (u, v) = (1, 0) $ 处，度量矩阵为：</p> \[\mathbf{I} = \begin{bmatrix} 5 &amp; 0 \\ 0 &amp; 1 \end{bmatrix}.\] <ul> <li>向量 $ X = (1, 0)^\top $ 的长度为 $ \sqrt{5} $，而 $ Y = (0, 1)^\top $ 的长度为 $ 1 $。</li> <li>此时 $ g(X, Y) = 0 $，说明 $ X $ 和 $ Y $ 在该点正交。</li> </ul> <p>诱导度量 ( \mathbf{I} ) 将曲面的内在几何从嵌入空间“拉回”到参数域，是计算长度、角度、曲率的基础。</p> <h3 id="共形坐标conformal-coordinates">共形坐标（Conformal Coordinates）</h3> <p>一个参数化 $ f: U \subset \mathbb{R}^2 \to \mathbb{R}^3 $ 是<strong>共形的</strong>（conformal），如果其诱导的黎曼度量 $ \mathbf{I} $ 满足：</p> \[\mathbf{I} = \lambda(u,v) \begin{bmatrix} 1 &amp; 0 \\ 0 &amp; 1 \end{bmatrix}, \quad \lambda(u,v) &gt; 0.\] <ul> <li><strong>几何意义</strong>：曲面的度量是参数域平面度量的<strong>标量倍</strong>，仅通过一个函数 $ \lambda(u,v) $ 缩放。</li> <li><strong>核心性质</strong>： <ul> <li><strong>保角性</strong>：曲面上任意两向量的夹角与其在参数域中的夹角相同。</li> <li><strong>长度非均匀缩放</strong>：长度在参数域和曲面之间按比例 $ \sqrt{\lambda(u,v)} $ 变化。</li> </ul> </li> </ul> <h4 id="共形参数化的重要性">共形参数化的重要性</h4> <ol> <li><strong>简化计算</strong>： <ul> <li>度量矩阵仅含一个自由度（$ \lambda $），而非三个（$ E, F, G $），极大简化曲率、测地线等计算。</li> </ul> </li> <li><strong>几何不变性</strong>： <ul> <li>保角性使局部形状（如角度）不受参数化扭曲影响，适用于纹理映射、曲面重建。</li> </ul> </li> <li><strong>理论普适性</strong>： <ul> <li>任何光滑曲面均存在共形参数化（Uniformization Theorem），而等距参数化通常不存在。</li> </ul> </li> </ol> <hr/> <h4 id="3-共形-vs-等距参数化"><strong>3. 共形 vs. 等距参数化</strong></h4> <p>| <strong>特性</strong> | <strong>共形参数化</strong> | <strong>等距参数化</strong> | |——————-|———————————–|———————————–| | <strong>度量形式</strong> | $ \mathbf{I} = \lambda(u,v) \mathbb{I}_2 $ | $ \mathbf{I} = \mathbb{I}_2 $（理想情况） | | <strong>长度保持</strong> | 非均匀缩放 | 完全保持 | | <strong>角度保持</strong> | 是 | 是 | | <strong>存在性</strong> | 总存在（如球面、环面） | 仅限可展曲面（平面、圆柱） |</p> <h4 id="恩内佩尔曲面enneper-surface示例">恩内佩尔曲面（Enneper Surface）示例</h4> <p>恩内佩尔曲面是一个经典的<strong>极小曲面</strong>（Minimal Surface），其参数化方程为：</p> \[f(u,v) = \begin{bmatrix} uv^2 + u - \frac{1}{3}u^3 \\ \frac{1}{3}v(v^2 - 3u^2 - 3) \\ u^2 - v^2 \end{bmatrix}\] <ul> <li><strong>几何特性</strong>：具有自交性质，对称且无限延伸，是数学上研究共形度量的理想例子。</li> </ul> <p><strong>雅可比矩阵 $ J_f $</strong>（切向量的矩阵表示）：</p> \[J_f = \begin{bmatrix} \frac{\partial f_1}{\partial u} &amp; \frac{\partial f_1}{\partial v} \\ \frac{\partial f_2}{\partial u} &amp; \frac{\partial f_2}{\partial v} \\ \frac{\partial f_3}{\partial u} &amp; \frac{\partial f_3}{\partial v} \end{bmatrix} = \begin{bmatrix} -u^2 + v^2 + 1 &amp; 2uv \\ -2uv &amp; -u^2 + v^2 - 1 \\ 2u &amp; -2v \end{bmatrix}\] <p><strong>诱导度量 $ \mathbf{I} = J_f^\top J_f $</strong>：</p> \[\mathbf{I} = \begin{bmatrix} 1 + 4u^2 + (u^2 - v^2 - 1)^2 &amp; -4uv \\ -4uv &amp; 1 + 4v^2 + (u^2 - v^2 + 1)^2 \end{bmatrix}\] <p>经过化简后，神奇地简化为：</p> \[\mathbf{I} = (u^2 + v^2 + 1)^2 \begin{bmatrix} 1 &amp; 0 \\ 0 &amp; 1 \end{bmatrix}.\] <p>恩内佩尔曲面通过其简洁的共形度量，展示了极小曲面与复分析之间的深刻联系。其度量形式 $ \mathbf{I} = \lambda(u,v) \mathbb{I}_2 $ 是理论与应用中的黄金标准，为曲面参数化提供了最优的局部几何描述。</p> <h3 id="抽象黎曼度量abstract-riemannian-metric">抽象黎曼度量（Abstract Riemannian Metric）</h3> <p>黎曼度量是流形上<strong>逐点光滑变化的内积</strong> $ g_p $，赋予切空间 $ T_p M $ 长度和角度的测量能力。其核心在于：</p> <ol> <li><strong>内蕴性</strong>：无需依赖嵌入空间，仅通过 $ g_p(X,Y) $ 即可定义几何量（如曲率、测地线）。</li> <li><strong>灵活性</strong>：任意指定对称正定双线性形式 $ g_{ij} $ 均可构造合法度量（如双曲平面 $ \delta_p $）。</li> <li><strong>普适公式</strong>：长度 $ |X| = \sqrt{g(X,X)} $，夹角 $ \cos\theta = \frac{g(X,Y)}{|X||Y|} $。</li> </ol> <p>黎曼度量是“弯曲空间的尺规”，完全由局部内积决定全局几何。</p> <h4 id="例子单位圆盘的双曲度量">例子：单位圆盘的双曲度量</h4> <table> <tbody> <tr> <td>在单位圆盘 $ U = { p \in \mathbb{R}^2 \mid</td> <td>p</td> <td>&lt; 1 } $ 上定义双曲度量：</td> </tr> </tbody> </table> \[g_p(X, Y) = \frac{4}{(1 - |p|^2)^2} \langle X, Y \rangle_{\mathbb{R}^2},\] <p>其中 $ \langle \cdot, \cdot \rangle_{\mathbb{R}^2} $ 是欧氏内积。</p> <ol> <li> <p><strong>局部长度膨胀</strong></p> <p>在点 $ p = (0.5, 0) $ 处，取向量 $ X = (1, 0) $：</p> \[|X|_{g} = \sqrt{g_p(X, X)} = \frac{2}{1 - 0.5^2} \cdot 1 = \frac{8}{3}.\] <table> <tbody> <tr> <td><strong>结论</strong>：相同欧氏长度的向量在 $ p $ 点处双曲长度更大，且仅依赖 $ p $ 的局部坐标 $</td> <td>p</td> <td>$。</td> </tr> </tbody> </table> </li> <li> <p><strong>角度不变性（保角性）</strong><br/> 对任意两向量 $ X, Y $，夹角：</p> \[\theta = \arccos \left( \frac{g_p(X, Y)}{|X|_g |Y|_g} \right) = \arccos \left( \frac{\langle X, Y \rangle}{\|X\| \|Y\|} \right).\] <table> <tbody> <tr> <td><strong>结论</strong>：双曲度量与欧氏角度相同，仅通过 $ g_p $ 的标量因子 $ \lambda(p) = \frac{4}{(1-</td> <td>p</td> <td>^2)^2} $ 即可确定，无需全局信息。</td> </tr> </tbody> </table> </li> <li> <p><strong>面积</strong><br/> 对参数域 $ D \subset U $，面积为：</p> \[\text{Area}(D) = \iint_D \sqrt{\det(g_p)} \, du \, dv = \iint_D \frac{4}{(1 - u^2 - v^2)^2} \, du \, dv.\] <p><strong>结论</strong>：当 $ R \to 1 $，面积 $ \to +\infty $，与长度共同反映双曲空间的“膨胀”性质。</p> </li> <li> <p><strong>长度</strong><br/> 在双曲度量 $ g_p $ 下，曲线 $ \gamma: [a,b] \to U $ 的长度为：</p> \[\text{Length}(\gamma) = \int_a^b \sqrt{g_{\gamma(t)}(\gamma'(t), \gamma'(t))} \, dt = \int_a^b \frac{2 \|\gamma'(t)\|_{\mathbb{R}^2}}{1 - |\gamma(t)|^2} \, dt.\] <p><strong>结论</strong>：当 $ r \to 1 $，长度 $ \to +\infty $，体现双曲几何的“无限延伸”特性。</p> </li> </ol> <p>双曲度量 $ g_p $ 展示了如何仅通过局部内积定义弯曲空间的完整几何，无需全局嵌入。这是内蕴几何的核心思想——<strong>几何即局部测量的规则</strong>。</p> <h3 id="嵌入定理embedding-theorems">嵌入定理（Embedding Theorems）</h3> <ol> <li> <p><strong>核心问题</strong><br/> 给定黎曼度量 $ g $，能否找到嵌入映射 $ f $ 使得 $ g(X,Y) = \langle \mathrm{d}f(X), \mathrm{d}f(Y) \rangle $？即：能否将抽象流形等距嵌入欧氏空间？</p> </li> <li><strong>Hilbert定理（负结果）</strong> <ul> <li><strong>双曲空间</strong>：无法将常负曲率（如双曲平面）光滑嵌入 $ \mathbb{R}^3 $。</li> <li><strong>限制</strong>：某些内蕴几何需更高维空间实现。</li> </ul> </li> <li><strong>Nash嵌入定理（正结果）</strong> <ul> <li><strong>存在性</strong>：任何 $ n $-维黎曼流形均可全局嵌入 $ \mathbb{R}^N $（$ N $ 足够大，如 $ N = \frac{n(n+1)(3n+11)}{2} $）。</li> <li><strong>低维优化</strong>：若允许 $ C^1 $ 光滑性，可嵌入 $ \mathbb{R}^{n+1} $；若初始嵌入“不拉伸距离”（short），则存在保距嵌入。</li> </ul> </li> </ol> <h3 id="atlas--charts">Atlas &amp; Charts</h3> <p>复杂曲面通常无法用单一参数化表示，需通过<strong>重叠的局部坐标卡</strong>（charts）覆盖，构成<strong>图册</strong>（atlas）。每个坐标卡 $ \phi_i: U_i \subset \mathbb{R}^2 \to \mathbb{R}^3 $ 提供曲面的局部参数化。</p> <ol> <li><strong>度量的局部一致性</strong> <ul> <li>每个坐标卡 $ \phi_i $ 诱导局部黎曼度量 $ g_i(X,Y) = \langle d\phi_i(X), d\phi_i(Y) \rangle $。</li> <li> <p><strong>关键条件</strong>：在坐标卡重叠区域 $ U_i \cap U_j $，度量需满足相容性：</p> \[g_j(d\phi_{ij}(X), d\phi_{ij}(Y)) = g_i(X,Y), \quad \phi_{ij} = \phi_j^{-1} \circ \phi_i.\] <p>这确保几何量（如长度、曲率）与坐标选择无关。</p> </li> </ul> </li> <li><strong>几何意义</strong> <ul> <li><strong>局部简化</strong>：将复杂曲面拆分为可计算的“碎片”（如球面需至少两片坐标卡）。</li> <li><strong>全局一致性</strong>：通过转移映射 $ \phi_{ij} $ 和度量相容性，拼合出整体几何。</li> </ul> </li> </ol> <h3 id="抽象黎曼流形abstract-riemannian-manifold">抽象黎曼流形（Abstract Riemannian Manifold）</h3> <p>无需依赖流形在欧氏空间中的具体嵌入，仅通过<strong>局部坐标卡</strong>（charts）和<strong>相容的黎曼度量</strong> $ g_i $ 即可定义几何结构。</p> <ul> <li><strong>组成要素</strong>： <ul> <li>开集覆盖 $ {U_i} $ 和转移映射 $ \phi_{ij} $。</li> <li>每片 $ U_i $ 上的度量 $ g_i $，且在重叠区域满足 $ g_j(\mathrm{d}\phi_{ij}(X), \mathrm{d}\phi_{ij}(Y)) = g_i(X,Y) $。</li> </ul> </li> </ul> <ol> <li><strong>核心定理</strong> <ul> <li><strong>几何量的内蕴性</strong>：长度、角度、曲率等均可通过局部度量 $ g_i $ 计算，与坐标选择无关。</li> <li><strong>脱离嵌入的自由</strong>：允许定义无法低维嵌入的流形（如双曲平面、高维时空）。</li> </ul> </li> <li><strong>意义与应用</strong> <ul> <li><strong>数学</strong>：统一处理弯曲空间，如广义相对论的时空流形。</li> <li><strong>计算</strong>：离散几何中通过局部边长和夹角定义流形（如三角网格）。</li> </ul> </li> </ol> <p>Charts是“地图”，抽象黎曼流形是“带比例尺的地图集”</p> <h2 id="总结">总结</h2> <p><strong>两种几何描述的对比</strong></p> <table> <thead> <tr> <th><strong>描述方式</strong></th> <th><strong>外在（Extrinsic）参数化</strong></th> <th><strong>内蕴（Intrinsic）黎曼度量</strong></th> </tr> </thead> <tbody> <tr> <td><strong>核心思想</strong></td> <td>将曲面表示为映射 $ f: U \to \mathbb{R}^n $ 的像，依赖外部空间坐标。</td> <td>通过切空间上的内积 $ g(X,Y) $ 定义几何，完全脱离嵌入空间。</td> </tr> <tr> <td><strong>优点</strong></td> <td>直观描述曲面形状（如顶点位置、法向量）。</td> <td>独立于参数化，直接反映曲面的内在性质（如曲率、测地线）。</td> </tr> <tr> <td><strong>局限性</strong></td> <td>依赖嵌入空间，无法描述抽象流形（如无法嵌入的拓扑空间）。</td> <td>缺乏直观的空间位置信息，需通过计算提取几何特征。</td> </tr> <tr> <td><strong>关键工具</strong></td> <td>微分 $ \mathrm{d}f $、法向量 $ N = \partial_u f \times \partial_v f $。</td> <td>第一基本形式 $ \mathbf{I} = J_f^\top J_f $、高斯曲率 $ K $。</td> </tr> <tr> <td><strong>应用场景</strong></td> <td>计算机图形学（网格建模）、物理模拟（流体表面）。</td> <td>广义相对论（时空流形）、离散微分几何（仅知边长和夹角时的曲面重建）。</td> </tr> </tbody> </table> <p>外在参数化与内蕴度量是研究光滑曲面的“一体两面”，前者提供直观形状，后者揭示本质几何。理解二者的转换与互补，是微分几何及其应用（如离散曲面处理）的核心基础。</p>]]></content><author><name></name></author><category term="DDG"/><category term="Geometry"/><summary type="html"><![CDATA[光滑曲面]]></summary></entry><entry><title type="html">DDG Smooth Curves</title><link href="https://pasu.github.io/blog/2025/Smooth_Curve/" rel="alternate" type="text/html" title="DDG Smooth Curves"/><published>2025-06-09T10:27:00+00:00</published><updated>2025-06-09T10:27:00+00:00</updated><id>https://pasu.github.io/blog/2025/Smooth_Curve</id><content type="html" xml:base="https://pasu.github.io/blog/2025/Smooth_Curve/"><![CDATA[<h2 id="曲线与表面">曲线与表面</h2> <h3 id="生活中的几何">生活中的几何</h3> <p>我们日常接触的绝大多数几何对象，无论是自然界还是人造物，都可以用<strong>曲线</strong>和<strong>曲面</strong>来描述。比如行星的运行轨道和心电图都是曲线的形式，而飞机机翼，人脸建模则是曲面。即便是<strong>实体的边界</strong>，比如三维物体（如球体），其本质也是由曲面（边界）定义的。因此，曲线和曲面是连接数学与现实的桥梁。</p> <p>微分几何则主要研究<strong>n维流形</strong>，通常聚焦于低维： <strong>曲线（n=1）</strong>、<strong>曲面（n=2）</strong>、<strong>体积（n=3）</strong>。主要原因如下：</p> <ul> <li>应用广泛：从机器人路径规划到计算机图形学。</li> <li>低维并非简单，也可能极其深刻： <ul> <li><strong>n=1</strong>：纽结识别（2022年才解决！）。</li> <li><strong>n=2</strong>：Willmore猜想（2012年证得部分结果）。</li> <li><strong>n=3</strong>：几何化猜想（2003年佩雷尔曼证明，价值百万美元）。</li> </ul> </li> <li>高维未必复杂，机器学习中的高维数据反而可能缺乏几何深度（如对称性、曲率流等）。</li> </ul> <blockquote> <p><strong>反直觉</strong>：低维流形是数学的“实验室”，蕴藏最丰富的结构与未解之谜。</p> </blockquote> <p>描述几何的多种“方言”：</p> <ul> <li><strong>局部参数化</strong>（如圆弧 $(\cos\theta, \sin\theta)$）。</li> <li><strong>微分形式</strong>（坐标无关，适合全局分析）。</li> <li><strong>活动标架</strong>（Frenet标架用于曲线，曲面上的标架场）。</li> <li><strong>隐式方程</strong>（如 $x^2 + y^2 = 1$ 定义圆）。</li> </ul> <p>同样，复杂问题下不必拘泥于一种方法，就如同一个人掌握多种语言的必要性一般。</p> <h3 id="离散描述"><strong>离散描述</strong></h3> <p>数值计算需要离散化：<br/> | <strong>方法</strong> | <strong>优点</strong> | <strong>缺点</strong> |<br/> |—————-|—————————–|—————————–|<br/> | <strong>隐式</strong>（如水平集） | 拓扑变化灵活（如分裂、合并） | 存储成本高、自适应困难 |<br/> | <strong>显式</strong>（如网格） | 计算高效、工具成熟 | 拓扑修改复杂 |</p> <p>就如同DDG课程所讲，本课程的目标就是在<strong>光滑理论</strong>上，通过微分形式揭示几何本，而在<strong>离散逼近</strong>上，用网格和离散微分形式实现算法，从而实现在理论（纸上推导）与计算（代码实现）间的自由切换。</p> <p>比如在汽车设计中，设计汽车曲面（光滑）-&gt;生成有限元网格（离散）-&gt; 模拟碰撞（算法）。</p> <h2 id="平面曲线">平面曲线</h2> <h3 id="隐式描述">隐式描述</h3> <p><strong>定义</strong>：通过函数$\phi(x,y)=0$定义的平面点集</p> <ul> <li><strong>典型示例</strong>：单位圆的方程$x^2+y^2-1=0$</li> <li><strong>优势</strong>： <ul> <li>表示简洁，一个方程描述完整曲线</li> <li>容易判断点是否在曲线上（代入验证）</li> </ul> </li> <li><strong>局限</strong>： <ul> <li>自交点处理困难（如双纽线）</li> <li>难以直接获取几何属性（如切线方向）</li> </ul> </li> </ul> <blockquote> <p>数学内涵：体现了曲线的全局性质，是代数几何的研究对象。</p> </blockquote> <h3 id="参数化描述">参数化描述</h3> <p><strong>定义</strong>：通过$\gamma:[a,b] \rightarrow \mathbb{R}^2$的映射给出</p> <ul> <li><strong>经典示例</strong>：圆的参数方程$\gamma (\theta) = (\cos \theta, \sin \theta)$</li> <li><strong>显著优势</strong>： <ul> <li>明确处理自交（浸入vs.嵌入）</li> <li>自然包含运动信息（$\gamma^\prime (t)$表示速度）</li> <li>适合物理建模（如粒子轨迹）</li> </ul> </li> </ul> <blockquote> <p>关键特征：参数化本质上是将一维区间”拉伸扭曲”到平面。</p> </blockquote> <p>参数化曲线自然地导出离散表示：用顶点序列${v_0,v_1,…,v_n}$逼近。</p> <table> <thead> <tr> <th>特征</th> <th>隐式描述</th> <th>参数化描述</th> </tr> </thead> <tbody> <tr> <td>自交处理</td> <td>困难</td> <td>明确</td> </tr> <tr> <td>几何计算</td> <td>需隐函数求导</td> <td>直接微分</td> </tr> <tr> <td>运动描述</td> <td>不自然</td> <td>包含速度信息</td> </tr> <tr> <td>离散化难度</td> <td>复杂（如体素化）</td> <td>简单（取采样点）</td> </tr> </tbody> </table> <p>一个<strong>平面参数化曲线</strong>是指从实数区间到平面的映射：</p> \[\gamma: [0,L] \to \mathbb{R}^2\] <p>其中：</p> <ul> <li>定义域 $[0,L]$ 是实直线上的闭区间（参数空间）</li> <li>值域 $\gamma([0,L])$ 是平面上的点集（轨迹）</li> </ul> <h3 id="曲线微分">曲线微分</h3> <p>参数化曲线 $\gamma: [0,L] \to \mathbb{R}^2$ 的微分 $ \mathrm{d} \gamma$ 是将参数空间的切向量映射到平面切向量的线性变换：</p> \[\mathrm{d} \gamma: T_s[0,L] \to T_{\gamma(s)}\mathbb{R}^2\] <h3 id="曲线切向量">曲线切向量</h3> <p>切向量是曲线在某点的”最佳逼近直线”的方向向量:</p> <p>对于 $ C^1 $ 类正则曲线 $\gamma: I \to \mathbb{R}^n $：</p> \[T(t) = \frac{\mathrm{d}\gamma/\mathrm{d}t}{\|\mathrm{d}\gamma/\mathrm{d}t\|} \in S^{n-1}\] <p>其中正则性条件 $|d\gamma/dt| \neq 0$ 确保定义良好。</p> <ul> <li><strong>微分</strong> 如同”橡皮筋拉伸规则”： <ul> <li>参数空间是松弛的橡皮筋，$\mathrm{d}\gamma$ 描述它被拉伸到曲线时的变形方式。</li> </ul> </li> <li><strong>切向量</strong> 如同”指南针方向”： <ul> <li>在曲线每点标出一个箭头，指向曲线前进方向（长度固定为1）。</li> </ul> </li> </ul> <h3 id="曲线的重新参数化">曲线的重新参数化</h3> <p>给定一条参数化曲线 $\gamma: [a,b] \to \mathbb{R}^n$ 和一个双射映射 $\eta: [c,d] \to [a,b]$，我们可以构造<strong>重新参数化的曲线</strong>：</p> \[\tilde{\gamma}(t) = \gamma(\eta(t)), \quad t \in [c,d]\] <p><strong>关键性质</strong>：</p> <ul> <li>新曲线 (\tilde{\gamma}) 与原始曲线 (\gamma) <strong>几何形状完全相同</strong></li> <li>仅改变了曲线的<strong>遍历方式</strong>（速度、参数间隔等）</li> </ul> <p>微分 $\mathrm{d}\tilde{\gamma}$ 揭示了参数变换导致的向量伸缩：</p> \[\mathrm{d}\tilde{\gamma} = \mathrm{d}\gamma \circ d\eta\] <p>一条参数化曲线 $\gamma: [a,b] \to \mathbb{R}^n$ 是<strong>正则的</strong>，其微分（速度向量）处处非零：</p> \[\gamma'(t) \neq 0, \quad \forall t \in [a,b]\] <h4 id="几何解释">几何解释</h4> <ul> <li><strong>“永不停滞”</strong>：曲线在任意点都有明确的前进方向</li> <li><strong>切空间良定义</strong>：每点存在一维切空间 $T_{\gamma(t)}\mathcal{C}$</li> <li><strong>排除奇点</strong>：如尖点（cusp）、回溯点等病理情况</li> </ul> <h3 id="非正则曲线示例">非正则曲线示例</h3> <p>同样，一个非正则曲线则表明其曲线微分在至少某一点上为零。如果举一个例子。</p> <ul> <li> <p><strong>原始曲线</strong>：</p> \[\gamma(s) = \begin{cases} (s, s) &amp; s \leq 0 \\ (s, -s) &amp; s &gt; 0 \end{cases}\] </li> <li> <p><strong>重新参数化</strong>：取$\eta(s) = s^3$，得到：</p> \[\tilde{\gamma}(s) = \gamma(s^3) = \begin{cases} (s^3, s^3) &amp; s \leq 0 \\ (s^3, -s^3) &amp; s &gt; 0 \end{cases}\] </li> </ul> <h4 id="微分分析"><strong>微分分析</strong></h4> <p>计算一阶导数：</p> \[\tilde{\gamma}'(s) = \begin{cases} (3s^2, 3s^2) &amp; s &lt; 0 \\ (0, 0) &amp; s = 0 \\ (3s^2, -3s^2) &amp; s &gt; 0 \end{cases}\] <ul> <li><strong>连续性</strong>：$\lim_{s\to 0^-} \tilde{\gamma}’(s) = \lim_{s\to 0^+} \tilde{\gamma}’(s) = (0,0)$</li> <li><strong>正则性破坏点</strong>：在$s=0$处$\tilde{\gamma}’(0) = 0$</li> </ul> <h3 id="嵌入曲线embedded-curve">嵌入曲线（Embedded Curve）</h3> <h4 id="直观理解">直观理解</h4> <p>嵌入曲线是<strong>不自交</strong>的曲线，满足：</p> <ul> <li>没有交叉点（如数字”8”不是嵌入曲线）</li> <li>没有端点重合（如闭合环除外）</li> <li>在平面上看起来是”一根连续不断的线”</li> </ul> <h4 id="数学定义">数学定义</h4> <p>对于参数化曲线 $\gamma: [a,b] \to \mathbb{R}^n$，它是<strong>嵌入的</strong>当且仅当：</p> <ol> <li><strong>连续单射</strong>：$\gamma$ 是连续且一一映射的</li> <li><strong>逆映射连续</strong>：$\gamma^{-1}: \gamma([a,b]) \to [a,b]$ 也是连续的（即同胚嵌入）</li> </ol> <h4 id="反例">反例</h4> <ul> <li> <p><strong>构造方式</strong>：</p> \[\gamma: [0,1) \to S^1, \quad t \mapsto (\cos 2\pi t, \sin 2\pi t)\] </li> <li> <p><strong>性质分析</strong>：</p> <ul> <li><strong>连续单射</strong>：每个$t$对应圆上唯一点，且连续</li> <li><strong>非嵌入</strong>：当$t \to 1^-$时，$\gamma(t)$趋近于$(1,0)$，但$\gamma^{-1}$在$(1,0)$处不连续（无法连续”解开”圆）</li> </ul> </li> </ul> <p><strong>几何表现</strong>：</p> <ul> <li>图像是一个<strong>缺了一个点的圆</strong>（极限点未闭合）</li> <li>若强行闭合（令$\gamma(1)=(1,0)$），则失去单射性</li> </ul> <h3 id="单位法向量">单位法向量</h3> <p>法向量是垂直于切向量的单位向量，满足：</p> <ul> <li><strong>“竖直外伸”</strong>：在平面曲线的每点指向曲率中心方向</li> <li><strong>正交性</strong>：始终与切向量 $ T(s) $ 满足 $ T \cdot N = 0 $</li> <li><strong>定向规则</strong>：通常取逆时针旋转90°（右手系）</li> </ul> <h4 id="数学定义-1">数学定义</h4> <p>对于弧长参数化曲线 $\gamma(s)$，单位法向量定义为：</p> \[N(s) = JT(s)\] <p>其中 $ J $ 是逆时针旋转90°的线性算子：</p> \[J(x,y) = (-y,x)\] <h3 id="曲率">曲率</h3> <p>曲率 $\kappa$ 量化曲线在某点的<strong>弯曲程度</strong>：</p> <ul> <li>$\kappa = 0$：直线（不弯曲）</li> <li>$\kappa$ 越大：弯曲越剧烈</li> <li>符号：表示弯曲方向（逆时针为正，顺时针为负）</li> </ul> <p>对于弧长参数化曲线 $\gamma(s)$，曲率为单位切向量 $T(s)$ 的变化率：</p> \[\kappa(s) = \left\| \frac{dT}{ds} \right\| = \| T'(s) \|\] <p>若用法向量 $N(s)$ 表示：</p> \[\kappa(s) = \langle N(s), T'(s) \rangle\] <h4 id="密切圆osculating-circle">密切圆（Osculating Circle）</h4> <p>过曲线上点 $p$ 及左右邻近两点，当邻近点无限接近 $p$ 时，这三个点确定的圆的极限位置即为<strong>密切圆</strong>。</p> <ul> <li> <p><strong>曲率半径</strong>：密切圆半径 $r$ 与曲率的关系：</p> \[\kappa(p) = \frac{1}{r(p)}\] </li> </ul> <p>（半径越小，曲率越大）</p> <h3 id="曲率决定曲线">曲率决定曲线</h3> <p>对于弧长参数化的平面曲线 $\gamma(s)$，在<strong>刚体运动（平移+旋转）意义下</strong>：</p> <ul> <li><strong>唯一性</strong>：曲线的形状完全由曲率函数 $\kappa(s)$ 决定</li> <li><strong>存在性</strong>：任意给定的连续函数 $\kappa(s)$ 对应一条平面曲线</li> </ul> <h4 id="几何直观">几何直观</h4> <p><strong>方向盘比喻</strong>：</p> <ul> <li>曲率 $\kappa(s)$ 如同方向盘转角</li> <li>以单位速度行驶时，$\kappa(s)$ 决定行驶方向的变化率</li> </ul> <h3 id="从曲率函数重建平面曲线">从曲率函数重建平面曲线</h3> <p>根据<strong>平面曲线基本定理</strong>，给定曲率函数 $\kappa(s)$ 和初始条件，可通过三步重建曲线：</p> <ol> <li> <p><strong>积分曲率得角度</strong>：</p> \[\theta(s) = \int_0^s \kappa(t) dt + \theta_0\] <p>（$\theta_0$ 为初始切向角度）</p> </li> <li> <p><strong>构造切向量</strong>：</p> \[T(s) = (\cos\theta(s), \sin\theta(s))\] </li> <li> <p><strong>积分切向量得曲线</strong>：</p> \[\gamma(s) = \gamma(0) + \int_0^s T(t) dt\] </li> </ol> <h4 id="示例验证常曲率-kappas--1">示例验证：常曲率 $\kappa(s) = 1$</h4> <ol> <li> <p><strong>角度函数</strong>：</p> \[\theta(s) = \int_0^s 1 \, dt = s \quad (\text{设} \theta_0=0)\] </li> <li> <p><strong>切向量</strong>：</p> \[T(s) = (\cos s, \sin s)\] </li> <li> <p><strong>曲线积分</strong>：</p> \[\gamma(s) = \int_0^s (\cos t, \sin t) dt = (\sin s, 1-\cos s)\] <p><strong>结果</strong>：半径为1的圆沿x轴滚动的摆线</p> </li> </ol> <h3 id="转向数turning-number与环绕数winding-number">转向数（Turning Number）与环绕数（Winding Number）</h3> <ul> <li><strong>转向数 $ k $</strong>：<br/> 想象一个小车沿曲线行驶，方向盘总共转了多少圈。 <ul> <li>$ k=+1 $：标准逆时针圆（方向盘逆时针转1圈）</li> <li>$ k=0 $：直线或”8”字形（净转向为零）</li> </ul> </li> <li><strong>环绕数 $ n(p) $</strong>：<br/> 用一根绳子连接点 $ p $ 和曲线，数绳子绕 $ p $ 的净圈数。 <ul> <li>若 $ p $ 在曲线内部，通常 $ n(p) \neq 0 $</li> <li>若 $ p $ 在外部，$ n(p) = 0 $</li> </ul> </li> </ul> <p>切线数是“切线映射”绕原点的环绕数。也就是说，如果我们不是用原始曲线去绕某个点，而是用单位切向量在单位圆上形成的路径去计算环绕数，那得到的数就是切线数。</p> <h3 id="whitneygraustein-定理">Whitney–Graustein 定理</h3> <p>当两条曲线之间可以通过<strong>连续变形</strong>（homotopy）变换，且在整个过程中始终保持“正则”（即处处导数不为零、没有尖点或停顿）时，我们称这两条曲线是<strong>正则同伦</strong>（regularly homotopic）的。</p> <p><strong>Whitney–Graustein 定理</strong>指出：</p> <blockquote> <p><strong>两条平面正则曲线具有相同的切线数（turning number）当且仅当它们是正则同伦的。</strong></p> </blockquote> <p>也就是说，切线数是判断两条曲线能否在不“撕裂”或“折断”的前提下相互变形的<strong>拓扑不变量</strong>。</p> <h4 id="推论">推论：</h4> <blockquote> <p>不可能把一个“正向绕一圈”的圆形变形成“反向绕一圈”的圆形。 换句话说，<strong>无法在保持正则性的前提下把一个圆“翻转过来”</strong>，因为它们的切线数为 $+1$ 和 $-1$，不同。</p> </blockquote> <p>这一定理将“几何上的连续变形”与“拓扑不变量”之间建立了深刻的联系，是理解曲线同伦分类的核心结果之一。</p> <h3 id="应用六面体网格划分hexahedral-meshing">应用：六面体网格划分（Hexahedral Meshing）</h3> <p>在数值模拟中，<strong>六面体网格划分</strong>指的是将一个三维形状划分成许多“小立方体”来进行物理计算或几何处理。</p> <h4 id="定理thurstonmitchell">定理（Thurston–Mitchell）：</h4> <blockquote> <p>一个genus-0的四边形网格，<strong>当且仅当其面数为偶数</strong>时，才能作为某个六面体网格的边界。</p> </blockquote> <h4 id="证明思路概述">证明思路概述：</h4> <ul> <li>在球面上的每一条曲线都可以通过正则同伦变形为一个圆形或“8”字形；</li> <li>将网格的<strong>对偶图（dual graph）</strong>变形成一系列<strong>互不相交的圆和“8”字形</strong>；</li> <li>然后通过“收缩”球面来在这些曲线之间插值，逐渐“扫出”一套新的表面；</li> <li>这些表面正好构成一个六面体网格（可能需要补充一些额外结构以使其闭合）。</li> </ul> <p>该构造方式会生成 $O(n^2)$ 个六面体单元（其中 $n$ 为原始网格规模），但在优化算法下可以做到 $O(n)$ 复杂度。</p> <p>此外，Erickson 的研究表明，该方法还可以推广到<strong>任意亏格</strong>的情形。</p> <p>以下是该段内容关于“广义环绕数（Generalized Winding Numbers）”的中文翻译，适合用于博客文章风格：</p> <hr/> <h3 id="应用广义环绕数generalized-winding-numbers">应用：广义环绕数（Generalized Winding Numbers）</h3> <p><strong>环绕数（winding number）</strong>表示一条<strong>封闭曲线</strong>绕某个给定点“缠绕”的次数——它帮助我们判断某个点是<strong>在曲线内部</strong>还是<strong>外部</strong>。在真实数据中，曲线往往<strong>不是完美封闭</strong>的，比如：</p> <ul> <li>存在测量噪声；</li> <li>曲线存在小的缝隙或不连续。</li> </ul> <p>但即使在这种情况下，我们<strong>仍然希望判断哪些点是在“里面”或“外面”。</strong></p> <h4 id="解决方法">解决方法：</h4> <p>我们可以通过<strong>累加曲线对某点的“有符号投影长度”或“有符号面积”</strong>，得到一个<strong>小数形式的“广义环绕数”</strong>（fractional winding number）。</p> <h4 id="优点">优点：</h4> <ul> <li>虽然结果不再是整数，但它仍然<strong>很好地反映了“内”与“外”的概率</strong>；</li> <li>通过设定一个阈值（threshold），我们可以在嘈杂数据中<strong>稳健地区分内外区域</strong>。</li> </ul> <h4 id="应用场景包括">应用场景包括：</h4> <ul> <li>提取<strong>水密网格</strong>（watertight mesh）；</li> <li><strong>四面体网格划分</strong>（tetrahedral meshing）；</li> <li><strong>实体布尔操作</strong>（Constructive Solid Geometry, CSG），如并集、交集、差集等。</li> </ul> <h2 id="空间曲线">空间曲线</h2> <p>一条<strong>参数化空间曲线</strong>是如下映射：</p> \[\gamma: [0, L] \to \mathbb{R}^3\] <p>其中：</p> <ul> <li><strong>定义域</strong>：实直线上的闭区间 $[0,L]$（通常表示弧长或时间参数）</li> <li><strong>值域</strong>：三维欧氏空间中的点集 ${\gamma(t) \mid t \in [0,L]}$</li> </ul> <p>曲线的微分 $ \mathrm{d}\gamma $ 实现了切空间的线性映射：</p> \[\mathrm{d} \gamma: T_t\mathbb{R} \to T_{\gamma(t)}\mathbb{R}^3\] <h3 id="推前映射pushforward">推前映射（Pushforward）</h3> <p><strong>推前映射</strong> $ d\gamma $ 将定义在参数域上的向量场 $ X $ 推前（”拉伸”）到三维空间中的曲线切向量场：</p> \[\mathrm{d} \gamma: T_t\mathbb{R} \to T_{\gamma(t)}\mathbb{R}^3\] <p>这一操作是微分几何中<strong>切映射</strong>的特例，也是雅可比矩阵在曲线情形下的具体表现。</p> <h4 id="具体构造步骤">具体构造步骤</h4> <p>设曲线 $\gamma(t) = (x(t), y(t), z(t))$ 和参数域上的向量场 $ X = a(t)\frac{\partial}{\partial t} $，则：</p> <ol> <li> <p><strong>坐标微分计算</strong>：</p> \[\mathrm{d}\gamma = \left( \frac{dx}{dt}, \frac{dy}{dt}, \frac{dz}{dt} \right) dt\] </li> <li> <p><strong>推前映射作用</strong>：</p> \[\mathrm{d}\gamma(X) = a(t) \left( \frac{dx}{dt}, \frac{dy}{dt}, \frac{dz}{dt} \right) \in \mathbb{R}^3\] <p><strong>几何意义</strong>：将参数速度 $ a(t) $ 转换为物理空间速度向量</p> </li> </ol> <h3 id="curvature-曲率-and-torsion-扭率">Curvature （曲率） and Torsion (扭率？)</h3> <p>平面上的曲率描述曲线的弯曲程度，而在空间中，还包括torsion，描述扭曲的程度。</p> <h3 id="frenet标架与frenet-serret方程空间曲线的局部坐标系">Frenet标架与Frenet-Serret方程：空间曲线的局部坐标系</h3> <p>对于正则空间曲线 $\gamma(s)$（弧长参数化），其Frenet标架由三个单位正交向量组成：</p> <ol> <li> <p><strong>切向量（Tangent）</strong>：</p> <p>\(T(s) = \gamma'(s)\) <em>方向：曲线瞬时运动方向</em></p> </li> <li> <p><strong>法向量（Normal）</strong>：</p> <p>\(N(s) = \frac{T'(s)}{\|T'(s)\|} = \frac{\gamma''(s)}{\kappa(s)}\) <em>方向：指向曲率中心</em></p> </li> <li> <p><strong>副法向量（Binormal）</strong>：</p> \[B(s) = T(s) \times N(s)\] <p><em>方向：垂直于密切平面，构成右手系</em></p> </li> </ol> <h4 id="frenet-serret">Frenet-Serret</h4> <p>Frenet标架沿曲线的演化由曲率 $\kappa$ 和挠率 $\tau$ 完全控制，<strong>矩阵形式</strong>：</p> \[\frac{d}{ds} \begin{bmatrix} T \\ N \\ B \end{bmatrix} = \begin{bmatrix} 0 &amp; -\kappa &amp; 0 \\ \kappa &amp; 0 &amp; -\tau \\ 0 &amp; \tau &amp; 0 \end{bmatrix} \begin{bmatrix} T \\ N \\ B \end{bmatrix}\] <h4 id="几何解释-1">几何解释</h4> <table> <thead> <tr> <th><strong>方程</strong></th> <th><strong>物理意义</strong></th> <th><strong>类比</strong></th> </tr> </thead> <tbody> <tr> <td>$ T’ = \kappa N $</td> <td>切向变化率 ⇒ 弯曲强度</td> <td>离心力指向曲率中心</td> </tr> <tr> <td>$ N’ = -\kappa T + \tau B $</td> <td>法向变化由弯曲和扭转共同作用</td> <td>科里奥利力效应</td> </tr> <tr> <td>$ B’ = -\tau N $</td> <td>副法向变化率 ⇒ 纯扭转效应</td> <td>螺旋进</td> </tr> </tbody> </table> <h3 id="空间曲线基本定理">空间曲线基本定理</h3> <p>和平面一样，对于给定的连续函数 $\kappa(s) &gt; 0$ 和 $\tau(s)$，存在<strong>唯一</strong>（刚体运动意义下）的弧长参数化空间曲线 $\gamma(s)$，使得：</p> <ul> <li>$\kappa(s)$ 是该曲线的曲率</li> <li>$\tau(s)$ 是该曲线的挠率</li> </ul> <p><strong>唯一性</strong>：两条曲线若具有相同的 $\kappa(s)$ 和 $\tau(s)$，则仅相差一个刚体变换（旋转+平移）</p> <h2 id="曲线总结">曲线总结</h2> <p>描述曲线的方式有很多种，例如代数方式（algebraic curves）等。</p> <p>在<strong>微分几何</strong>中，最常用的方式是使用<strong>参数化曲线</strong>，因为它可以通过对参数化函数求导数来提取许多关键的局部几何量：</p> <ul> <li><strong>切向量、法向量、双法向量</strong>（组成 Frenet 框架）</li> <li><strong>曲率、挠率</strong>（curvature, torsion）</li> </ul> <p>此外，还有几个重要的概念：</p> <ul> <li><strong>嵌入（embedded）</strong> vs. <strong>沉浸/正则（immersed / regular）</strong>：描述曲线是否自交、是否处处有定义良好的导数。</li> <li><strong>切线数（Turning Number）</strong>：单位切向量映射到单位圆的“度数”。</li> <li><strong>环绕数（Winding Number）</strong>：曲线绕某个点的“度数”。</li> </ul> <p>最后，微分几何中的一个重要结论：</p> <blockquote> <p><strong>平面/空间曲线的基本定理</strong>： 只要知道一条曲线的<strong>曲率（和挠率）函数</strong>，就可以在刚体运动不变的意义下<strong>唯一确定这条曲线的形状</strong>。</p> </blockquote>]]></content><author><name></name></author><category term="DDG"/><category term="Geometry"/><summary type="html"><![CDATA[曲线与表面]]></summary></entry><entry><title type="html">DDG Vector-Valued Differential Forms</title><link href="https://pasu.github.io/blog/2025/Vector_Field/" rel="alternate" type="text/html" title="DDG Vector-Valued Differential Forms"/><published>2025-04-28T10:27:00+00:00</published><updated>2025-04-28T10:27:00+00:00</updated><id>https://pasu.github.io/blog/2025/Vector_Field</id><content type="html" xml:base="https://pasu.github.io/blog/2025/Vector_Field/"><![CDATA[<h2 id="k-form">k-Form</h2> <p><strong>k-form</strong> 是对 <strong>k-vector</strong> 的一种<strong>完全反对称</strong>（fully antisymmetric）、<strong>多线性</strong>（multilinear）的测量（measurement）。</p> <p>它是一个<strong>从 k 个向量映射到一个实数（scalar）</strong>的映射：</p> \[\alpha: (v_1, v_2, \dots, v_k) \mapsto \mathbb{R}\] <p>一个 <strong>k-form</strong> $\alpha$ 可以写成坐标微分的 wedge product 的线性组合（linear combination）形式：</p> \[\alpha = \sum_{I} f_I(x) \, dx^{i_1} \wedge dx^{i_2} \wedge \cdots \wedge dx^{i_k}\] <p>其中：</p> <ul> <li>求和是对所有递增的多重指标 $I = (i_1, i_2, \dots, i_k)$ 进行的，满足 $1 \leq i_1 &lt; i_2 &lt; \cdots &lt; i_k \leq n$，</li> <li>每个 $f_I(x)$ 是定义在 $\mathbb{R}^n$ 上的光滑实值函数（smooth scalar function），</li> <li>每个 $dx^{i_1} \wedge dx^{i_2} \wedge \cdots \wedge dx^{i_k}$ 是通过 wedge product 生成的基本 k-form（basic k-form）。</li> </ul> <p>用直白的话说：</p> <ul> <li>一个 <strong>k-form</strong> 是若干项的和，每一项由一个函数乘以 $k$ 个 coordinate differential 的 wedge product 组成，</li> <li><strong>$k$</strong> 必须满足 <strong>$k \leq n$</strong>，因为如果维度不够，就无法拿出 $k$ 个独立方向来进行 wedge。</li> </ul> <h3 id="multilinear多线性">Multilinear（多线性）</h3> <ul> <li><strong>多线性</strong>意味着：当固定其他输入时，对每一个输入向量单独是线性的。</li> <li>具体来说，对于任意向量 $v_j, w_j$ 和标量 $\lambda$，有：</li> </ul> \[\alpha(v_1, \dots, \lambda v_j + w_j, \dots, v_k) = \lambda \alpha(v_1, \dots, v_j, \dots, v_k) + \alpha(v_1, \dots, w_j, \dots, v_k)\] <p>也就是说：</p> <ul> <li>每一个输入变量都是独立线性的，</li> <li>缩放一个输入向量，结果也随之缩放，</li> <li>相加则可以分开计算。</li> </ul> <h3 id="fully-antisymmetric完全反对称">Fully Antisymmetric（完全反对称）</h3> <ul> <li><strong>完全反对称</strong>意味着：如果交换任意两个输入向量，输出符号会翻转（取负）。</li> <li>更进一步，如果两个输入向量相同，那么输出结果为 0。</li> </ul> <p>形式化表达：</p> <ul> <li>对于任意输入向量交换（一个排列 $\sigma$）：</li> </ul> \[\alpha(v_{\sigma(1)}, \dots, v_{\sigma(k)}) = \text{sign}(\sigma) \, \alpha(v_1, \dots, v_k)\] <p>其中 $\text{sign}(\sigma)$ 是排列的符号：</p> <ul> <li>偶排列（交换偶数次）是 $+1$，</li> <li>奇排列（交换奇数次）是 $-1$。</li> </ul> <p>特别地：</p> <ul> <li>交换两个向量：$\alpha(v, w) = -\alpha(w, v)$，</li> <li>两个向量相同：$\alpha(v, v) = 0$。</li> </ul> <h2 id="differential-k-form">Differential k-Form</h2> <p>以2-form和Differential 2-form为例：</p> <ul> <li> <p><strong>2-form</strong> 指的是 <strong>在某一个点</strong> 上定义的对象：<br/> 它是一个在某点 $p$ 上，接受两个切向量 $v, w$，输出一个实数的多线性、完全反对称映射。</p> </li> <li> <p><strong>Differential 2-form</strong> 指的是 <strong>在整个空间（或者流形）上每个点</strong> 都有一个 2-form，<br/> 也就是说：每一个点 $p$ 上都有一个 2-form，而且这些 2-form 在空间中随位置变化，通常是<strong>光滑变化</strong>的。</p> </li> </ul> <p>两者对比如下：</p> <table> <thead> <tr> <th style="text-align: left"> </th> <th style="text-align: left">2-form</th> <th style="text-align: left">differential 2-form</th> </tr> </thead> <tbody> <tr> <td style="text-align: left">定义位置</td> <td style="text-align: left">单独一个点</td> <td style="text-align: left">整个空间上，每点一个</td> </tr> <tr> <td style="text-align: left">本质</td> <td style="text-align: left">多线性、完全反对称的映射</td> <td style="text-align: left">点到点赋值，每点给一个 2-form</td> </tr> <tr> <td style="text-align: left">举例</td> <td style="text-align: left">$2\, dx \wedge dy$</td> <td style="text-align: left">$x\, dx \wedge dy$</td> </tr> </tbody> </table> <ul> <li><strong>2-form</strong> 就像是“定格”在某一点的测量规则。</li> <li><strong>Differential 2-form</strong> 是“在整个空间流动变化”的 2-form 场（field）。</li> </ul> <p>就像：</p> <ul> <li>向量（vector） vs 向量场（vector field），</li> <li>2-form vs differential 2-form。</li> </ul> <h2 id="vector-valued-k-forms">Vector Valued k-Forms</h2> <p><strong>Vector-valued k-form</strong> 是一种从 $k$ 个向量（在向量空间 $V$ 中）映射到另一个向量空间 $U$ 的<strong>完全反对称、 多线性</strong>（fully antisymmetric, multilinear）映射。</p> <p>对于一个取值在 $\mathbb{R}^m$（而不是实数）的<strong>向量值 k-form</strong> $\boldsymbol{\alpha}$，形式变为：</p> \[\boxed{ \boldsymbol{\alpha} = \sum_{I} \left( \sum_{a=1}^m f_I^a(x) \, e_a \right) dx^{i_1} \wedge dx^{i_2} \wedge \cdots \wedge dx^{i_k} }\] <p>其中：</p> <ul> <li>$e_a$ 是 $\mathbb{R}^m$ 中的标准基向量（standard basis vector），例如：<br/> $e_1 = (1,0,\dots,0)$，$e_2 = (0,1,0,\dots,0)$，以此类推，</li> <li>每个 $f_I^a(x)$ 是定义在 $\mathbb{R}^n$ 上的光滑实值函数，</li> <li>每一个多重指标 $I$ 对应一个 $\mathbb{R}^m$-值的系数（vector-valued coefficient）。</li> </ul> <hr/> <p>换个角度理解：</p> <ul> <li>可以把 $\boldsymbol{\alpha}$ 看作是一个由 $m$ 个<strong>标量值 k-form</strong>组成的元组（tuple）：</li> </ul> \[\boldsymbol{\alpha} = \left( \alpha^1, \alpha^2, \ldots, \alpha^m \right)\] <p>其中每个 $\alpha^a$ 都是一个独立的标量值 k-form。</p> <p>也就是说：<strong>向量值 k-form = 多个标量值 k-form 并排组合</strong>，每一份对应 $\mathbb{R}^m$ 中的一个分量（component）。</p> <h3 id="wedge-product">Wedge product</h3> <p>当我们在处理<strong>向量值的微分形式</strong>时，<strong>如何定义和计算外积（wedge product）</strong>，和标量值形式有所不同。</p> <ul> <li> <p><strong>举个例子，</strong>考虑一对$\mathbb{R}^m$-值的1-形式（比如 $\boldsymbol{\alpha}$ 和 $\boldsymbol{\beta}$）：</p> </li> <li> <p><strong>如果它们是实数值（标量值）形式：</strong><br/> 那么对于两个向量 $u$、$v$，计算外积的方法就是：</p> </li> </ul> \[(\alpha \wedge \beta)(u,v) = \alpha(u)\beta(v) - \alpha(v)\beta(u)\] <p>如果$\boldsymbol{\alpha}$和$\boldsymbol{\beta}$是向量值形式，那么</p> \[(\boldsymbol{\alpha} \wedge \boldsymbol{\beta})(u,v) = \boldsymbol{\alpha}(u) \times \boldsymbol{\beta}(v) - \boldsymbol{\alpha}(v) \times \boldsymbol{\beta}(u)\] <p>这里的“$\times$”就是标准的三维叉积（cross product）。</p> <p>在我们熟悉的标量值k-形式中，<br/> wedge product（外积）代表的是：</p> <blockquote> <p><strong>“测量一个k维平行体（parallelepiped）的体积元素”，并且带有方向性（orientation）和反对称性。</strong></p> </blockquote> <p>对于<strong>向量值k-形式</strong>，比如用叉积（cross product）实现的情况，几何意义是：</p> <blockquote> <p><strong>不仅测量面积或体积，而且用一个向量来表示：</strong></p> <ul> <li>这个向量的<strong>方向</strong>垂直于生成平面，</li> <li><strong>长度</strong>与生成平行四边形的面积成正比，</li> </ul> </blockquote> <h4 id="举例">举例：</h4> <ul> <li>在$\mathbb{R}^3$，<br/> 如果你有两个向量 $u, v$，<br/> 那么它们的叉积 $u \times v$： <ul> <li>方向垂直于 $u$、$v$ 生成的平面，</li> <li>大小是平行四边形的面积，</li> <li>方向由 $u, v$ 顺序决定（右手法则）。</li> </ul> </li> </ul> <p>这正是一个典型的<strong>向量值的外积的几何意义</strong>。代表<strong>面积（或高阶体积）+ 方向</strong>，同时反映了输入向量的<strong>顺序敏感性（反对称性）</strong>。</p> <p>\((\alpha \wedge \beta)(u,v) = \alpha(u) \times \beta(v) - \alpha(v) \times \beta(u)\) 的对称性/反对称性性质：</p> <h3 id="关键观察"><strong>关键观察</strong></h3> <ol> <li> <p><strong>向量输入 $(u,v)$ 的反对称性</strong>： \((\alpha \wedge \beta)(v,u) = \alpha(v) \times \beta(u) - \alpha(u) \times \beta(v) = -(\alpha \wedge \beta)(u,v)。\) 这确认了它在向量输入上是<strong>反对称的</strong>，符合2-形式的定义。</p> </li> <li> <p><strong>形式输入 $(\alpha,\beta)$ 的对称性</strong>： \((\beta \wedge \alpha)(u,v) = \beta(u) \times \alpha(v) - \beta(v) \times \alpha(u)。\) 运用叉乘的基本性质 $\mathbf{a} \times \mathbf{b} = -\mathbf{b} \times \mathbf{a}$，有 \(= -(\alpha(v) \times \beta(u)) + (\alpha(u) \times \beta(v)) = (\alpha \wedge \beta)(u,v)。\) 因此，$(\beta \wedge \alpha) = (\alpha \wedge \beta)$，说明此运算在交换 $\alpha$ 和 $\beta$ 时是<strong>对称的</strong>。</p> </li> </ol> <hr/> <h3 id="几何直观"><strong>几何直观</strong></h3> <ul> <li>之所以出现 $(\alpha \wedge \beta) = (\beta \wedge \alpha)$ 的对称性，是因为<strong>叉乘将 $\alpha$ 和 $\beta$ 非平凡地耦合</strong>。不同于标量楔积（其中 $\alpha \wedge \beta = -\beta \wedge \alpha$），这里由于叉乘自身引入了一个符号翻转，反而导致整体对称。</li> </ul> <hr/> <h3 id="与标量楔积的比较"><strong>与标量楔积的比较</strong></h3> <table> <thead> <tr> <th>性质</th> <th>标量 $k$-形式（$\mathbb{R}$值）</th> <th>向量值2-形式（$\mathbb{R}^3$值）</th> </tr> </thead> <tbody> <tr> <td><strong>向量输入的反对称性</strong></td> <td>$(\alpha \wedge \beta)(u,v) = -(\alpha \wedge \beta)(v,u)$</td> <td>成立（与标量形式一致）</td> </tr> <tr> <td><strong>形式输入的对称性</strong></td> <td>$\alpha \wedge \beta = -\beta \wedge \alpha$</td> <td>$\alpha \wedge \beta = +\beta \wedge \alpha$</td> </tr> </tbody> </table> <hr/> <h3 id="为什么这很重要"><strong>为什么这很重要</strong></h3> <ol> <li><strong>物理学</strong>：在电磁学中，这种对称的乘积描述了<strong>能量-动量张量</strong>或<strong>应力-能量耦合</strong>，其中场的各个分量以可交换的方式相互作用。</li> <li><strong>代数学</strong>：这个运算在$\mathbb{R}^3$值的1-形式空间上定义了一个<strong>对称双线性形式</strong>，而不是通常外代数中的反对称结构。</li> </ol> <hr/> <h3 id="例子"><strong>例子</strong></h3> <p>设 $\alpha = f \, dx$、$\beta = g \, dy$（其中 $f,g$ 是常向量，属于 $\mathbb{R}^3$）： \((\alpha \wedge \beta)(u,v) = f \times g \cdot (u^1 v^2 - u^2 v^1)，\\ (\beta \wedge \alpha)(u,v) = g \times f \cdot (u^1 v^2 - u^2 v^1) = f \times g \cdot (u^1 v^2 - u^2 v^1)。\) 由于 $g \times f = -f \times g$，并且结合 $dx \wedge dy$ 的反对称性，两个负号相互抵消，从而得到$(\alpha \wedge \beta) = (\beta \wedge \alpha)$。</p> <hr/> <h3 id="总结"><strong>总结</strong></h3> <p>你的观察是正确的：</p> <ul> <li><strong>在向量输入上反对称</strong>（符合2-形式的要求）；</li> <li><strong>在形式交换下对称</strong>（由于叉乘的反对称性带来的正号）。</li> </ul> <p>因此，这种运算是一个<strong>对称的向量值2-形式</strong>，与传统标量楔积的反对称性不同。</p> <p><strong>最终结论</strong>： \(\boxed{ \begin{aligned} &amp;(\alpha \wedge \beta)(u,v) = -(\alpha \wedge \beta)(v,u) \quad \text{（向量输入反对称）}, \\ &amp;(\alpha \wedge \beta)(u,v) = (\beta \wedge \alpha)(u,v) \quad \text{（形式输入对称）}. \end{aligned} }\)</p> <p>进一步来看，如果将同一个形式自我楔积（即$\alpha = \beta$），那么我们得到：</p> <p>\((\alpha \wedge \alpha)(u,v) = \alpha(u) \times \alpha(v) - \alpha(v) \times \alpha(u)。\) 使用叉乘的反对称性性质 $\mathbf{a} \times \mathbf{b} = -\mathbf{b} \times \mathbf{a}$，可以发现： \(\alpha(v) \times \alpha(u) = -\alpha(u) \times \alpha(v)，\) 因此： \((\alpha \wedge \alpha)(u,v) = \alpha(u) \times \alpha(v) + \alpha(u) \times \alpha(v) = 2 \, \alpha(u) \times \alpha(v)。\)</p> <p>自楔积不是零！而是原本叉积的两倍：</p> \[\boxed{(\alpha \wedge \alpha)(u,v) = 2 \, \alpha(u) \times \alpha(v)}\] <p>这与标量楔积（例如 $dx \wedge dx = 0$）截然不同。在标量形式中，同一个1-形式自楔积总是零，因为标量楔积本质上是反对称的；而这里，由于叉乘带来的符号翻转，导致自楔积不为零。</p> <ul> <li>自楔积一般<strong>不为零</strong>，而是产生了一个<strong>2倍的叉积项</strong>。</li> <li>这体现了向量值2-形式不同于标量外代数的深刻差异。</li> </ul> <h2 id="vector-valued-differential-k-forms">Vector-Valued Differential k-Forms</h2> <p>正如我们区分了 <strong>𝑘-form</strong>（定义在单个点上的对象）和微分$𝑘$-form（在每个点上赋值的对象）一样，我们也可以说，向量值微分$𝑘$-form是指：在每个点上赋值为一个向量值$k$-form的对象。</p> <p>与楔积（wedge product）不同，<strong>外导数（exterior derivative）作用在向量值微分形式上时变化不大</strong>。<br/> 如果我们有一个取值于$\mathbb{R}^n$的$k$-形式（即向量值$k$-形式），可以简单地理解为<strong>有$n$个实值$k$-形式</strong>，分别在每个分量上独立地进行微分。</p> <p>换句话说，外导数只是<strong>对每个分量分别取外导数</strong>，并不会引入新的耦合或交互。</p> <p>假设我们有一个向量值1-形式$\alpha = (\alpha_1, \alpha_2, \alpha_3)$，其中每个$\alpha_i$都是普通的实值1-形式。<br/> 那么它的外导数就是：</p> \[d\alpha = (d\alpha_1, d\alpha_2, d\alpha_3)\] <p>即，对每个分量单独取外导数。</p> <h3 id="例子mathbbr2值微分0-形式"><strong>例子：$\mathbb{R}^2$值微分0-形式</strong></h3> <p>考虑向量值微分0-形式（即，每个点赋值一个$\mathbb{R}^2$向量）：</p> \[\phi(x,y) := \begin{bmatrix} x^2 \\ xy \end{bmatrix}\] <p>其中，$\phi$的第一个分量是标量函数$x^2$，第二个分量是标量函数$xy$。</p> <h4 id="计算外导数"><strong>计算外导数</strong></h4> <p>根据前面的原则，<strong>对每个分量分别取外导数</strong>。</p> <p><strong>第一分量</strong> $x^2$：</p> \[d(x^2) = 2x \, dx\] <p><strong>第二分量</strong> $xy$：</p> \[d(xy) = x \, dy + y \, dx\] <p>因此，$\phi$的外导数 $d\phi$ 是一个$\mathbb{R}^2$-值的1-形式：</p> \[d\phi(x,y) = \begin{bmatrix} 2x \, dx \\ x \, dy + y \, dx \end{bmatrix}\] <p>考虑一个$\mathbb{R}^2$值微分1-形式：</p> \[\alpha(x,y) = \begin{bmatrix} x^2 \\ xy \end{bmatrix} dx + \begin{bmatrix} xy \\ y^2 \end{bmatrix} dy\] <p>这意味着：在每一点$(x,y)$，$\alpha$返回一个$\mathbb{R}^2$向量，每个分量是一个线性组合的1-形式（$dx$、$dy$）。</p> <h3 id="例子mathbbr2值微分1-形式"><strong>例子：$\mathbb{R}^2$值微分1-形式</strong></h3> <p>考虑一个$\mathbb{R}^2$值微分1-形式：</p> \[\alpha(x,y) = \begin{bmatrix} x^2 \\ xy \end{bmatrix} dx + \begin{bmatrix} xy \\ y^2 \end{bmatrix} dy\] <p>这意味着：在每一点$(x,y)$，$\alpha$返回一个$\mathbb{R}^2$向量，每个分量是一个线性组合的1-形式（$dx$、$dy$）。</p> <p><strong>计算外导数 $d\alpha$</strong></p> <p>记住原则：<strong>对每个分量分别取外导数</strong>，并且使用外导数的Leibniz规则（微分运算满足乘积规则）。</p> <p><strong>第一个分量</strong>： \(\alpha_1 = x^2 \, dx + xy \, dy\)</p> <p>对$\alpha_1$取外导数：</p> \[d\alpha_1 = d(x^2) \wedge dx + d(xy) \wedge dy\] <p>分别计算：</p> <ul> <li>$d(x^2) = 2x \, dx$</li> <li>$d(xy) = x \, dy + y \, dx$</li> </ul> <p>所以：</p> \[d\alpha_1 = (2x \, dx) \wedge dx + (x \, dy + y \, dx) \wedge dy\] <p>注意：</p> <ul> <li>$dx \wedge dx = 0$，因为楔积反对称；</li> <li>$dy \wedge dy = 0$。</li> </ul> <p>因此：</p> \[d\alpha_1 = (2x \, dx) \wedge dx + (x \, dy) \wedge dy + (y \, dx) \wedge dy = 0 + 0 + y \, dx \wedge dy\] <p>即：</p> \[d\alpha_1 = y \, dx \wedge dy\] <hr/> <p><strong>第二个分量</strong>： \(\alpha_2 = xy \, dx + y^2 \, dy\)</p> <p>同样地，对$\alpha_2$取外导数：</p> \[d\alpha_2 = d(xy) \wedge dx + d(y^2) \wedge dy\] <p>分别计算：</p> <ul> <li>$d(xy) = x \, dy + y \, dx$</li> <li>$d(y^2) = 2y \, dy$</li> </ul> <p>所以：</p> \[d\alpha_2 = (x \, dy + y \, dx) \wedge dx + (2y \, dy) \wedge dy\] <p>展开：</p> <ul> <li>$dy \wedge dx = -dx \wedge dy$</li> <li>$dx \wedge dx = 0$</li> <li>$dy \wedge dy = 0$</li> </ul> <p>因此：</p> \[d\alpha_2 = x (-dx \wedge dy) + 0 + 0 = -x \, dx \wedge dy\] <hr/> <h3 id="最终结果"><strong>最终结果</strong></h3> <p>所以整个$d\alpha$是：</p> \[d\alpha(x,y) = \begin{bmatrix} y \\ -x \end{bmatrix} dx \wedge dy\] <p>也就是说，$d\alpha$是一个$\mathbb{R}^2$-值的2-形式，每个分量是$dx \wedge dy$乘以一个标量函数。</p> <h2 id="总结-1">总结</h2> <p>向量值微分形式就是在每个点赋值一个向量（而非标量）的$k$-form，对它进行外导数时，只需对每个分量分别取外导数，和实值微分形式完全类似，不引入分量间的耦合。</p>]]></content><author><name></name></author><category term="DDG"/><category term="Geometry"/><summary type="html"><![CDATA[k-Form]]></summary></entry><entry><title type="html">DDG Discrete Differential Forms</title><link href="https://pasu.github.io/blog/2025/Discrete_Differential_Forms-Copy/" rel="alternate" type="text/html" title="DDG Discrete Differential Forms"/><published>2025-04-24T10:27:00+00:00</published><updated>2025-04-24T10:27:00+00:00</updated><id>https://pasu.github.io/blog/2025/Discrete_Differential_Forms%20-%20Copy</id><content type="html" xml:base="https://pasu.github.io/blog/2025/Discrete_Differential_Forms-Copy/"><![CDATA[<h3 id="为什么我们需要-discrete-exterior-calculus">为什么我们需要 Discrete Exterior Calculus？</h3> <p>经过之前的学习，我们已经理解了 <strong>exterior calculus</strong>，能够在光滑流形上实现 <em>k-form</em> 下的微分和积分表达，其求解问题则转化为一个关于 <em>differential forms</em> 的微分方程。</p> <p>但问题在于：</p> <ul> <li>即使是非常简单的微分方程，也往往难以手工求解！（更别说复杂情况了……）</li> <li>如果这些方程涉及实际测量数据（例如 domain geometry），那么手工求解几乎不可能完成。</li> <li>因此，我们需要借助计算机来<strong>数值逼近</strong>这些方程的解。</li> </ul> <p><strong>Discrete Exterior Calculus (DEC)</strong> 就是在这种背景下提出的，其核心思路是：</p> <ul> <li>使用 <strong>mesh</strong>（网格）代替连续的定义域 —— 通常是一个有向的 <strong>simplicial complex</strong>（单纯形复形）；</li> <li>使用网格上各 <em>k-simplex</em> 的数值来代替光滑的 <strong>differential k-form</strong>；</li> <li>使用稀疏矩阵来代替微分算子 —— 例如，用带符号的邻接矩阵（signed incidence matrix）来表达 <em>exterior derivative</em>（外导数）。</li> </ul> <p>通过这种方式，DEC 可以让我们在任意复杂曲面甚至非欧几何背景下，结构良好地离散化和求解微分形式相关的物理和几何问题。</p> <hr/> <h3 id="basic-operations--composition-of-operators">Basic Operations &amp; Composition of Operators</h3> <p>在上一节我们看到了 DEC 的总体动机，本节我们进一步了解它的基本操作构建和常见算子的组合方式。</p> <h4 id="如何将光滑形式替换为离散表示">如何将光滑形式替换为离散表示</h4> <p>在 DEC 中，我们用下列方式将连续几何中的微分对象转化为离散表示：</p> <ul> <li>使用 <strong>oriented simplicial complex</strong>（有向单纯形复形）作为离散的计算网格；</li> <li>将 <em>differential k-form</em> 替换为网格中每个 <em>k-simplex</em> 上的一个数值 —— 这些称为 <strong>discrete differential forms</strong>；</li> <li>将微分算子（如 <em>exterior derivative</em>）表示为稀疏矩阵 —— 最常见的就是 <strong>signed incidence matrix</strong>（带符号邻接矩阵）。</li> </ul> <p>这些操作使得我们可以把原本复杂的几何和物理过程，转换为标准的线性代数问题。</p> <p>如上图，我们定义四个顶点（vertices）:</p> <ul> <li>$ v_0 = 0 $</li> <li>$ v_1 = 1 $</li> <li>$ v_2 = 2 $</li> <li>$ v_3 = 3 $</li> </ul> <p>对应的两个三角形（faces）:</p> <ul> <li>$ f_0 = {v_0, v_1, v_2} $</li> <li>$ f_1 = {v_0, v_2, v_3} $</li> </ul> <p>对应的5个 <strong>oriented edges</strong>:</p> <table> <thead> <tr> <th>Edge</th> <th>Orientation</th> <th>Index</th> </tr> </thead> <tbody> <tr> <td>$ e_0 $</td> <td>$ v_0 \rightarrow v_1 $</td> <td>0</td> </tr> <tr> <td>$ e_1 $</td> <td>$ v_1 \rightarrow v_2 $</td> <td>1</td> </tr> <tr> <td>$ e_2 $</td> <td>$ v_2 \rightarrow v_0 $</td> <td>2</td> </tr> <tr> <td>$ e_3 $</td> <td>$ v_0 \rightarrow v_3 $</td> <td>3</td> </tr> <tr> <td>$ e_4 $</td> <td>$ v_3 \rightarrow v_2 $</td> <td>4</td> </tr> </tbody> </table> <p>现在通过如上这个例子介绍算子。</p> <h4 id="基本算子dd-和-hodge-star">基本算子：d₀、d₁ 和 Hodge Star</h4> <p>我们先来看两个最基本的 <strong>离散外导数</strong>（discrete exterior derivative）矩阵：</p> <h5 id="dvertex--edge">d₀：Vertex → Edge</h5> <p>它是一个边对顶点的邻接矩阵，每一行对应一条有向边，每一列对应一个顶点。如果某条边的起点是顶点 $v_i$，终点是 $v_j$，则该行在 $i$ 位置是 $-1$，在 $j$ 位置是 $+1$。</p> \[d_0 = \begin{bmatrix} -1 &amp; +1 &amp; 0 &amp; 0 \\ 0 &amp; -1 &amp; +1 &amp; 0 \\ +1 &amp; 0 &amp; -1 &amp; 0 \\ -1 &amp; 0 &amp; 0 &amp; +1 \\ 0 &amp; 0 &amp; +1 &amp; -1 \\ \end{bmatrix}\] <p>这是离散版本的 <strong>gradient</strong>（梯度）操作。</p> <h5 id="dedge--face">d₁：Edge → Face</h5> <p>每一行对应一个三角形（face），每一列对应一条边。每个三角形的边若与其方向一致，则为 $+1$，否 则为 $-1$。</p> \[d_1 = \begin{bmatrix} +1 &amp; +1 &amp; -1 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; -1 &amp; +1 &amp; -1 \\ \end{bmatrix}\] <p>这是离散版本的 <strong>curl</strong>（旋度）操作。</p> <h5 id="hodge-star-star_k">Hodge Star ($\star_k$)</h5> <p>Hodge 星号算子将 <strong>primal k-form</strong> 映射为 <strong>dual (n–k)-form</strong>。在离散中，它通常表现为一个 <strong>对角矩阵</strong>，每一项表示 <em>dual cell</em> 与 <em>primal simplex</em> 之间的比例关系。例如：</p> <ul> <li>$\star_0$：顶点对应的 dual 面积；</li> <li>$\star_1$：边的 dual 长度 / 边的原始长度；</li> <li>$\star_2$：三角形面积的倒数。</li> </ul> <p>假设$v_0=(0,1)$， $v_1=(-1,0)$，$v_2=(0,-1)$，$v_3=(1,0)$，则$Area_{f_0} = Area_{f_1} = 1$，因此：</p> \[\star_2 = \begin{bmatrix} 1.0 &amp; 0 \\ 0 &amp; 1.0 \\ \end{bmatrix}\] <p>这里，我们假设$e$对应的dual edge $e^\star$的长度为1：</p> \[\star_1 = \begin{bmatrix} \frac{1.0}{1.414} &amp; &amp; &amp; &amp; \\ &amp; \frac{1.0}{1.414} &amp; &amp; &amp; \\ &amp; &amp; \frac{1.0}{2.0} &amp; &amp; \\ &amp; &amp; &amp; \frac{1.0}{1.414} &amp; \\ &amp; &amp; &amp; &amp; \frac{1.0}{1.414} \\ \end{bmatrix} \approx \begin{bmatrix} 0.707 &amp; &amp; &amp; &amp; \\ &amp; 0.707 &amp; &amp; &amp; \\ &amp; &amp; 0.5 &amp; &amp; \\ &amp; &amp; &amp; 0.707 &amp; \\ &amp; &amp; &amp; &amp; 0.707 \\ \end{bmatrix}\] <p>每个顶点的对偶面积 (dual area) $\approx$ 其相邻三角形面积的 $1/3$ 之和：</p> \[\star_0 = \begin{bmatrix} 0.6667 &amp; 0 &amp; 0 &amp; 0 \\ 0 &amp; 0.3333 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 0.6667 &amp; 0 \\ 0 &amp; 0 &amp; 0 &amp; 0.3333 \\ \end{bmatrix}\] <h4 id="组合操作gradcurldivlaplacian">组合操作：grad、curl、div、Laplacian</h4> <p>借助上面的基本矩阵，我们可以组合出熟悉的微分算子：</p> <ul> <li><strong>grad</strong> = $ d_0 $：顶点函数 → 边的差值</li> <li><strong>curl</strong> = $ \star_2 d_1 $：边上的 1-form → 三角形上的旋度（2-form）</li> <li><strong>div</strong> = $ \star_0^{-1} d_0^\top \star_1 $：边上的 1-form → 顶点上的散度（0-form）</li> <li><strong>Laplacian</strong> = $ \star_0^{-1} d_0^\top \star_1 d_0 $：离散 Poisson 方程中的主角</li> </ul> <p>定义$f$是一个顶点$v_i$的scalar function：</p> \[f = \begin{bmatrix} f_0 \\ f_1 \\ f_2 \\ f_3 \\ \end{bmatrix} = \begin{bmatrix} 1.0 \\ 2.0 \\ 0.5 \\ 3.0 \\ \end{bmatrix}\] <p>对应的顶点值如下：</p> <ul> <li>$ f(v_0) = 1.0 $</li> <li>$ f(v_1) = 2.0 $</li> <li>$ f(v_2) = 0.5 $</li> <li>$ f(v_3) = 3.0 $</li> </ul> <p>则 $grad = d_0 f$:</p> \[d_0 f = \begin{bmatrix} -1 &amp; +1 &amp; 0 &amp; 0 \\ 0 &amp; -1 &amp; +1 &amp; 0 \\ +1 &amp; 0 &amp; -1 &amp; 0 \\ -1 &amp; 0 &amp; 0 &amp; +1 \\ 0 &amp; 0 &amp; +1 &amp; -1 \\ \end{bmatrix} \cdot \begin{bmatrix} 1.0 \\ 2.0 \\ 0.5 \\ 3.0 \\ \end{bmatrix} = \begin{bmatrix} -1(1.0) + 1(2.0) = 1.0 \\ -1(2.0) + 1(0.5) = -1.5 \\ 1(1.0) - 1(0.5) = 0.5 \\ -1(1.0) + 1(3.0) = 2.0 \\ 1(0.5) - 1(3.0) = -2.5 \\ \end{bmatrix}\] <p>$ curl = \star_2 d_1$:</p> \[\star_2 d_1 \alpha = \begin{bmatrix} 1.0 &amp; 0 \\ 0 &amp; 1.0 \\ \end{bmatrix} \begin{bmatrix} +1 &amp; +1 &amp; +1 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; +1 &amp; +1 &amp; +1 \\ \end{bmatrix} \cdot \begin{bmatrix} 1.0 \\ -1.5 \\ 0.5 \\ 2.0 \\ -2.5 \\ \end{bmatrix} = \begin{bmatrix} 0.0 \\ 0.0 \\ \end{bmatrix}\] <p>这里需要注意，因为$\alpha = d_0 f$已经考虑了edge的direction，$d_1$只需要求和。同时结果也验证了梯度的旋度总是为零：$\nabla \times (\nabla \phi) = 0$。</p> <h5 id="关于-divergence-的详细说明">关于 divergence 的详细说明</h5> <p>这个算子链：</p> \[\boxed{\text{div} = \star_0^{-1} d_0^\top \star_1}\] <p>的含义是：</p> <ol> <li><strong>$\star_1$</strong>：将边上的 1-form 映射到 dual edge 上，编码了度量信息；</li> <li><strong>$d_0^\top$</strong>：对应 gradient 的共轭操作，将边的信息“聚合”到每个顶点；</li> <li><strong>$\star_0^{-1}$</strong>：把顶点的聚合值归一化为散度密度（例如除以顶点周围 dual 面积）。</li> </ol> <p>所以这个算子表达的是<strong>顶点处的净流出强度</strong>，它是 gradient 的 adjoint，符合离散散度的物理意义。</p> <p>该例子对应的Laplacian:</p> \[\Delta \phi = \nabla \cdot (\nabla \phi) = \star_0^{-1} d_0^\top \star_1 d_0 f = \begin{bmatrix} 1.5 \cdot (-1.871) = -2.807 \\ 3.0 \cdot 1.767 = 5.301 \\ 1.5 \cdot (-3.078) = -4.617 \\ 3.0 \cdot 3.181 = 9.543 \\ \end{bmatrix}\] <p>可见 $v_0$和$v_2$属于hill，流出，而$v_1$和$v_3$属于valley，流入。</p> <p>因此，在计算物理与几何建模中，DEC把复杂问题简化成了一种线性代数的求解：</p> \[\boxed{\text{Load a mesh → Build a few matrices → Solve a linear system}}\] <p>我们已经介绍了 DEC 中的基本算子（如 $ d_0, d_1 $）以及它们之间的组合关系，并用这些离散形式构造了如 grad、curl 和 div 等经典算子。<br/> 这些离散算子能够直接作用在网格上的数值对象，比如定义在顶点、边或面上的函数。</p> <p>但现实问题往往并非一开始就是离散的，而是给定一个 <strong>连续的物理场（continuous field）</strong> 或偏微分方程模型。<br/> 为了将这些连续的数学对象转化为可计算的离散系统，并反过来从离散解中恢复对连续现象的理解，我们就需要两个核心操作：</p> \[\boxed{\text{Discretization \quad \&amp; \quad Interpolation}}\] <p>接下来，我们将介绍这两个基本操作在微分形式（differential forms）中的具体方式，以及它们是如何构建起连续与离散之间桥梁的。</p> <h3 id="discretization">Discretization</h3> <p><strong>Basic idea</strong>：所谓 Discretization（离散化），本质上就是将一个连续的 $ k $-form <strong>积分到 $ k $-simplex 上</strong>。<br/> 结果就是一个<strong>有限个数值的集合</strong>，它代表了连续物理量在离散网格上的表达。</p> <p>这种方式非常自然地将连续几何信息转换为离散数据，是 DEC 框架的基础。我们来一步步看具体的例子。</p> <h4 id="integrating-a-0-form-over-vertices">Integrating a 0-form Over Vertices</h4> <p>对 0-form（标量函数）来说，”积分” 实际上就是 <strong>直接在点上取值</strong>。<br/> 所以，如果一个 0-form 是 $ f(x, y) = x + y $，那么在顶点 $ v = (1, 2) $ 上的离散值就是： \(f(v) = 1 + 2 = 3\)</p> <p>这类操作没有方向性，只有采样。</p> <h4 id="integrating-a-1-form-over-an-edge">Integrating a 1-form Over an Edge</h4> <p>1-forms 是作用在向量上的线性函数。<br/> 要将一个 1-form $ \alpha $ 离散化到一条边 $ e $ 上，就是计算线积分： \(\boxed{ \int_e \alpha }\)</p> <h5 id="example">Example:</h5> <p>设<br/> \(\alpha := x y \, dx - x^2 \, dy\)<br/> 边从 $ p_0 = (-1, 2) $ 到 $ p_1 = (3, 1) $。</p> <p>我们可以用参数法：设 \(\vec{p}(t) = (1 - t)p_0 + t p_1 = (-1 + 4t, 2 - t), \quad t \in [0, 1]\)</p> \[x(t) = -1 + 4t\] \[y(t) = 2 - t\] <p>求导： \(\vec{p}'(t) = \frac{d\vec{p}}{dt} = (4, -1)\)</p> <p>代入 $ \alpha $ 得： \(\alpha(\vec{p}(t)) = x(t) y(t)\, dx - x(t)^2\, dy \Rightarrow \text{Evaluate on } \vec{p}'(t) = (4, -1)\)</p> <p>最终线积分是： \(\int_0^1 \left[ x(t) y(t) \cdot 4 + x(t)^2 \cdot 1 \right] dt = 7\)</p> <p>同理，我们可以用相同的方法对任意simplicial complex的edge进行积分。</p> <h4 id="integrating-a-2-form-over-a-triangle">Integrating a 2-form Over a Triangle</h4> <p>2-forms 在二维中可以理解为 <strong>密度函数</strong>，其离散化就是在三角面片上积分：</p> \[\boxed{ \int_{\text{triangle}} \omega }\] <p>比如 $ \omega = x \, dx \wedge dy $，可以通过二维区域积分在每个三角形上得到一个数值。</p> <h5 id="示例">示例</h5> <p>让我们在 $ \mathbb{R}^2 $ 空间中对一个三角形 $ T $ 进行 <strong>differential 2-form</strong> 的积分，该三角形的顶点为 $ (0,0) $、$ (1,0) $ 和 $ (0,1) $。</p> <p>由于 $ T $ 是平坦的，切空间在各处相同，由以下向量张成： \(T_1 = \frac{\partial}{\partial x}, \quad T_2 = \frac{\partial}{\partial y}.\) 在标准的 $\mathbb{R}^2$ 空间中（使用欧几里得度量），它们已经是 <strong>orthonormal</strong> 的。</p> <h6 id="步骤-1在基向量上求值-omega"><strong>步骤 1：在基向量上求值 $\omega$</strong></h6> <p>2-form $\omega$ 对切向量的作用为： \(\omega(T_1, T_2) = 3 \, (dx \wedge dy)(T_1, T_2).\) 根据 wedge product 的定义： \((dx \wedge dy)(T_1, T_2) = dx(T_1)dy(T_2) - dx(T_2)dy(T_1).\) 由于 $dx(T_1) = 1$，$dy(T_2) = 1$，且 $dx(T_2) = dy(T_1) = 0$： \(\omega(T_1, T_2) = 3 \cdot (1 \cdot 1 - 0 \cdot 0) = 3.\)</p> <h6 id="步骤-2对--t--进行标量函数积分"><strong>步骤 2：对 $ T $ 进行标量函数积分</strong></h6> <p>$\omega$ 在 $ T $ 上的积分为： \(\int_T \omega = \int_T \omega(T_1, T_2) \, dA,\) 其中 $dA$ 是面积元素。由于 $\omega(T_1, T_2) = 3$ 是常数： \(\int_T \omega = 3 \int_T dA = 3 \cdot \text{Area}(T).\) 三角形 $ T $ 的面积是 $\frac{1}{2}$，因此： \(\int_T \omega = 3 \cdot \frac{1}{2} = \boxed{\frac{3}{2}}.\)</p> <h3 id="orientation-and-integration">Orientation and Integration</h3> <p>在对 1-form 和 2-form 进行积分时，<strong>方向（orientation）至关重要</strong>：</p> <ul> <li> <p>对边来说，正向或反向会改变积分结果的符号</p> \[\alpha_{ij} = -\alpha_{ji}\] </li> <li> <p>对三角形来说，顺时针 vs 逆时针会影响 2-form 的符号</p> \[\beta_{ijk} = \beta_{jki}, \beta_{jik} = -\beta_{kij}\] </li> </ul> <p>这也是 DEC 中为什么需要为每个 simplex 明确指定 orientation 的原因。</p> <h3 id="discrete-differential-k-form">Discrete Differential $k$-Form</h3>]]></content><author><name></name></author><category term="DDG"/><category term="Geometry"/><summary type="html"><![CDATA[为什么我们需要 Discrete Exterior Calculus？]]></summary></entry></feed>