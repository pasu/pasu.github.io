<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en"><generator uri="https://jekyllrb.com/" version="4.4.1">Jekyll</generator><link href="https://pasu.github.io/feed.xml" rel="self" type="application/atom+xml" /><link href="https://pasu.github.io/" rel="alternate" type="text/html" hreflang="en" /><updated>2025-09-03T14:39:17+00:00</updated><id>https://pasu.github.io/feed.xml</id><title type="html">blank</title><subtitle>Personal website of Peter Lu
</subtitle><entry><title type="html">G³周报(0)</title><link href="https://pasu.github.io/blog/2025/G-3_1/" rel="alternate" type="text/html" title="G³周报(0)" /><published>2025-09-03T00:00:00+00:00</published><updated>2025-09-03T00:00:00+00:00</updated><id>https://pasu.github.io/blog/2025/G%5E3_1</id><content type="html" xml:base="https://pasu.github.io/blog/2025/G-3_1/"><![CDATA[<blockquote>
  <p><em>Graphics, GIS, and Beyond</em></p>

  <p><strong>欢迎来到创刊号！</strong>
$G^3$代表 Graphics、Geographic、Guowei。这是一份每周三发布的<strong>精选技术要闻摘要</strong>，涵盖图形学、GIS、编程。</p>
</blockquote>

<h2 id="advances-in-real-time-rendering-in-games"><strong>Advances in Real-Time Rendering in Games</strong></h2>

<ul>
  <li>2025年 SIGGRAPH 实时渲染课程系列发布，展示游戏领域最新渲染技术突破。</li>
  <li>涵盖光线追踪、全局光照、混合渲染管线等前沿内容。</li>
  <li>大部分讲座已公开演示幻灯片。</li>
  <li><a href="https://advances.realtimerendering.com/s2025/index.html">https://advances.realtimerendering.com/s2025/index.html</a></li>
</ul>

<hr />

<h2 id="radiometry-overview"><strong>Radiometry: Overview</strong></h2>

<ul>
  <li>辐射度量学与光度学物理量是 PBR 和渲染方程的核心。</li>
  <li>系列文章逆向推导辐通量、辐照度等基本量，避免传统极限表述，仅用积分形式。</li>
  <li>后续将扩展到光谱渲染与光度学，奠定光谱渲染的基础。</li>
  <li><a href="https://momentsingraphics.de/RadiometryOverview.html">https://momentsingraphics.de/RadiometryOverview.html</a></li>
</ul>

<hr />

<h2 id="alphaearth-foundations"><strong>AlphaEarth Foundations</strong></h2>

<ul>
  <li><strong>DeepMind 发布 AlphaEarth Foundations</strong>，为地球科学数据分析设计的 AI 基础模型。</li>
  <li>可从海量卫星图像中提取关键信息，在分类、变化检测、异常发现等任务表现出色。</li>
  <li>致力于为气候、农业、灾害应对等领域提供支持。</li>
  <li><a href="https://deepmind.google/discover/blog/alphaearth-foundations-helps-map-our-planet-in-unprecedented-detail/">https://deepmind.google/discover/blog/alphaearth-foundations-helps-map-our-planet-in-unprecedented-detail/</a></li>
</ul>

<hr />

<h2 id="auto返回类型的代价"><strong><code class="language-plaintext highlighter-rouge">auto</code>返回类型的代价</strong></h2>

<ul>
  <li>C++ 使用 <code class="language-plaintext highlighter-rouge">auto</code> 作为返回类型会增加编译器推导负担。</li>
  <li>可能导致接口与实现紧耦合，修改引发类型涟漪。</li>
  <li>建议使用显式返回类型或 C++20 概念约束。</li>
  <li><a href="https://andreasfertig.com/blog/2025/09/efficient-cpp-the-hidden-compile-time-cost-of-auto-return-types/">https://andreasfertig.com/blog/2025/09/efficient-cpp-the-hidden-compile-time-cost-of-auto-return-types/</a></li>
</ul>

<hr />

<h2 id="近期会议"><strong>近期会议</strong></h2>

<ul>
  <li>Pacific Graphics 2025 (<a href="https://pg2025.nccu.edu.tw/">https://pg2025.nccu.edu.tw/</a>)</li>
  <li>3D Geoinfo 2025 (<a href="https://www.csis.u-tokyo.ac.jp/3d_geoinfo_sdsc_2025/keynotes.html">https://www.csis.u-tokyo.ac.jp/3d_geoinfo_sdsc_2025/keynotes.html</a>)</li>
</ul>

<hr />

<h2 id="思考xr是伪需求吗"><strong>思考：XR是伪需求吗？</strong></h2>

<blockquote>
  <p>产品价值的试金石：黄赌毒。如果从这三方面都找不到价值，产品发展空间有限。从这个角度而言，XR，比如VR或AR看上去并不乐观，比如VR看片的需求并没有那么大。</p>

  <p>XR（VR/AR）似乎需求不足，但产业资本投入巨大。所以形成了强烈的对比。</p>

  <ul>
    <li>渲染：与单目屏幕差异有限，foveated rendering并不热门</li>
    <li>交互：结合视觉感知研究有趣，但不确定商业价值</li>
    <li>AI 辅助：如智能记录与分析，类似 Google Glasses，有潜力但技术生态是否成熟</li>
  </ul>

  <p><strong>XR 是伪需求吗？还是我们没找到真正价值点，或等待更好时机？</strong></p>
</blockquote>

<hr />

<p><strong>结语：</strong></p>

<blockquote>
  <p>如果你有值得分享的论文、技术或项目，请在留言区告诉我，下期$G^3$周报会挑选收录。</p>
</blockquote>]]></content><author><name></name></author><category term="G^3" /><category term="G³" /><summary type="html"><![CDATA[Graphics, GIS, and Beyond 欢迎来到创刊号！ $G^3$代表 Graphics、Geographic、Guowei。这是一份每周三发布的精选技术要闻摘要，涵盖图形学、GIS、编程。]]></summary></entry><entry><title type="html">DDG Laplace</title><link href="https://pasu.github.io/blog/2025/Laplace/" rel="alternate" type="text/html" title="DDG Laplace" /><published>2025-08-05T00:00:00+00:00</published><updated>2025-08-05T00:00:00+00:00</updated><id>https://pasu.github.io/blog/2025/Laplace</id><content type="html" xml:base="https://pasu.github.io/blog/2025/Laplace/"><![CDATA[<p>原课件来自：https://brickisland.net/ddg-web/</p>

<h2 id="laplace-beltrami">Laplace-Beltrami</h2>

<h3 id="概述">概述</h3>

<p>Laplace-Beltrami算子（简称”Laplacian”）是普通Laplacian算子向弯曲流形（curved domains）的推广，通常用大写Delta（$\Delta$）或Nabla平方（$\nabla^2$）表示。本质上是描述<strong>标量场（scalar field）强度变化率</strong>的微分算子。对于一个定义在流形上的标量函数$u$，$\Delta u$衡量的是该函数在某点处的值与周围邻域平均值的差异程度。</p>

<p>写到这里，不禁让我联想到B哥的歌词：<em>“我看见有些人和周围融合得很和谐，我看见有些人孤独得很明显。”</em> 如果把你放进这个社会的标量场中，你觉得自己与周围的$\Delta u$是正、负，亦或为零？而你希望这个社会中人与人之间的$\Delta u$又该呈现出怎样的状态呢？如何让人与人的差异既存在，又像温和平滑的插值一样自然分布，如何找到这个社会插值问题的“调和函数”，让整体和谐而不失个性呢？</p>

<p><strong>应用领域广泛</strong>：</p>
<ul>
  <li>物理模拟：描述热传导、波动等物理现象</li>
  <li>图论/网络分析：图Laplacian是网络结构研究的基础工具</li>
  <li>机器学习：在半监督学习和流形学习中发挥关键作用</li>
  <li>几何处理：曲面编辑、参数化等核心算法的基础</li>
</ul>

<p><strong>算法优势</strong>：将复杂问题转化为<strong>稀疏线性代数</strong>问题，可以利用现有高效算法和代码库快速求解。</p>

<p>Laplacian是Hessian的迹（trace），反映了函数在不同方向上的平均曲率。</p>

<h4 id="物理中的拉普拉斯从扩散到振动">物理中的拉普拉斯：从扩散到振动</h4>

<ul>
  <li>
    <p><strong>热传导方程</strong>中，拉普拉斯算子描述的是“空间不平衡”：</p>

\[\frac{\partial u}{\partial t} = \Delta u\]

    <p>表示温度会沿着拉普拉斯梯度扩散，趋向于平衡。系统在长时间演化后达到稳态，即 $\Delta u = 0$，这就是<strong>拉普拉斯方程</strong>。</p>
  </li>
  <li>
    <p><strong>波动方程</strong>则引入了时间的二阶导数：</p>

\[\frac{\partial^2 u}{\partial t^2} = \Delta u\]

    <p>此时，拉普拉斯算子提供了“回复力”，使得系统发生周期性震荡。这是一个<strong>守恒系统</strong>，能量在动能与势能之间来回转换，而不像热方程那样耗散。</p>
  </li>
</ul>

<h4 id="几何中的拉普拉斯从曲率到频率">几何中的拉普拉斯：从曲率到频率</h4>

<ul>
  <li>
    <p>在<strong>微分几何</strong>中，拉普拉斯算子用于描述曲面的曲率特性。对于一个嵌入在三维空间中的曲面，其位置函数 $f$ 满足：</p>

\[\Delta f = 2H N\]

    <p>其中 $H$ 是平均曲率，$N$ 是法向量。这表明：拉普拉斯算子作用在位置函数上会得到曲率向量，是计算几何中提取曲率信息的有效工具。</p>
  </li>
  <li>
    <p>拉普拉斯算子具有<strong>等距不变性（isometry invariance）</strong>：即使形状发生了不拉伸的弯曲（如人体模型摆出不同姿势），拉普拉斯谱保持不变。这使其成为几何形状比较与匹配的重要工具。</p>
  </li>
  <li>
    <p>在<strong>频率分解</strong>中，拉普拉斯算子的本征函数（满足 $\Delta \phi = \lambda \phi$）构成了曲面上函数空间的正交基底，类似于傅里叶变换。这些本征函数可以理解为<strong>几何频率</strong>，其对应的本征值 $\lambda$ 表示振荡强度，从而可以用于形状分析、滤波、压缩、特征提取等任务。</p>
  </li>
</ul>

<h4 id="mathbbrn-空间中的实例解析">$\mathbb{R}^n$ 空间中的实例解析</h4>

<p>在$n$维欧氏空间$\mathbb{R}^n$中，对于一个二阶可微的实值函数$u: \mathbb{R}^n \rightarrow \mathbb{R}$，其Laplacian定义为函数在各个坐标轴方向上的二阶偏导数之和：</p>

<p>$\Delta u = \sum_{i=1}^n \frac{\partial^2}{\partial x_i^2} u$,</p>

<p>特别地，在二维情况下可表示为：</p>

<p>$\Delta u (x,y)= \frac{\partial^2 u}{\partial x^2}(x,y) + \frac{\partial^2u}{\partial y^2}(x,y)$</p>

<p>考虑函数$u_1(x,y) = -x^2 - 2y^2$</p>

<p>计算过程：</p>

\[\frac{\partial u_1}{\partial x} = -2x \quad \Rightarrow \quad \frac{\partial^2 u_1}{\partial x^2} = -2\]

\[\frac{\partial u_1}{\partial y} = -4y \quad \Rightarrow \quad \frac{\partial^2 u_1}{\partial y^2} = -4\]

<p>因此：</p>

\[\Delta u_1 = \frac{\partial^2 u_1}{\partial x^2} + \frac{\partial^2 u_1}{\partial y^2} = -2 + (-4) = -6\]

<p><strong>物理意义</strong>：该结果表示在整个定义域内，函数呈现均匀的”凸起”特性（$\Delta u_1 = -6 &lt; 0$），对应向下开口的抛物面。</p>

<h4 id="图拉普拉斯算子">图拉普拉斯算子</h4>

<p>图拉普拉斯算子 $ L $ 量化图中每个顶点值与其<strong>直接邻居平均值</strong>的偏离程度。对于顶点 $ i $：</p>

\[(L\mathbf{u})_i = \underbrace{\left( \frac{1}{\deg(i)} \sum_{j \sim i} u_j \right)}_{\text{邻居平均值}} - u_i\]

<p>其中：</p>
<ul>
  <li>$ \deg(i) $ 是顶点 $ i $ 的度数（邻居数量）</li>
  <li>$ j \sim i $ 表示所有与 $ i $ 直接相连的顶点 $ j $</li>
  <li>$ u_i $ 是存储在顶点 $ i $ 上的标量值（如智力分数）</li>
</ul>

<h4 id="为什么这是二阶算子">为什么这是”二阶”算子？</h4>

<p>虽然形式上是”平均值减去中心值”，但其本质对应于连续拉普拉斯算子的离散化：</p>

<ol>
  <li>
    <p><strong>一阶导数的离散形式</strong><br />
边上的差分：</p>

    <p>\(\nabla u \big|_{(i,j)} = u_j - u_i\)
（测量相邻顶点的<strong>直接差异</strong>）</p>
  </li>
  <li>
    <p><strong>二阶导数的离散形式</strong></p>

    <p>顶点上的拉普拉斯：</p>

\[\Delta u \big|_i \approx (L\mathbf{u})_i = \text{平均值} - u_i\]

    <p>这实际上是<strong>一阶导数的散度</strong>（即梯度的梯度），因此是二阶运算 $\Delta u \approx \frac{u(x+h) + u(x-h) - 2u(x)}{h^2}$。</p>
  </li>
</ol>

<h4 id="物理解释">物理解释</h4>

<h5 id="拉普拉斯算子的统一视角">拉普拉斯算子的统一视角</h5>

<p>拉普拉斯算子（$\Delta$）在连续和离散场景下具有统一的物理本质：<strong>衡量局部偏离平均值的程度</strong>。</p>

<p><strong>数学定义</strong>：</p>

<ul>
  <li>
    <p>连续空间：</p>

\[\Delta u(x_0) \propto \lim_{\varepsilon \to 0} \frac{1}{\varepsilon^2} \left( \frac{1}{|S_\varepsilon|}\int_{S_\varepsilon} u\,dS - u(x_0) \right)\]
  </li>
  <li>
    <p>离散图论：</p>

\[(Lu)_i = \frac{1}{\deg(i)}\sum_{j\sim i} u_j - u_i\]
  </li>
</ul>

<p><strong>几何意义</strong>：</p>

<ul>
  <li>$\Delta u &gt; 0$：低于周围平均值（局部凹陷）</li>
  <li>$\Delta u &lt; 0$：高于周围平均值（局部凸起）</li>
  <li>$\Delta u = 0$：调和状态（完美平衡）</li>
</ul>

<h5 id="热方程扩散的动力学">热方程：扩散的动力学</h5>

<p>热方程描述了系统趋向平衡的过程：</p>

\[\frac{\partial u}{\partial t} = \Delta u\]

<p><strong>核心机制</strong>：</p>

<ul>
  <li><strong>凸起衰减</strong>：局部高温区（$\Delta u &lt; 0$）热量向外扩散</li>
  <li><strong>凹陷填充</strong>：局部低温区（$\Delta u &gt; 0$）吸收周围热量</li>
  <li><strong>终态收敛</strong>：所有点达到相同值（$\Delta u = 0$）</li>
</ul>

<p><strong>社交网络类比</strong>：</p>

<ul>
  <li>每个节点的值随时间调整，逐步接近邻居平均值</li>
  <li>最终整个网络达成共识（连通图情形）</li>
  <li>在社交网络的语境下，拉普拉斯算子揭示了一个深刻的群体智能平衡原理</li>
</ul>

<p>稳态热方程退化为拉普拉斯方程：</p>

\[\Delta u = 0\]

<h5 id="波动方程弹性的舞蹈">波动方程：弹性的舞蹈</h5>

<p>波动方程揭示振动传播规律：</p>

\[\frac{\partial^2 u}{\partial t^2} = \Delta u\]

<p><strong>动态平衡机制</strong>：</p>

<ul>
  <li><strong>超调恢复</strong>：高于平均的位置受向下力（$\partial_t^2 u &lt; 0$）</li>
  <li><strong>欠调提升</strong>：低于平均的位置受向上力（$\partial_t^2 u &gt; 0$）</li>
  <li><strong>能量守恒</strong>：振动能量在系统中持续转化</li>
</ul>

<h5 id="三方程的关系图示">三方程的关系图示</h5>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>热方程 ∂ₜu=Δu
  │ 长时间演化
  ▼
拉普拉斯方程 Δu=0 —— 稳态平衡解
  ▲
  │ 二阶时间扩展
波动方程 ∂ₜ²u=Δu —— 动态平衡系统
</code></pre></div></div>

<h3 id="laplacian全貌">Laplacian全貌</h3>

<p>在光滑设定中，Laplacian算子拥有多个完全等价的数学定义，这些定义揭示了其丰富的内涵，并且大多数可以直接推广到弯曲流形（Laplace-Beltrami算子）。</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">定义方式</th>
      <th style="text-align: left">数学表达式</th>
      <th style="text-align: left">直观解释</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left"><strong>局部平均偏差</strong></td>
      <td style="text-align: left">$\lim_{\varepsilon \to 0} \frac{1}{\varepsilon^2} (u - \text{mean}<em>{S</em>\varepsilon}(u))$</td>
      <td style="text-align: left">点值与无穷小邻域平均值的差异</td>
    </tr>
    <tr>
      <td style="text-align: left"><strong>偏导数和</strong></td>
      <td style="text-align: left">$\Delta u = \sum_{i=1}^n \frac{\partial^2 u}{\partial x_i^2}$</td>
      <td style="text-align: left">各坐标方向二阶变化率的和</td>
    </tr>
    <tr>
      <td style="text-align: left"><strong>Hessian迹</strong></td>
      <td style="text-align: left">$\Delta u = \operatorname{tr}(\nabla^2 u)$</td>
      <td style="text-align: left">函数在不同方向曲率的总和</td>
    </tr>
    <tr>
      <td style="text-align: left"><strong>梯度散度</strong></td>
      <td style="text-align: left">$\Delta u = \nabla \cdot \nabla u$</td>
      <td style="text-align: left">梯度场源汇强度的度量</td>
    </tr>
    <tr>
      <td style="text-align: left"><strong>外微积分</strong></td>
      <td style="text-align: left">$\Delta u = <em>d</em>d u$</td>
      <td style="text-align: left">最优雅的几何定义，适用于任意流形</td>
    </tr>
    <tr>
      <td style="text-align: left"><strong>Dirichlet能量变分</strong></td>
      <td style="text-align: left">$\Delta u = \frac{1}{2}\delta\int |\nabla u|^2 dV$</td>
      <td style="text-align: left">能量最小化的临界点条件</td>
    </tr>
    <tr>
      <td style="text-align: left"><strong>布朗运动</strong></td>
      <td style="text-align: left">$\Delta u = \left. \frac{d}{dt} \right |_{t=0} \mathbb{E}[u(X_t)]$</td>
      <td style="text-align: left">随机游走者观测值的瞬时变化</td>
    </tr>
  </tbody>
</table>

<h4 id="偏导数求和从欧氏到黎曼">偏导数求和：从欧氏到黎曼</h4>

<p><strong>欧氏空间（2D）特例</strong>：</p>

<p>在直角坐标系下，度规张量极其简单：</p>

\[g = g^{-1} = \begin{bmatrix} 1 &amp; 0 \\ 0 &amp; 1 \end{bmatrix}, \quad \det(g) = 1\]

<p>这导致Laplace-Beltrami算子退化为熟悉的形式：</p>

\[\Delta u = \frac{\partial^2 u}{\partial x^2} + \frac{\partial^2 u}{\partial y^2}\]

<p><strong>一般黎曼流形</strong>：</p>

<p>在弯曲空间中，度规张量 $g_{ij}$ 编码了局部几何：</p>

\[\Delta u=\sum_{i=1}^n{\sum_{j=1}^n{\frac{1}{\sqrt{\det\mathrm{(}g)}}\frac{\partial}{\partial x_i}\left( \sqrt{\det\mathrm{(}g)}\,\left( g^{-1} \right) _{ij}\frac{\partial}{\partial x_j}u \right)}}\]

<p>其中 $\left( g^{-1} \right) _{ij}$ 是度规张量的逆。这个定义虽然完整，但在数值计算和算法设计中：</p>

<blockquote>
  <p><strong>注意：很少作为数值方法/算法的出发点…</strong>
原因：计算复杂且依赖于局部坐标系的选取，缺乏几何不变性。</p>
</blockquote>

<h3 id="通过hessian矩阵理解laplacian">通过Hessian矩阵理解Laplacian</h3>

<h4 id="回顾hessian矩阵">回顾：Hessian矩阵</h4>

<p>在 $\mathbb{R}^n$ 中，函数 $u$ 的 <strong>Hessian矩阵</strong> $\nabla^2 u$ 是其所有二阶偏导数组成的矩阵：</p>

\[\nabla^2 u = \begin{bmatrix}
\frac{\partial^2 u}{\partial x_1^2} &amp; \cdots &amp; \frac{\partial^2 u}{\partial x_1 \partial x_n} \\
\vdots &amp; \ddots &amp; \vdots \\
\frac{\partial^2 u}{\partial x_n \partial x_1} &amp; \cdots &amp; \frac{\partial^2 u}{\partial x_n^2}
\end{bmatrix}\]

<p><strong>几何意义</strong>：Hessian矩阵提供了函数在某点附近的最佳二次逼近。对于点 $x_0$ 附近的位移 $w$，有：</p>

\[u(x_0 + w) \approx u(x_0) + \langle \nabla u(x_0), w \rangle + \frac{1}{2} \langle \nabla^2 u(x_0) w, w \rangle\]

<p>这帮助我们理解函数的局部曲率行为。</p>

<h4 id="laplacian作为hessian的迹">Laplacian作为Hessian的迹</h4>

<p>Laplacian与Hessian有一个简洁而深刻的关系：</p>

\[\Delta u = \operatorname{tr}(\nabla^2 u)\]

<p>即在欧氏空间中，Laplacian就是Hessian矩阵的<strong>迹</strong>（对角线元素之和）。</p>

<p><strong>直观理解</strong>：</p>

<ul>
  <li>Hessian矩阵的对角元素 $\frac{\partial^2 u}{\partial x_i^2}$ 衡量了函数在各坐标轴方向的曲率</li>
  <li>Laplacian将这些方向的曲率相加，得到<strong>平均曲率</strong>或<strong>总曲率</strong>的度量</li>
  <li>这与”偏离局部平均值”的解释一致：曲率越大，偏离平均的程度越大</li>
</ul>

<h4 id="3-从梯度方向导数看hessian">3. 从梯度方向导数看Hessian</h4>

<p>Hessian也可以理解为梯度的方向导数。在欧氏空间中：</p>

\[(\nabla^2 u)(X, Y) = \langle D_X \nabla u, Y \rangle\]

<p>其中 $D_X$ 是方向导数，这表示Hessian衡量的是梯度场 $\nabla u$ 在 $X$ 方向的变化在 $Y$ 方向上的分量。</p>

<h4 id="4-弯曲曲面上的推广">4. 弯曲曲面上的推广</h4>

<p>在弯曲曲面上，上述概念有相应的推广：</p>

<ol>
  <li><strong>外导数取代梯度</strong>：首先取函数的外导数$du$，这是一个1-形式</li>
  <li>
    <p><strong>协变导数得到Hessian</strong>：然后对$du$取<strong>协变导数</strong>* $\nabla$，得到Hessian：</p>

\[\nabla^2_{X,Y} u = (\nabla_X du)(Y)\]
  </li>
  <li>
    <p><strong>迹仍为Laplacian</strong>：Laplacian仍然是这个”几何Hessian”的迹：</p>

\[\Delta u = \operatorname{tr}(\nabla^2 u) = \operatorname{tr}(\nabla du)\]
  </li>
</ol>

<p>这种定义方式与具体坐标系无关，揭示了Laplacian的内在几何性质。这种通过Hessian矩阵理解Laplacian的视角，将微分算子与几何曲率直接联系起来，为理解曲面上的各种物理和几何现象提供了深刻的洞察。</p>

<h3 id="通过梯度的散度理解laplacian">通过梯度的散度理解Laplacian</h3>

<h4 id="梯度与散度的几何意义">梯度与散度的几何意义</h4>

<p><strong>梯度（Gradient）</strong>：</p>

<p>函数 $u$ 的梯度 $\nabla u$ 是一个<strong>向量场</strong>，指向函数值增长最快的方向，其大小表示增长率。几何上：</p>

<ul>
  <li>在函数<strong>极大值</strong>处，梯度场呈现<strong>汇点（Sink）</strong> 形态</li>
  <li>在函数<strong>极小值</strong>处，梯度场呈现<strong>源点（Source）</strong> 形态</li>
</ul>

<p><strong>散度（Divergence）</strong>：</p>

<p>向量场 $X$ 的散度 $\nabla \cdot X$ 是一个<strong>标量场</strong>，衡量场在某点的”源强”或”汇强”：</p>

<ul>
  <li>$\nabla \cdot X &gt; 0$：该点是源点（场从此发散）</li>
  <li>$\nabla \cdot X &lt; 0$：该点是汇点（场向此汇聚）</li>
  <li>$\nabla \cdot X = 0$：该点无源无汇（场从此平行通过）</li>
</ul>

<h4 id="laplacian作为梯度的散度">Laplacian作为梯度的散度</h4>

<p>Laplacian可以理解为梯度场的散度：</p>

\[\Delta u = \nabla \cdot (\nabla u)\]

<p><strong>物理直观</strong>：</p>

<ul>
  <li>在函数<strong>极小值</strong>附近：$\nabla u$ 向外发散（源点）→ $\nabla \cdot (\nabla u) &gt; 0$ → $\Delta u &gt; 0$</li>
  <li>在函数<strong>极大值</strong>附近：$\nabla u$ 向内汇聚（汇点）→ $\nabla \cdot (\nabla u) &lt; 0$ → $\Delta u &lt; 0$</li>
  <li>在<strong>平坦</strong>区域：$\nabla u$ 均匀通过 → $\nabla \cdot (\nabla u) = 0$ → $\Delta u = 0$</li>
</ul>

<p>这与”偏离平均值”的解释完全一致：极小值点低于周围平均值（$\Delta u &gt; 0$），极大值点高于周围平均值（$\Delta u &lt; 0$）。</p>

<p>这种”梯度-散度”的观点将Laplacian与向量微积分的基本定理联系起来，提供了理解各种物理现象（从热传导到流体力学）的统一框架，同时也为数值计算提供了坚实的基础。</p>

<h3 id="外微积分laplacian的几何本质">外微积分：Laplacian的几何本质</h3>

<p>外微积分提供了Laplace-Beltrami算子最优雅且本质的定义：</p>

\[\Delta = \star d \star d\]

<p>这一简洁公式深刻揭示了Laplacian的几何内涵：</p>

<ul>
  <li><strong>d（外导数）</strong>：捕捉流形的<strong>微分结构</strong>，与度量无关</li>
  <li><strong>*（霍奇星算子）</strong>：编码流形的<strong>度量结构</strong>，定义尺度与角度</li>
  <li><strong>组合意义</strong>：将函数信息通过微分→对偶→微分→对偶的过程，最终返回标量场</li>
</ul>

<p><strong>核心优势</strong>：</p>

<ol>
  <li><strong>坐标无关性</strong>：完全基于几何对象自身定义，不依赖任何坐标系</li>
  <li><strong>结构清晰性</strong>：完美分离了流形的微分结构（d）与度量结构（*）</li>
  <li><strong>计算友好性</strong>：为<strong>离散外微积分（DEC）</strong> 提供了直接的离散化方案，易于数值实现且保持几何性质</li>
</ol>

<p>这一定义成为了现代几何处理算法的理论基础，将抽象的微分几何概念转化为可计算的离散操作。</p>

<h3 id="随机游走laplacian的概率直觉">随机游走：Laplacian的概率直觉</h3>

<p>Laplacian与随机游走（<strong>布朗运动</strong>）有着深刻的联系，这为其提供了直观的概率论视角。一个经典的比喻是“<strong>醉汉的回家之路</strong>”。</p>

<h4 id="醉汉的随机游走与布朗运动">醉汉的随机游走与布朗运动</h4>

<p>想象一个醉汉站在路灯下（点 $x$），每一步都随机、踉跄地向任意方向迈出。他的路径 $X_t$ 就是<strong>布朗运动</strong>——时间和空间上都连续的随机游走。</p>

<p>Laplacian $\Delta$ 正是这一随机过程的<strong>无穷小生成元</strong>。它衡量的是：在醉汉出发的瞬间 ($t=0$)，观察函数 $u$（例如，他所在位置的海拔高度）的平均瞬时变化率：</p>

\[\Delta u(x) = \left. \frac{d}{dt} \right|_{t=0} \mathbb{E}[u(X_t) \mid X_0 = x].\]

<ul>
  <li>若 $\Delta u(x) &gt; 0$，意味着醉汉<strong>平均而言</strong>会踉跄到<strong>海拔更高</strong>的地方（$x$ 是“谷底”）；</li>
  <li>若 $\Delta u(x) &lt; 0$，意味着醉汉<strong>平均而言</strong>会踉跄到<strong>海拔更低</strong>的地方（$x$ 是“山顶”）；</li>
  <li>若 $\Delta u(x) = 0$，意味着醉汉向各方向漫步，<strong>平均海拔高度不变</strong>（$x$ 位于“平地”或“鞍点”）。</li>
</ul>

<h4 id="热核醉汉的到达概率">热核：醉汉的到达概率</h4>

<p><strong>热核 $k_t(x,y)$</strong> 回答了这样一个问题：“从 $x$ 出发的醉汉，在时间 $t$ 后恰好出现在 $y$ 附近的概率密度是多少？”
热核是热方程的<strong>基本解</strong>，完全描述了扩散过程。</p>

<h4 id="直观解释模糊与锐利">直观解释：模糊与锐利</h4>

<p>Laplacian衡量的是函数 $u$ 与其“模糊”版本之间的差异：
模糊过程就是让醉汉自由漫步一段时间 $t$，记录他所有可能位置的平均值：</p>

\[\Delta u \approx \frac{1}{t} \Big( \underbrace{\mathbb{E}[u(X_t)]}_{\text{模糊后的平均值}} - \underbrace{u(x)}_{\text{原始值}} \Big), \quad t \to 0.\]

<ul>
  <li>如果一个点比周围模糊后的平均值高（尖锐峰值），Laplacian为负，试图“拉低”；</li>
  <li>如果一个点比周围模糊后的平均值低（深谷），Laplacian为正，试图“填平”。</li>
</ul>

<p>这个“醉酒回家”的比喻揭示了Laplacian的本质：它是一个<strong>局部平均算子</strong>或<strong>平滑算子</strong>，驱动系统趋于均匀，其正负与大小反映了点相对于周围环境的“凸起”或“凹陷”。这种概率视角将抽象的微分算子与易于理解的随机过程连接起来，成为分析与概率论之间的桥梁。</p>

<h3 id="通过-dirichlet-能量理解-laplacian">通过 Dirichlet 能量理解 Laplacian</h3>

<ul>
  <li>最终，我们可以从 <strong>Dirichlet 能量</strong> 的角度来理解 Laplacian。</li>
  <li>Dirichlet 能量体现了函数的<strong>平滑性 / 规则性</strong>，这是几何、物理以及算法中常见的概念。</li>
  <li>这是进行离散化的自然出发点，例如 <strong>有限元方法</strong>（Finite Element Methods, FEM）。</li>
  <li>
    <p>利用 Laplacian，可以将 Dirichlet 能量表示为一个二次型（quadratic form）：</p>

\[E_D(u) = \frac{1}{2} \int |\nabla u|^2 \, dV = -\frac{1}{2} \int u \, \Delta u \, dV\]
  </li>
  <li>我们将在后续通过一个<strong>基本插值问题</strong>更仔细地研究 Dirichlet 能量的应用与含义。</li>
</ul>

<h3 id="laplacian的基本性质与谱理论">Laplacian的基本性质与谱理论</h3>

<p>Laplacian算子具有一系列深刻而优美的数学性质，这些性质不仅奠定了其理论基础，也构成了各种实际应用的核心支撑。</p>

<h4 id="基本代数性质">基本代数性质</h4>

<p><strong>核空间性质</strong>：</p>

<ul>
  <li><strong>常值函数核</strong>：任意常值函数 $c$ 满足 $\Delta c = 0$</li>
  <li><strong>线性函数核（$\mathbb{R}^n$）</strong>：线性函数 $u(x) = a\cdot x + b$ 满足 $\Delta u = 0$</li>
  <li><strong>物理意义</strong>：均匀分布和线性分布都是自然的“平衡状态”</li>
</ul>

<p><strong>不变性性质</strong>：</p>

<ul>
  <li><strong>刚体运动不变</strong>：$\Delta(u \circ \eta) = (\Delta u) \circ \eta$，$\eta$ 为刚体变换</li>
  <li>
    <p><strong>等距不变</strong>：在流形 $M$ 上，Laplace-Beltrami算子 $\Delta_g$ 在等距变换下保持不变</p>

    <ul>
      <li>若 $\eta: M \to N$ 是等距同构，则 $\Delta_g(u \circ \eta) = (\Delta_{g’} u) \circ \eta$</li>
      <li>意味着Laplacian仅依赖于流形的内在几何</li>
    </ul>
  </li>
</ul>

<h4 id="算子理论性质">算子理论性质</h4>

<p><strong>自伴性（Self-adjointness）</strong>：</p>

\[\langle \Delta u, v \rangle = \langle u, \Delta v \rangle \quad \text{对紧支撑函数 } u,v\]

<p>类似于对称矩阵 $A^T = A$，为谱分解奠定基础。</p>

<p><strong>椭圆性（Ellipticity）</strong>：</p>

<ul>
  <li>$-\langle \Delta u, u \rangle \ge 0$（半负定）</li>
  <li>二次型 $-\langle \Delta u, u \rangle$ 是凸的</li>
  <li>在适当边界条件下，方程 $\Delta u = f$ 有唯一解</li>
</ul>

<h4 id="谱理论有限维与无限维">谱理论：有限维与无限维</h4>

<p><strong>有限维类比</strong>：</p>

<p>实对称矩阵 $A$ 满足 $A^T = A$：</p>

<ul>
  <li>实特征值 $\lambda_1, \dots, \lambda_n$</li>
  <li>正交特征向量 $e_1, \dots, e_n$</li>
  <li>可对角化：$A = Q \Lambda Q^T$</li>
</ul>

<p><strong>无限维推广</strong>：</p>

<p>Laplacian作为自伴椭圆算子，在紧域上具有离散谱：</p>

<ul>
  <li><strong>实离散谱</strong>：$0 = \lambda_1 \le \lambda_2 \le \cdots \to \infty$</li>
  <li><strong>正交特征函数</strong>：$\phi_1, \phi_2, \dots$ 构成正交基</li>
  <li><strong>特征方程</strong>：$\Delta \phi_k = \lambda_k \phi_k$</li>
</ul>

<h4 id="示例与几何推广">示例与几何推广</h4>

<p><strong>圆上的傅里叶基</strong>：</p>

<p>在 $S^1 = [0,2\pi)$ 上，Laplacian $\frac{d^2}{dx^2}$ 的特征对为：</p>

<ul>
  <li>特征函数：$\cos(nx), \sin(nx)$</li>
  <li>特征值：$-n^2$
为傅里叶分析提供数学基础。</li>
</ul>

<p><strong>形状的谱几何</strong>：</p>

<p>在任意曲面 $M$ 上，Laplace-Beltrami算子的特征对 $(\lambda_k, \phi_k)$ 提供形状的频谱表示：</p>

<ul>
  <li>$\lambda_k$：反映全局几何特征</li>
  <li>$\phi_k$：描述振动模式</li>
  <li>应用：形状匹配、特征提取、几何处理</li>
</ul>

<h4 id="统一视角作为广义矩阵">统一视角：作为广义矩阵</h4>

<p>Laplacian可以被视为“半正定算子”，类比矩阵性质：</p>

<table>
  <thead>
    <tr>
      <th>矩阵性质</th>
      <th>Laplacian类比</th>
      <th>应用意义</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>对称性</td>
      <td>自伴性</td>
      <td>保证实谱和正交分解</td>
    </tr>
    <tr>
      <td>半正定性</td>
      <td>椭圆性</td>
      <td>确保方程可解性和数值稳定性</td>
    </tr>
    <tr>
      <td>核空间</td>
      <td>常值函数</td>
      <td>反映物理守恒律</td>
    </tr>
    <tr>
      <td>特征分解</td>
      <td>谱分解</td>
      <td>提供频率分析和模态分解</td>
    </tr>
  </tbody>
</table>

<h3 id="插值问题从狄利克雷原理到拉普拉斯方程">插值问题：从狄利克雷原理到拉普拉斯方程</h3>

<p>插值问题是数学与工程中的基本问题：给定区域边界上的数值，如何以“最合理”的方式填充内部区域？Laplacian算子为这一问题提供了优美而深刻的解答。</p>

<h4 id="插值问题的数学表述">插值问题的数学表述</h4>

<p>给定区域 $\Omega \subset \mathbb{R}^2$ 及边界值 $g: \partial\Omega \to \mathbb{R}$，目标是寻找函数 $u$：</p>

<ul>
  <li>
    <table>
      <tbody>
        <tr>
          <td>满足边界条件 $u</td>
          <td>_{\partial\Omega} = g$</td>
        </tr>
      </tbody>
    </table>
  </li>
  <li>在内部以“尽可能光滑”的方式进行插值</li>
</ul>

<p><strong>关键问题</strong>：如何定义“尽可能光滑”？</p>

<h4 id="光滑度的数学度量狄利克雷能量">光滑度的数学度量：狄利克雷能量</h4>

<p><strong>狄利克雷能量</strong>提供了自然的光滑度度量：</p>

\[E_D(u) := \frac{1}{2} \int_{\Omega} |\nabla u|^2 \, dA\]

<p><strong>几何与物理解释</strong>：</p>

<ul>
  <li>$E_D(u) = 0$：函数为常数（完全光滑）</li>
  <li>$E_D(u)$ 越大：函数变化越剧烈</li>
  <li>物理意义：衡量函数偏离平衡状态的程度</li>
</ul>

<p><strong>附注 1 — 为什么 $E_D$ 是凸的</strong>：</p>

<ul>
  <li>$E_D(u)$ 是函数 $u$ 的二次型积分，离散化后对应稀疏半正定矩阵（离散Laplacian）</li>
  <li>二次型的凸性保证了能量最小化问题有唯一全局解</li>
  <li>物理上可理解为“弹性膜受固定边界约束时趋向唯一平衡状态”，凸性保证没有局部陷阱</li>
</ul>

<h4 id="狄利克雷原理与拉普拉斯方程">狄利克雷原理与拉普拉斯方程</h4>

<p><strong>狄利克雷原理</strong>指出：在给定边界条件下，狄利克雷能量最小化的函数正是拉普拉斯方程的解：</p>

\[\min_{u|_{\partial\Omega} = g} E_D(u) \quad \Longleftrightarrow \quad 
\begin{cases} 
\Delta u = 0 &amp; \text{在 } \Omega \\ 
u = g &amp; \text{在 } \partial\Omega 
\end{cases}\]

<p><strong>附注 2 — 为什么极小化条件对应拉普拉斯方程</strong>：</p>

<ul>
  <li>设 $\delta u$ 为满足边界消失的扰动</li>
  <li>能量一阶变分为 $\delta E_D(u) = \int_\Omega \nabla u \cdot \nabla \delta u \, dA = -\int_\Omega (\Delta u)\, \delta u\, dA$</li>
  <li>极值条件 $\delta E_D(u)=0$ 对任意 $\delta u$ 成立 ⇒ $\Delta u=0$</li>
</ul>

<p><strong>附注 3 — Dirichlet能量插值求解的优势</strong>：</p>

<ul>
  <li><strong>凸性 + 线性</strong> → 唯一全局解，易于计算</li>
  <li><strong>自然光滑</strong> → 插值内部平滑，避免振荡</li>
  <li><strong>统一框架</strong> → 支持复杂域、曲面和图结构数据</li>
  <li><strong>物理直观</strong> → 对应平衡状态，容易理解与调试</li>
  <li><strong>稀疏结构</strong> → 离散Laplacian矩阵高效可解</li>
</ul>

<h4 id="历史注记从争议到确立">历史注记：从争议到确立</h4>

<ul>
  <li><strong>19世纪中期</strong>：Green、Dirichlet、Riemann 等自由使用该原理</li>
  <li><strong>1870年</strong>：Weierstrass 指出存在性证明漏洞，原理受质疑</li>
  <li><strong>20世纪初</strong>：Hilbert 严格证明原理的正确性，为其平反</li>
</ul>

<h4 id="几何与物理直观">几何与物理直观</h4>

<p>调和函数具有美妙的性质：</p>

<ul>
  <li><strong>平均值性质</strong>：函数值等于任意邻域的平均值</li>
  <li><strong>极值原理</strong>：最大值和最小值仅可能出现在边界</li>
  <li><strong>物理实现</strong>：皂膜实验可完美展示调和曲面</li>
</ul>

<p>这种插值方法产生的调和函数不仅数学性质优美，也具有自然的物理实现，为各类应用提供了统一理论框架。</p>

<h3 id="调和函数泊松方程及其应用">调和函数、泊松方程及其应用</h3>

<p>从狄利克雷原理自然引出调和函数的概念，并进一步推广到更一般的泊松方程，这些概念在几何和物理中有着广泛的应用。</p>

<h4 id="调和函数狄利克雷能量的最小化子">调和函数：狄利克雷能量的最小化子</h4>

<p><strong>调和函数</strong>是拉普拉斯方程的解：</p>

\[\Delta u = 0\]

<p>作为狄利克雷能量的最小化子，调和函数具有一系列优美性质：</p>

<ul>
  <li><strong>平均值性质</strong>：</li>
</ul>

\[u(x) = \frac{1}{|B_\varepsilon|}\int_{B_\varepsilon(x)} u \, dV = \frac{1}{|\partial B_\varepsilon|}\int_{\partial B_\varepsilon(x)} u \, dS\]

<p>函数在任意点的值等于其邻域内的平均值。</p>

<blockquote>
  <p><strong>直观理解</strong>：局部值完全由周围环境决定，体现了Laplacian作为局部平滑算子的本质。</p>
</blockquote>

<ul>
  <li>
    <p><strong>极值原理</strong>：</p>

    <ul>
      <li>非常数调和函数在内部区域不能取得最大或最小值</li>
      <li>极值只能出现在边界上</li>
      <li><strong>物理意义</strong>：稳态温度分布中，最热和最冷点都在边界</li>
    </ul>
  </li>
</ul>

<blockquote>
  <p>这保证了调和函数的内部不会出现“尖刺”，自然光滑。</p>
</blockquote>

<h4 id="曲面上的调和函数">曲面上的调和函数</h4>

<p>在弯曲流形上，问题类似：</p>

<ul>
  <li>使用 <strong>Laplace-Beltrami算子</strong> $\Delta_g$</li>
  <li>在区域 $A \subset M$ 上固定函数值</li>
  <li>在剩余区域 $M \setminus A$ 上求解 $\Delta_g u = 0$</li>
</ul>

<blockquote>
  <p>应用：曲面参数化、形状编辑等几何处理问题
<strong>直观理解</strong>：即使在复杂曲面上，调和函数仍提供“最平滑”的插值。</p>
</blockquote>

<h4 id="泊松方程带有源项的推广">泊松方程：带有源项的推广</h4>

<p>当系统内部存在源项时，稳态解满足泊松方程：</p>

\[\Delta u = -f\]

<ul>
  <li>$f$ 表示内部源强度（如热源、电荷密度）</li>
  <li><strong>物理来源</strong>：</li>
</ul>

\[\frac{\partial u}{\partial t} = \Delta u + f \quad \Rightarrow \quad \text{稳态时 } \Delta u = -f\]

<ul>
  <li>
    <table>
      <tbody>
        <tr>
          <td>边界条件仍为 $u</td>
          <td>_{\partial \Omega} = g$</td>
        </tr>
      </tbody>
    </table>
  </li>
</ul>

<blockquote>
  <p>这推广了调和函数的概念，从“无源平滑”扩展到“带源平滑”。</p>
</blockquote>

<h4 id="格林函数点源的基本解">格林函数：点源的基本解</h4>

<p>对于点源（狄拉克 δ 函数），泊松方程的解称为 <strong>格林函数</strong>：</p>

\[\Delta G(x,y) = -\delta(x-y)\]

<ul>
  <li><strong>线性叠加原理</strong>：由于方程线性，任意源分布的解可通过格林函数卷积得到：</li>
</ul>

\[u(x) = \int_\Omega G(x,y) f(y) \, dy\]

<blockquote>
  <p><strong>直观理解</strong>：求解线性PDE等价于把每个点源的影响叠加起来。</p>
</blockquote>

<h4 id="5-变分视角向量场的积分">5. 变分视角：向量场的积分</h4>

<p>泊松方程也自然出现在能量最小化问题中：</p>

\[\min_u \int_M |\nabla u - X|^2 \, dV\]

<ul>
  <li>给定向量场 $X$，寻找标量势 $u$ 使得梯度尽可能接近 $X$</li>
  <li><strong>欧拉-拉格朗日方程</strong>：</li>
</ul>

\[\Delta u = \nabla \cdot X\]

<blockquote>
  <p><strong>直观理解</strong>：泊松方程保证恢复的标量势“最平滑”地匹配给定向量场。
<strong>核心思想</strong>：调和函数和泊松方程都是“最平滑的插值或势函数”，无论在无源还是带源情况下，都由局部Laplacian条件决定全局解。</p>
</blockquote>

<h3 id="边界条件解的存在性与唯一性">边界条件：解的存在性与唯一性</h3>

<p>边界条件不仅决定偏微分方程的解，甚至决定解是否存在。选择不恰当的边界条件会导致问题无解或解不唯一。</p>

<h4 id="边界条件的类型">边界条件的类型</h4>

<p>求解域 $\Omega$ 的边界 $\partial\Omega$ 上，可施加三类经典边界条件：</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">类型</th>
      <th style="text-align: left">数学形式</th>
      <th style="text-align: left">物理意义</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left"><strong>狄利克雷 (Dirichlet)</strong></td>
      <td style="text-align: left">$u = g$</td>
      <td style="text-align: left">固定边界值（如恒定温度、电势）</td>
    </tr>
    <tr>
      <td style="text-align: left"><strong>诺伊曼 (Neumann)</strong></td>
      <td style="text-align: left">$\frac{\partial u}{\partial n} = h$</td>
      <td style="text-align: left">固定法向导数（如热流、电场通量）</td>
    </tr>
    <tr>
      <td style="text-align: left"><strong>Robin / 混合</strong></td>
      <td style="text-align: left">$a u + b \frac{\partial u}{\partial n} = c$</td>
      <td style="text-align: left">混合条件（如与外界的热交换）</td>
    </tr>
  </tbody>
</table>

<blockquote>
  <p><strong>说明</strong>：不同类型的边界条件对应不同的物理约束，对解的存在性和唯一性有直接影响。</p>
</blockquote>

<h4 id="一维直观理解">一维直观理解</h4>

<p><strong>狄利克雷条件</strong>：</p>

<p>在区间 $[0,1]$ 上解 $\frac{d^2u}{dx^2} = 0$，给定 $u(0)=u_0$、$u(1)=u_1$。</p>

<ul>
  <li><strong>解</strong>：总是存在唯一解 $u(x) = (u_1 - u_0)x + u_0$。</li>
  <li><strong>结论</strong>：总是可解。</li>
</ul>

<p><strong>诺伊曼条件</strong>：</p>

<p>给定 $\frac{du}{dx}(0) = v_0$、$\frac{du}{dx}(1) = v_1$。</p>

<ul>
  <li><strong>问题</strong>：直线斜率是常数，若 $v_0 \neq v_1$ 无法同时满足。</li>
  <li><strong>结论</strong>：解存在性受限（仅当 $v_0 = v_1$ 时存在），且解不唯一（可加常数）。</li>
</ul>

<blockquote>
  <p><strong>直观理解</strong>：诺伊曼条件约束的是流量或梯度，过多或不匹配的约束会导致系统无解或多解。</p>
</blockquote>

<h4 id="二维及高维情况">二维及高维情况</h4>

<p><strong>狄利克雷条件</strong> ($u = g$ on $\partial\Omega$)：</p>

<ul>
  <li>合理边界条件下，拉普拉斯方程 $\Delta u = 0$ <strong>存在唯一解</strong>。</li>
  <li><strong>物理直观</strong>：边界恒温，内部最终达到唯一稳态温度分布。</li>
</ul>

<p><strong>诺伊曼条件</strong> ($\frac{\partial u}{\partial n} = h$ on $\partial\Omega$)：</p>

<ul>
  <li>应用散度定理：</li>
</ul>

\[\int_\Omega \Delta u \, dA = \int_\Omega \nabla \cdot \nabla u \, dA = \int_{\partial\Omega} \frac{\partial u}{\partial n} \, dS\]

<ul>
  <li>因 $\Delta u = 0$，必须有</li>
</ul>

\[\int_{\partial\Omega} h \, dS = 0\]

<ul>
  <li><strong>结论</strong>：诺伊曼数据必须满足“净流量为零”条件，否则无解；即使存在，解也可加任意常数。</li>
</ul>

<blockquote>
  <p><strong>物理解释</strong>：稳态时，内部源或流必须平衡，边界净通量不为零会导致系统无法稳定。</p>
</blockquote>

<h4 id="关键启示">关键启示</h4>

<ol>
  <li><strong>边界条件必须与 PDE 内在结构相容</strong>：诺伊曼条件的可积性条件就是典型例子。</li>
  <li>
    <p><strong>决定解的性质</strong>：</p>

    <ul>
      <li>Dirichlet → 唯一解</li>
      <li>Neumann → 解唯一性仅 up to 常数</li>
    </ul>
  </li>
  <li><strong>数值计算中不可忽视</strong>：边界处理不当是模拟误差、体积膨胀或收缩的常见原因。</li>
</ol>

<h3 id="总结">总结</h3>

<p>Laplace-Beltrami算子是经典Laplacian在弯曲流形上的推广，连接了数学、物理与计算科学。</p>

<h4 id="核心思想">核心思想</h4>

<ul>
  <li><strong>量化局部偏离</strong>：测量一点的值与邻域平均的差异</li>
  <li><strong>驱动平衡过程</strong>：推动系统向局部平衡状态演化</li>
</ul>

<h4 id="2-多种视角">2. 多种视角</h4>

<ul>
  <li><strong>微分形式</strong>：$\Delta u = \nabla \cdot \nabla u$ 或 $\Delta u = \operatorname{tr}(\nabla^2 u)$</li>
  <li><strong>几何解释</strong>：$\Delta u \propto u - \text{局部平均}$</li>
  <li><strong>概率视角</strong>：随机游走或布朗运动的生成元</li>
  <li><strong>变分视角</strong>：狄利克雷能量的极小化子</li>
</ul>

<h4 id="3-调和函数与泊松方程">3. 调和函数与泊松方程</h4>

<ul>
  <li><strong>调和函数</strong>：$\Delta u = 0$，最小化狄利克雷能量，光滑自然</li>
  <li><strong>泊松方程</strong>：$\Delta u = -f$，带源平滑的推广</li>
  <li><strong>格林函数</strong>：点源基本解，线性叠加得到任意源的解</li>
</ul>

<h4 id="4-边界条件">4. 边界条件</h4>

<ul>
  <li><strong>Dirichlet</strong>：固定值，通常保证唯一解</li>
  <li><strong>Neumann</strong>：固定法向导数，需满足可积性条件，解可加常数</li>
</ul>

<h4 id="5-数值实现">5. 数值实现</h4>

<ul>
  <li>局部平均 → 离散外微积分（DEC）</li>
  <li>梯度-散度 → 有限体积法（FVM）</li>
  <li>能量最小化 → 有限元法（FEM）</li>
</ul>

<blockquote>
  <p><strong>总结</strong>：这个算子就像一把”瑞士军刀”，为理解和处理弯曲空间中的各种问题提供了多功能工具。</p>
</blockquote>]]></content><author><name></name></author><category term="DDG" /><category term="Geometry" /><summary type="html"><![CDATA[原课件来自：https://brickisland.net/ddg-web/]]></summary></entry><entry><title type="html">DDG Discrete Curvatures</title><link href="https://pasu.github.io/blog/2025/GIS/" rel="alternate" type="text/html" title="DDG Discrete Curvatures" /><published>2025-07-18T00:00:00+00:00</published><updated>2025-07-18T00:00:00+00:00</updated><id>https://pasu.github.io/blog/2025/GIS</id><content type="html" xml:base="https://pasu.github.io/blog/2025/GIS/"><![CDATA[<h1 id="gis是天坑专业吗">GIS是“天坑专业”吗？</h1>

<p>这是知乎上的一个问题，刚才休息时随手写一下回答，没想到越写越多，本着肥水不流外人田的原则，那就写在公众号吧。</p>

<h2 id="从cs人的角度看gis融合交叉杂而精">从CS人的角度看GIS：融合、交叉、杂而精</h2>

<p>严格来说，我不是GIS专业出身，但因工作机缘，进入GIS研发领域已有多年。本科时修过一门GIS必修课，与GIS专业的同学一起上过课。从那时起，我便开始从计算机科学（CS）的角度观察、理解这门交叉学科。</p>

<p>我一直觉得，GIS本质上是一门高度融合的学科，像那句颇具争议但耐人寻味的话说的那样：“<strong>GIS is not science</strong>”。它的研究和应用范围极其广阔：上至宇宙建模，下至一个GPS点的精准定位。从这个角度看，GIS天然具备<strong>multi-level、多尺度、多维度</strong>的特征。它可以在 zoom in 与 zoom out 的过程中，寻找与“Geo”结合的“X”，从而衍生出各种“GeoX”的研究与应用方向。</p>

<p>至于“IS”（Information System）部分，更是深深依附于计算机的发展。从操作系统、数据库、Web开发，到CPU、GPU、XR终端，再到元宇宙和AI，GIS技术就像痴情舔狗，紧跟CS技术的每一次进化。甚至可以说，哪怕是CS的“一坨屎”，GIS也能吃出花样来。</p>

<h2 id="所以gis是天坑专业吗">所以GIS是“天坑专业”吗？</h2>

<p>我不这么认为。相反，我觉得GIS是一门非常有价值、极具潜力，而且非常有趣的专业。</p>

<p>一方面，它横跨众多领域，可以做的事情非常多——“他山之石，可以攻玉”。只要找到一个自己真正感兴趣的点，就有机会无限的连接微观与宏观，成为一个最有意义的小事。</p>

<p>另一方面，GIS的很多应用都有着明确的现实价值。比如Google Maps、Google Earth等产品，成为我们日常生活不可或缺的工具。相比之下，很多游戏可能娱乐性强，但社会价值的讨论空间则要小一些。</p>

<p>就我个人而言，虽然这些年只是国家发展中的一头牛马，但至少我知道，自己是在为国家和社会做一些有意义的事。这点让我感到自豪。当然，这只是个人很主观的看法。</p>

<h2 id="cs人注重建模gis人善于想象">CS人注重建模，GIS人善于想象？</h2>

<p>从个人经验来看，CS出身的人往往注重<strong>细节与建模</strong>，无论在高层还是底层，都倾向于用方法、公式和模型将问题量化。而GIS行业的一些从业者，则更擅长<strong>宏观叙述</strong>，更鼓励“格局要大”、“只要你敢想”，具体实现自然会有人来做。你要是讨论细节，很可能被视为“下面的人”。</p>

<p>于是一个有趣的反差出现了：GIS领域有一本书叫“<strong>Modelling the World</strong>”，但真正沉下心来去建模、去实现的，往往却是CS背景的人。那些真正改变世界的GIS产品，比如Google Maps、Google Earth，其核心技术团队大多来自计算机科学领域。甚至可以说，口号喊得响的人,又有几个人读过《Modelling the World》这本书。</p>

<p>所以，GIS是不是天坑？我仍坚持认为，不是GIS的问题，而是GISer们没有把这件事真正做出来。</p>

<h2 id="为什么难做出来现实并不简单">为什么难做出来？现实并不简单</h2>

<p>这个问题让GISer来背锅，也是不公平的。</p>

<p>一方面，CS的前景与“钱景”都比GIS更加广阔，资金、人力、资源优势明显。很多人总以为，一个行业的发展要靠“大神”、“大牛”撑起来。但我更愿意从底层逻辑讲一句反话：只有行业的“人群基数”足够大，才能自然诞生出成比例的“大牛”。同理，也会有更多“SB”，Sun Boy，阳光男孩。每一个“牛人”都从天而降？其实更多的是在一个允许“试错”的行业中，成千上万个Sun Boy不断试、不断错，最终有些人成了“大牛”，有些人成了“垫脚石”。</p>

<p>另一方面，GIS对从业者的知识结构要求很高。你需要对多个领域都具备至少80%的理解，才能支撑起系统的设计与实现。而这种“平均高水平”的知识掌握，并不是智商问题，而是学习效率问题。我的一个观点是：<strong>多数人都可以通过中规中矩的努力，高效掌握一个领域的80%内容。更重要的是，效率是非线性的，越学越快。</strong></p>

<p>这样的人才，必须被聚集在一起，交流讨论，才能打造出真正优秀的GIS产品。</p>

<p>我们经常能看到游戏开发者热血分享初心，比如《星露谷物语》的作者；也能看到CS工程师分享他们的产品梦想，比如Google Maps 的幕后故事（推荐读《Never Lost Again》）。但如果我对同事说，“我们将来可以建一个太阳系、银河系的模型”，设想旅行者一号现在的位置，思考双精度是否已经不够用时，他们反问的可能是：“这能赚钱吗？”</p>

<p><strong>这是现实的压力</strong>。人有五种需求，一个行业也必须先满足最基本的“生存需求”，才谈得上“实现理想”。</p>

<h2 id="cs在上gis在上体系的认知之争">CS在上？GIS在上？体系的认知之争</h2>

<p>另一个让我印象深刻的，是GIS与CS之间在知识体系上的“认知差异”。</p>

<p>很多GIS从业者认为，CS只是GIS体系中的一部分，GIS在更高的“应用整合层”；而CS人则可能认为GIS只是CS的一个分支，比如空间数据库、开放世界、GIS是计算机众多应用中的一种何交叉。</p>

<p>这种差异，再次印证了那句话：“<strong>人心中的成见，就像一座大山，任你怎么努力也休想搬动。</strong>”</p>

<h2 id="一个不小心就干了十几年我的gis之路">一个不小心就干了十几年：我的GIS之路</h2>

<p>我本科专业是信息管理。还记得大一开学，系主任上第一门课时，问我们为什么选择这个专业。他点中了我，我当时觉得这问题就是为我量身定做的，顺口回答：“我来自山东，学校的计算机专业在我们省没招生，所以选了信息管理，因为课程重叠很多。”当时我没察觉到老师尴尬而不是礼貌的微笑。更有趣的是，毕业那年 2006，学校觉得管理学更洋气一些，把我们这个学科分到了管理学科而非工科，所以我本科学士服可是粉色带子的，我注定成为了时代中的一枚黑粉，BP in your area~</p>

<p>毕业后，我进入了超图，误打误撞的进入了GIS领域。当时公司还在中科院地理所办公。找到工作后，舅舅让我拍张公司大楼照片发他，我拍了地理所的楼，但“战术性”地避开了那几个字。他看完后说：“嗯，是家大公司。”没想到，这一干就是十多年。</p>

<p>现在，我的重心更多放在计算机技术与研究上，但也持续关注GIS领域的动态。</p>

<p>所以，我个人认为，<strong>以计算机为基础，去解决GIS中的实际问题</strong>，是一件非常有意义且对我而言有趣的事情。</p>]]></content><author><name></name></author><category term="DDG" /><category term="Geometry" /><summary type="html"><![CDATA[GIS是“天坑专业”吗？]]></summary></entry><entry><title type="html">DDG Discrete Curvatures</title><link href="https://pasu.github.io/blog/2025/Discrete_Curvatures/" rel="alternate" type="text/html" title="DDG Discrete Curvatures" /><published>2025-07-12T00:00:00+00:00</published><updated>2025-07-12T00:00:00+00:00</updated><id>https://pasu.github.io/blog/2025/Discrete_Curvatures</id><content type="html" xml:base="https://pasu.github.io/blog/2025/Discrete_Curvatures/"><![CDATA[<p>原课件来自：https://brickisland.net/ddg-web/</p>

<h2 id="discrete-curvature">Discrete Curvature</h2>

<p>上一节中，平滑的曲面曲率有多种表达形式：</p>

<ul>
  <li><strong>高斯曲率（Gauss Curvature）</strong>：$K = k_1 k_2$</li>
  <li><strong>平均曲率（Mean Curvature）</strong>：$H = (k_1 + k_2)/2$</li>
  <li><strong>主曲率（Principal Curvatures）</strong>： k_1, k_2（最大/最小曲率）</li>
  <li><strong>法曲率（Normal Curvature）</strong></li>
  <li><strong>测地曲率（Geodesic Curvature）</strong></li>
</ul>

<p>因此，光滑曲率的离散化看似有无数种不相关的方法，实际上存在统一框架可以解释大多数常见离散化选择。</p>

<h3 id="统一视角unified-picture">统一视角（Unified Picture）</h3>

<p>通过将光滑曲面与离散曲面建立联系，我们可以在统一的框架下理解许多散见于文献中的不同离散曲率定义。这样不仅有助于从微分几何的连续视角解释常用的离散曲率（如角缺陷(Angle Defect)、高斯曲率、平均曲率的边长度加权和等），还可以揭示它们与光滑情形中体积、面积及其变分的深刻对应关系，从而为几何处理、数值模拟和计算机图形学中的曲率计算提供更直观和理论一致的基础。</p>

<h3 id="discrete-gaussian-curvature">Discrete Gaussian Curvature</h3>

<h4 id="欧拉示性数-euler-characteristic">欧拉示性数 (Euler Characteristic)</h4>

<p>对于多面体曲面（Polyhedral Surface），欧拉示性数定义为：</p>

\[\chi = V - E + F\]

<p>其中：</p>

<ul>
  <li>$ V $：顶点数（Vertices）</li>
  <li>$ E $：边数（Edges）</li>
  <li>$ F $：面数（Faces）</li>
</ul>

<p><strong>示例</strong>：</p>
<ul>
  <li><strong>球面（Sphere）</strong>：$\chi = 2$（如立方体：8顶点、12边、6面 → 8-12+6=2）</li>
  <li><strong>环面（Torus）</strong>：$\chi = 0$（如四边形环面：16顶点、32边、16面 → 16-32+16=0）</li>
  <li><strong>双环面（Genus-2 Surface）</strong>：$\chi = -2$（推广公式：$\chi = 2 - 2g$，$g$为亏格）</li>
</ul>

<h4 id="topological-invariance">Topological Invariance</h4>

<p><strong>定理（L’Huilier）</strong>：</p>

<p>欧拉示性数是多面体曲面的<strong>拓扑不变量</strong>，即：</p>

<ul>
  <li>与顶点的具体位置无关</li>
  <li>与曲面的细分方式（Tessellation）无关<br />
仅由曲面的<strong>拓扑类型（Topology）</strong>决定。</li>
</ul>

\[\chi = 2 - 2g\]

<p>其中 $ g $ 是曲面的Genus（即“洞”的数量）, $\chi$是欧拉示性数。</p>

<p>例如：</p>

<ul>
  <li>球面（$g=0$）：$\chi = 2$</li>
  <li>环面（$g=1$）：$\chi = 0$</li>
  <li>双环面（$g=2$）：$\chi = -2$</li>
</ul>

<h4 id="angle-defect">Angle Defect</h4>

<p>对于离散曲面（如三角网格）的顶点 $ i $，其角度缺损定义为：</p>

\[\Omega_i = 2\pi - \sum_{ijk \in \text{St}(i)} \theta_i^{jk}\]

<p>其中：</p>

<ul>
  <li>$ \theta_i^{jk} $ 是顶点 $ i $ 在相邻三角形 $ ijk $ 中的内角，</li>
  <li>$ \text{St}(i) $ 表示顶点 $ i $ 的邻域（Star）。</li>
</ul>

<p>通过<strong>测地球（Geodesic Ball）</strong>的面积比较，离散高斯曲率 $ K_i $ 与角度缺损直接相关：</p>

<p><strong>(1) 连续曲面的高斯曲率</strong></p>

<p>在光滑曲面中，半径为 $ \epsilon $ 的测地球面积与平面圆面积 $ \pi \epsilon^2 $ 的偏差反映高斯曲率：</p>

\[|B_g(\epsilon)| = \pi \epsilon^2 \left( 1 - \frac{K}{12} \epsilon^2 + O(\epsilon^3) \right)\]

<p><strong>(2) 离散曲面的测地球面积</strong></p>

<p>对于离散曲面：</p>

<ul>
  <li>
    <table>
      <tbody>
        <tr>
          <td><strong>欧几里得圆面积</strong>：$</td>
          <td>B_{\mathbb{R}^2}(\epsilon)</td>
          <td>= \pi \epsilon^2 $。</td>
        </tr>
      </tbody>
    </table>
  </li>
  <li>
    <p><strong>测地楔形面积</strong>（Geodesic Wedge）：顶点 $ i $ 的贡献为：</p>

\[W_i(\epsilon) = \frac{\theta_i}{2\pi} \cdot \pi \epsilon^2 = \frac{1}{2} \epsilon^2 \theta_i\]

    <p>其中 $ \theta_i $ 是顶点邻域的总角度。</p>
  </li>
  <li>
    <p><strong>总测地球面积</strong>：</p>

\[|B_g(\epsilon)| = \sum_i W_i(\epsilon) = \frac{\epsilon^2}{2} \sum_i \theta_i\]
  </li>
</ul>

<p><strong>(3) 曲率与角度缺损的关系</strong></p>

<p>对比连续与离散的面积公式：</p>

\[\frac{\epsilon^2}{12} K_i \approx 1 - \frac{\sum_i \theta_i}{2\pi}\]

<p>整理后得到：</p>

\[\Omega_i = 2\pi - \sum_i \theta_i = \frac{\pi}{6} \epsilon^2 K_i\]

<p>可以把角缺陷看作一种积分曲率：它不是在一点上给出曲率的瞬时值，而是将曲率在顶点周围的小邻域上积分后的结果。这样角缺陷就自然对应于光滑曲面上的高斯曲率积分（即Gauss-Bonnet定理中的项），为离散几何提供了与连续曲率概念一致的几何直觉。</p>

<h4 id="边界曲率的离散化">边界曲率的离散化</h4>

<p><strong>边界顶点特性</strong>：</p>

<ol>
  <li><strong>高斯曲率为零</strong>：<br />
边界邻域可展平到平面（无角度缺损，$ \Omega_i = 0 $）。</li>
  <li>
    <p><strong>测地曲率（Geodesic Curvature）</strong>：<br />
通过边界顶点的<strong>外角缺损</strong>定义：</p>

\[\kappa_i = \pi - \sum_{ijk \in \text{Boundary}} \theta_i^{jk}\]

    <p><strong>物理意义</strong>：度量边界“弯曲程度”（如直边 $ \kappa_i = 0 $）。</p>
  </li>
</ol>

<p><strong>离散高斯-博内定理（带边界）</strong>：</p>

\[\sum_{i \in \text{Interior}} \Omega_i + \sum_{i \in \text{Boundary}} \kappa_i = 2\pi \chi\]

<p><strong>高斯曲率的近似方法对比</strong></p>

<table>
  <thead>
    <tr>
      <th><strong>方法</strong></th>
      <th><strong>优点</strong></th>
      <th><strong>缺点</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>角度缺损法</strong></td>
      <td>严格满足离散高斯-博内定理</td>
      <td>仅对特定顶点价数（4或6）收敛到连续曲率</td>
    </tr>
    <tr>
      <td><strong>二次曲面拟合</strong></td>
      <td>更接近光滑曲率定义</td>
      <td>不保证全局拓扑性质（如高斯-博内定理）</td>
    </tr>
    <tr>
      <td><strong>基于Mollification</strong></td>
      <td>物理直观（如Steiner公式）</td>
      <td>计算复杂</td>
    </tr>
  </tbody>
</table>

<ul>
  <li><strong>无统一最优方法</strong>，需根据应用选择（如拓扑分析优先角度缺损法，几何建模可选拟合方法）。</li>
  <li><strong>角度缺损法</strong>因保留拓扑性质，在理论推导中更受青睐。</li>
</ul>

<h3 id="curvature-normals">Curvature Normals</h3>

<p><strong>三种基本曲率法向量</strong></p>

<p>在微分几何中，曲面的几何信息可通过以下三种2-形式（2-forms）自然表达：</p>

<table>
  <thead>
    <tr>
      <th><strong>类型</strong></th>
      <th><strong>光滑形式</strong></th>
      <th><strong>离散形式</strong></th>
      <th><strong>物理意义</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>面积法向量</strong></td>
      <td>$ \frac{1}{2} df \wedge df = N \, dA $</td>
      <td>$ \frac{1}{6} \sum_{ijk} f_j \times f_k $ （顶点邻域叉积和）</td>
      <td>曲面的定向面积</td>
    </tr>
    <tr>
      <td><strong>平均曲率法向量</strong></td>
      <td>$ \frac{1}{2} df \wedge dN = HN \, dA $</td>
      <td>$ \frac{1}{2} \sum_{ij} (\cot \alpha_{ij} + \cot \beta_{ij})(f_i - f_j) $</td>
      <td>曲面的平均弯曲程度</td>
    </tr>
    <tr>
      <td><strong>高斯曲率法向量</strong></td>
      <td>$ \frac{1}{2} dN \wedge dN = KN \, dA $</td>
      <td>$ \frac{1}{2} \sum_{ij} \frac{\varphi_{ij}}{\ell_{ij}} (f_j - f_i) $</td>
      <td>曲面的内在曲率（如“尖峰”或“鞍部”）</td>
    </tr>
  </tbody>
</table>

<p><strong>主曲率方向（Principal Directions）</strong></p>

<ul>
  <li><strong>定义</strong>：主方向 $ X_1, X_2 $ 是曲面上弯曲最大和最小的方向，对应主曲率 $ \kappa_1, \kappa_2 $。</li>
  <li>
    <p><strong>关键关系</strong>：法向量的微分与曲面微分通过<strong>Weingarten方程</strong>关联：</p>

\[dN(X_i) = -\kappa_i \, df(X_i)\]

    <p>这一关系是推导曲率法向量的核心。</p>
  </li>
</ul>

<p><strong>面积法向量的推导</strong></p>

\[df \wedge df(X_1, X_2) = df(X_1) \times df(X_2) - df(X_2) \times df(X_1) = 2 \, df(X_1) \times df(X_2) = 2N dA\]

<p><strong>平均曲率法向量的推导</strong>
\(\begin{align*}
df \wedge dN(X_1, X_2) &amp;= df(X_1) \times dN(X_2) - df(X_2) \times dN(X_1) \\
&amp;= -\kappa_2 df(X_1) \times df(X_2) + \kappa_1 df(X_2) \times df(X_1) \\
&amp;= (\kappa_1 + \kappa_2) \, df(X_1) \times df(X_2) \\
&amp;= 2H \, N \, dA(X_1, X_2)
\end{align*}\)</p>

<p><strong>高斯曲率法向量的推导</strong></p>

\[\begin{align*}
dN \wedge dN(X_1, X_2) &amp;= dN(X_1) \times dN(X_2) - dN(X_2) \times dN(X_1) \\
&amp;= \kappa_1 \kappa_2 \, df(X_1) \times df(X_2) - \kappa_2 \kappa_1 \, df(X_2) \times df(X_1) \\
&amp;= 2K \, N \, dA(X_1, X_2)
\end{align*}\]

<h4 id="离散化的实现">离散化的实现</h4>

<p><strong>面积法向量（离散）</strong></p>

<p>对顶点 $ i $ 的邻域面求和：</p>

\[N_i = \frac{1}{6} \sum_{ijk \in \text{St}(i)} f_j \times f_k\]

<p><strong>平均曲率法向量（离散）</strong></p>

<p>通过 <strong>cotangent公式</strong>：</p>

\[(HN)_i = \frac{1}{2} \sum_{ij \in E} (\cot \alpha_{ij} + \cot \beta_{ij})(f_i - f_j)\]

<ul>
  <li><strong>推导依据</strong>：
    <ul>
      <li>积分 $ HN $ 对偶单元时，cotangent权重来自对偶边与原始边的长度比。</li>
      <li>与Laplace-Beltrami算子 $ \Delta f = 2HN $ 的离散化一致。</li>
    </ul>
  </li>
</ul>

<p><strong>高斯曲率法向量（离散）</strong></p>

<p>假设法向量沿边在单位球面上弧线运动：</p>

\[(KN)_i = \frac{1}{2} \sum_{ij \in E} \frac{\varphi_{ij}}{\ell_{ij}} (f_j - f_i)\]

<ul>
  <li><strong>关键区别</strong>：
    <ul>
      <li>法向量 $ N $ 的非线性变化由二面角 $ \varphi_{ij} $ 描述。</li>
      <li>边长 $ \ell_{ij} $ 归一化保证尺度不变性。</li>
    </ul>
  </li>
</ul>

<h3 id="steiners-formula">Steiner’s Formula</h3>

<p>对于多面体（离散曲面），直接求导得到的曲率要么为零（平面上），要么无定义（顶点/边处）。</p>

<p><strong>Steiner方法</strong>通过以下步骤定义离散曲率：</p>

<ol>
  <li><strong>平滑化（Mollification）</strong>：<br />
将多面体与半径为 $ \varepsilon $ 的球 $ B_\varepsilon $ 做 <strong>Minkowski求和</strong>（即 $ P + B_\varepsilon $），得到一个光滑逼近的曲面。</li>
  <li><strong>极限分析</strong>：<br />
计算平滑后曲面的曲率，并取 $ \varepsilon \to 0 $ 的极限，提取离散曲率的合理定义。</li>
</ol>

<p><strong>Minkowski求和与体积增长</strong></p>

<p>对于凸体 $ A \subset \mathbb{R}^n $，其Minkowski求和的体积可表示为 $ \varepsilon $ 的多项式（<strong>Steiner公式</strong>）：</p>

\[\text{Vol}(A + B_\varepsilon) = V_0 + \varepsilon \Phi_1 + \varepsilon^2 \Phi_2 + \cdots + \varepsilon^n \Phi_n\]

<ul>
  <li>
    <p><strong>系数 $ \Phi_k $</strong>：称为 <strong>quermassintegrals</strong>，描述不同维度（面、边、顶点）对体积增长的贡献。</p>
  </li>
  <li>
    <p><strong>与曲率的关系</strong>：</p>
    <ul>
      <li>$ \Phi_1 $：表面积（零阶曲率）。</li>
      <li>$ \Phi_2 $：总平均曲率。</li>
      <li>$ \Phi_3 $：总高斯曲率（三维时为 $ 4\pi $ 的倍数）。</li>
    </ul>
  </li>
</ul>

<p><strong>多面体的Steiner多项式（三维）</strong></p>

<p>对多面体 $ P $，平滑后的体积增长分解为：</p>

\[\text{Vol}(P + B_\varepsilon) = V_0 + \varepsilon A + \frac{1}{2} \varepsilon^2 \sum_{\text{edges } ij} \ell_{ij} \varphi_{ij} + \frac{1}{3} \varepsilon^3 \sum_{\text{vertices } i} \Omega_i\]

<ul>
  <li>
    <p><strong>各项意义</strong>：</p>

    <table>
      <thead>
        <tr>
          <th><strong>项</strong></th>
          <th><strong>几何贡献</strong></th>
          <th><strong>对应曲率</strong></th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>$ \varepsilon A $</td>
          <td>面的“平板”体积（厚度 $ \varepsilon $）</td>
          <td>面积（零阶曲率）</td>
        </tr>
        <tr>
          <td>$ \varepsilon^2 $</td>
          <td>边的“圆柱楔”体积（$ \ell_{ij} \varphi_{ij} $）</td>
          <td>平均曲率（边弯曲）</td>
        </tr>
        <tr>
          <td>$ \varepsilon^3 $</td>
          <td>顶点的“球锥”体积（$ \Omega_i $）</td>
          <td>高斯曲率（顶点缺陷）</td>
        </tr>
      </tbody>
    </table>
  </li>
</ul>

<p><strong>非凸多面体</strong>：公式依然成立，但需注意符号（如二面角 $ \varphi_{ij} $ 可能为负）。</p>

<p><strong>曲率提取与几何意义</strong></p>

<p>通过对体积多项式的微分得到曲率：</p>

\[\begin{align*}
\text{Area}_\varepsilon &amp;= \frac{d}{d\varepsilon} \text{Vol}_\varepsilon = A + \varepsilon \sum \ell_{ij} \varphi_{ij} + \varepsilon^2 \sum \Omega_i, \\
\text{Mean Curvature}_\varepsilon &amp;= \frac{1}{2} \frac{d}{d\varepsilon} \text{Area}_\varepsilon = \frac{1}{2} \sum \ell_{ij} \varphi_{ij} + \varepsilon \sum \Omega_i, \\
\text{Gauss Curvature}_\varepsilon &amp;= \frac{d}{d\varepsilon} \text{Mean Curvature}_\varepsilon = \sum \Omega_i.
\end{align*}\]

<ul>
  <li><strong>当 $ \varepsilon \to 0 $</strong>：
    <ul>
      <li><strong>总平均曲率</strong>：$ \frac{1}{2} \sum \ell_{ij} \varphi_{ij} $（边贡献）。</li>
      <li><strong>总高斯曲率</strong>：$ \sum \Omega_i $（顶点角度缺损）。</li>
    </ul>
  </li>
</ul>

<p><strong>曲面上的Steiner公式</strong></p>

<p>对光滑曲面 $ f: M \to \mathbb{R}^3 $，沿法向偏移 $ f_t = f + tN $ 时，面积变化为：</p>

\[dA_t = (1 + 2tH + t^2 K) \, dA_0\]

<ul>
  <li><strong>几何解释</strong>：
    <ul>
      <li>$ df \wedge df $：原始面积。</li>
      <li>$ df \wedge dN $：平均曲率（“混合面积”）。</li>
      <li>$ dN \wedge dN $：高斯曲率（球面像面积）。</li>
    </ul>
  </li>
</ul>

<h3 id="几何微分的基本原理">几何微分的基本原理</h3>

<ol>
  <li><strong>方向</strong>：确定使几何量变化最快的移动方向</li>
  <li><strong>大小</strong>：计算在该方向上变化的速率</li>
  <li><strong>合成</strong>：将方向与大小结合得到梯度向量</li>
</ol>

<p>这种方法避免了繁琐的偏导数计算，直接利用几何直观解决问题。</p>

<h4 id="角度导数的几何推导">角度导数的几何推导</h4>

<p>计算两点(b,a)和(c,a)之间夹角θ关于点a坐标的梯度：</p>

<ol>
  <li><strong>方向</strong>：垂直于ab连线（这是改变角度最有效的方向）</li>
  <li>
    <table>
      <tbody>
        <tr>
          <td><strong>大小</strong>：1/</td>
          <td>b-a</td>
          <td>（源自圆周运动的角度变化率）</td>
        </tr>
      </tbody>
    </table>
  </li>
  <li>
    <table>
      <tbody>
        <tr>
          <td><strong>合成</strong>：∇ₐθ = J(b-a)/</td>
          <td>b-a</td>
          <td>²，其中J是90度旋转矩阵</td>
        </tr>
      </tbody>
    </table>
  </li>
</ol>

<h4 id="微分策略比较">微分策略比较</h4>

<table>
  <thead>
    <tr>
      <th>方法</th>
      <th>优点</th>
      <th>缺点</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>闭式微分</td>
      <td>快速准确</td>
      <td>耗时，难以修改</td>
    </tr>
    <tr>
      <td>自动微分</td>
      <td>准确高效</td>
      <td>需要修改代码</td>
    </tr>
    <tr>
      <td>数值微分</td>
      <td>直接可用</td>
      <td>不精确，成本高</td>
    </tr>
    <tr>
      <td>符号微分</td>
      <td>精确</td>
      <td>表达式可能过于复杂</td>
    </tr>
  </tbody>
</table>

<p>几何微分融合了闭式微分的效率与几何直观性，是处理几何问题的理想选择。</p>

<h3 id="curvature-variations">Curvature Variations</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>体积 -&gt; 面积 -&gt; 平均曲率 -&gt; 高斯曲率 -&gt; 0
</code></pre></div></div>

<h4 id="离散体积的梯度">离散体积的梯度</h4>

<p>对于离散曲面网格，顶点i处的<strong>体积梯度</strong>可表示为：</p>

\[\nabla_i V = \frac{1}{6} \sum (f_j \times f_k) = N_i A_i\]

<p>这个等式建立了三个关键几何量的联系：</p>

<ol>
  <li><strong>体积变化率</strong>（左项）：顶点移动时包围体积的变化</li>
  <li><strong>向量面积</strong>（中项）：通过相邻三角形边界的叉积和</li>
  <li><strong>法向量积分</strong>（右项）：顶点邻域的法向量面积分</li>
</ol>

<p>当移动一个顶点时，体积变化主要来自相邻四面体的体积变化,这是离散版本的$\delta V = N \mathrm{d}A$</p>

<h4 id="离散面积的梯度">离散面积的梯度</h4>

<p>对于离散曲面，顶点 $i$ 的<strong>面积梯度</strong>可以用两种互补的形式表示：</p>

\[\nabla_i A 
= \sum_{\triangle} \frac{1}{2} N_i \times e_i 
= \frac{1}{2} \sum_{j \in \mathcal{N}(i)} (\cot \alpha_{ij} + \cot \beta_{ij})(f_i - f_j)\]

<p>其中，第一个求和遍历以 $i$ 为顶点的三角形，第二个求和遍历与顶点 $i$ 相邻的边。</p>

<p><strong>单个三角形的面积梯度：</strong></p>

<ul>
  <li>若移动顶点 $p$，其引起的面积变化率为</li>
</ul>

\[\nabla_p A = \frac{1}{2} N \times e\]

<ul>
  <li>方向垂直于对边 $e$ 和三角形法向 $N$，即沿高度方向。</li>
  <li>
    <table>
      <tbody>
        <tr>
          <td>大小与对边长度成正比（因为 $A = \frac{1}{2}</td>
          <td>e</td>
          <td>h$）。</td>
        </tr>
      </tbody>
    </table>
  </li>
</ul>

<p><strong>整体曲面的面积梯度：</strong></p>

<ul>
  <li>是相邻三角形梯度的线性叠加。</li>
  <li>可以简洁地重写为边权重形式，权重为 $\cot \alpha + \cot \beta$。</li>
  <li>这些余切权重不仅压缩了几何信息，还编码了局部曲率特征。</li>
</ul>

<h5 id="曲率与变分的几何联系">曲率与变分的几何联系</h5>

<ul>
  <li>这样我们在离散中完美复现了光滑几何中的关系 $\delta A = HN$。</li>
  <li>其中 $\frac{1}{2}(\cot \alpha + \cot \beta)$ 就是离散平均曲率密度。</li>
  <li>梯度方向给出了面积最速下降的“展平”方向，自然成为形变优化的驱动场。</li>
</ul>

<h4 id="离散平均曲率的梯度">离散平均曲率的梯度</h4>

<p>离散曲面的<strong>总平均曲率</strong>由边积分给出：</p>

\[H_{total} = \frac{1}{2} \sum \ell_{ij} \varphi_{ij}\]

<p>其中$\ell_{ij}$为边长，$\varphi_{ij}$为二面角。</p>

<h5 id="schläfli公式的深刻内涵与应用">Schläfli公式的深刻内涵与应用</h5>

<p>对于$\mathbb{R}^3$中的闭多面体，在顶点任意运动下保持：</p>

\[\sum \ell_{ij} \mathrm{d} \varphi_{ij} = 0\]

<p>其中$\ell_{ij}$为边长度，$\varphi_{ij}$为对应的二面角。 因此梯度简化为纯边长度变化项。</p>

<p>对于顶点位置$ f_i $，总平均曲率的梯度为：</p>

\[\nabla_{f_i} H_{\text{total}} = \frac{1}{2} \sum_{j \in \mathcal{N}(i)} \frac{\varphi_{ij}}{\ell_{ij}} (f_i - f_j)\]

<p>其中：</p>
<ul>
  <li>$\varphi_{ij}$是边$ij$的二面角</li>
  <li>$\ell_{ij}$是边长度</li>
  <li>$\mathcal{N}(i)$表示顶点$i$的邻域</li>
</ul>

<ol>
  <li><strong>Schläfli公式</strong>：
    <ul>
      <li>原始表达式包含两项：边长变化和二面角变化</li>
      <li>根据Schläfli公式，二面角变化项相互抵消</li>
      <li>最终仅保留边长变化主导的简洁形式</li>
    </ul>
  </li>
  <li><strong>曲率流</strong>：
    <ul>
      <li>梯度方向自动指向最优曲率调节方向</li>
      <li>权重系数$\varphi_{ij}/\ell_{ij}$编码了局部曲率信息</li>
      <li>完美再现连续情形的$\delta \text{mean} = KN$关系</li>
    </ul>
  </li>
</ol>

<h4 id="离散高斯曲率的拓扑不变性">离散高斯曲率的拓扑不变性</h4>

<p>离散曲面的<strong>总高斯曲率</strong>由顶点角缺陷求和：</p>

\[K_{\text{total}} = \sum_{i} (2\pi - \sum_{jk} \theta_i^{jk})\]

<p>其中$\theta_i^{jk}$是顶点$i$处三角形$ijk$的内角。</p>

<p><strong>离散高斯-博内定理</strong></p>

<p>该定理揭示：</p>

\[K_{\text{total}} = 2\pi\chi\]

<p>其中欧拉示性数$\chi = V - E + F$是拓扑不变量。</p>

<h4 id="关键性质">关键性质</h4>

<ol>
  <li><strong>梯度为零</strong>：
    <ul>
      <li>任意顶点运动下$K_{\text{total}}$保持不变</li>
      <li>变分序列自然终止：$\delta \text{Gauss} = 0$</li>
    </ul>
  </li>
  <li><strong>几何解释</strong>：
    <ul>
      <li>局部角缺陷变化相互抵消</li>
      <li>保持整体拓扑约束不变</li>
      <li>反映曲面的内在刚性</li>
    </ul>
  </li>
</ol>

<h3 id="曲率流">曲率流</h3>

<ol>
  <li><strong>曲率计算</strong>：在每个顶点处评估曲率量（平均/H/Gauss曲率）</li>
  <li><strong>运动方向</strong>：沿法向移动顶点 $ f_i^{k+1} = f_i^k - \tau \nabla E $</li>
  <li><strong>迭代优化</strong>：重复直至收敛</li>
</ol>

<h4 id="数值实现关键">数值实现关键</h4>

<p>采用前向欧拉格式：</p>

<p>$
\frac{f_i^{k+1} - f_i^k}{τ} = - \nabla_{f_i} E(f^k)
$</p>

<p>其中梯度项自动包含曲率信息：</p>

<ul>
  <li><strong>平均曲率流</strong>：$ \nabla A = HN $</li>
  <li><strong>Willmore流</strong>：$ \nabla(H^2) = \Delta H + 2H(H^2-K)N $</li>
</ul>

<h4 id="典型应用对比">典型应用对比</h4>

<table>
  <thead>
    <tr>
      <th>流类型</th>
      <th>能量函数</th>
      <th>梯度表达式</th>
      <th>主要应用</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>平均曲率流</td>
      <td>表面积</td>
      <td>$ \frac{1}{2}∑(\cotα+\cotβ)(f_i-f_j) $</td>
      <td>表面平滑</td>
    </tr>
    <tr>
      <td>逆平均曲率流</td>
      <td>体积</td>
      <td>$ \frac{1}{6}∑(f_j×f_k) $</td>
      <td>体积膨胀</td>
    </tr>
    <tr>
      <td>Willmore流</td>
      <td>$ ∫H^2dA $</td>
      <td>包含双拉普拉斯项</td>
      <td>保特征平滑</td>
    </tr>
  </tbody>
</table>

<h4 id="willmore流的特殊处理">Willmore流的特殊处理</h4>

<ol>
  <li><strong>能量最小化</strong>：寻找$ ∫H^2dA $的临界点</li>
  <li><strong>数值挑战</strong>：需要处理四阶导数项</li>
  <li><strong>稳定技巧</strong>：
    <ul>
      <li>采用隐式时间积分</li>
      <li>添加面积约束项</li>
      <li>使用混合有限元离散化</li>
    </ul>
  </li>
</ol>

<p>这种基于曲率流的处理方法，通过几何量的自然变分实现了：</p>

<ul>
  <li>噪声表面的自适应平滑</li>
  <li>特征结构的保持</li>
  <li>拓扑优化的自动化</li>
</ul>

<h3 id="总结">总结</h3>

<p>离散微分几何通过统一的曲率框架，将连续曲面的几何特性（如高斯曲率、平均曲率）优雅地推广到离散网格，建立了基于顶点角缺陷、边二面角等几何量的离散曲率定义，并通过变分原理揭示了”体积→面积→平均曲率→高斯曲率”的层级关系，为曲面处理算法（如曲率流、网格平滑）提供了理论基础和高效实现方法，在计算机图形学、几何建模和物理仿真等领域具有重要应用价值。</p>]]></content><author><name></name></author><category term="DDG" /><category term="Geometry" /><summary type="html"><![CDATA[原课件来自：https://brickisland.net/ddg-web/]]></summary></entry><entry><title type="html">DDG Smooth Curvatures</title><link href="https://pasu.github.io/blog/2025/Smooth_Curvatures/" rel="alternate" type="text/html" title="DDG Smooth Curvatures" /><published>2025-07-05T00:00:00+00:00</published><updated>2025-07-05T00:00:00+00:00</updated><id>https://pasu.github.io/blog/2025/Smooth_Curvatures</id><content type="html" xml:base="https://pasu.github.io/blog/2025/Smooth_Curvatures/"><![CDATA[<p>原课件来自：https://brickisland.net/ddg-web/</p>

<h2 id="curvature">Curvature</h2>

<p>DDG课程里面无数次的提到了曲率，就像某剧里的经典场景一样反复出现，莉香总说”希望这是最后一次”，而我们也总以为这该是最后一次介绍曲率了。</p>

<p>曲率是描述几何形状弯曲程度的核心概念，它不仅帮助我们理解物体的形状，更在众多领域发挥着关键作用。在物理学中，曲率解释了从微观分子到宏观宇宙的运行规律；在计算机图形学中，它是三维建模和动画模拟的基础；而在宇宙学中，爱因斯坦正是通过曲率来描述时空的本质特性。</p>

<h3 id="平面曲线的曲率">平面曲线的曲率</h3>

<p>曲率（Curvature）是描述平面曲线在某一点处弯曲程度的几何量，其数学定义为：</p>

\[k(s):=&lt;N(s),\frac{\mathrm{d}}{\mathrm{d}s}T\left( s \right) &gt;
\\
=&lt;N(s),\frac{\mathrm{d}^2}{\mathrm{d}s^2}\gamma \left( s \right) &gt;\]

<p><strong>等价定义</strong></p>

<p>若曲线以角度 $ \theta(s) $ 表示切向量的倾斜角，则曲率也可表示为：</p>

\[\kappa(s) = \frac{\mathrm{d}\theta}{\mathrm{d}s}\]

<p>即“单位弧长内角度的变化率”。</p>

<h3 id="frenet-serret-equation">Frenet-Serret equation</h3>

<p>《DDG (13): Smooth Curves》介绍过的Frenet-Serret：曲率$\kappa$ 和挠率 $\tau$完全决定了曲线的形状。<strong>矩阵形式</strong>：</p>

\[\frac{d}{ds}
\begin{bmatrix}
T \\
N \\
B
\end{bmatrix}
=
\begin{bmatrix}
0 &amp; -\kappa &amp; 0 \\
\kappa &amp; 0 &amp; -\tau \\
0 &amp; \tau &amp; 0
\end{bmatrix}
\begin{bmatrix}
T \\
N \\
B
\end{bmatrix}\]

<p>这里，$   N(s) = \frac{T’(s)}{|T’(s)|} = \frac{\gamma’‘(s)}{\kappa(s)} $，法线的方向指向曲率中心。</p>

<h3 id="曲面曲线的曲率">曲面曲线的曲率</h3>

<p>当曲线位于某个曲面上时，我们可以采用另一种分解方式：<strong>法曲率（normal curvature）</strong>和<strong>测地曲率（geodesic curvature）</strong>，它们分别描述曲线在曲面中的“弯曲”行为。</p>

<h4 id="法曲率normal-curvature">法曲率（Normal Curvature）</h4>

<p>衡量曲线在曲面<strong>法向</strong>的弯曲程度，即曲线如何“贴合”曲面的形状。</p>

\[\kappa_n = \langle N_M, \frac{\mathrm{d}T}{\mathrm{d}s} \rangle\]

<p>其中：</p>
<ul>
  <li>$ N_M $ 是<strong>曲面的单位法向量</strong>（不同于曲线的Frenet法向量！）</li>
  <li>$ \frac{\mathrm{d}T}{\mathrm{d}s} $ 是曲线的曲率向量</li>
</ul>

<p><strong>几何意义</strong>：</p>
<ul>
  <li>法曲率反映曲线沿曲面法向的弯曲，与曲面的局部几何直接相关。</li>
  <li>若曲线是曲面的“法截线”（由法平面切割曲面得到），则其曲率就是法曲率。</li>
</ul>

<h4 id="测地曲率geodesic-curvature">测地曲率（Geodesic Curvature）</h4>

<p>衡量曲线在曲面<strong>切平面内</strong>的弯曲程度，即曲线如何“偏离”曲面的测地线（最短路径）。</p>

\[\kappa_g = \langle B_M, \frac{\mathrm{d}T}{\mathrm{d}s} \rangle\]

<p>其中：</p>
<ul>
  <li>$ B_M = T \times N_M $ 是曲面的<strong>副法向量</strong>（由曲线切向量和曲面法向量定义）</li>
</ul>

<p><strong>几何意义</strong>：</p>
<ul>
  <li>测地曲率刻画曲线在曲面内部的“内在弯曲”，与曲面的嵌入方式无关。</li>
  <li><strong>测地线</strong>（曲面的“直线”）的测地曲率 $ \kappa_g = 0 $。</li>
</ul>

<h4 id="曲率分解关系">曲率分解关系</h4>

<p>曲面的总曲率 $ \kappa $ 可分解为法曲率和测地曲率的组合：</p>

\[\kappa^2 = \kappa_n^2 + \kappa_g^2\]

<p>这一分解类似于向量的正交分解，其中：</p>

<ul>
  <li>$ \kappa_n $ 依赖曲面的形状（外在性质）。</li>
  <li>$ \kappa_g $ 仅依赖曲面的内在几何（如度量）。</li>
</ul>

<p>好比你在山区开车，$ \kappa_n $体现了是弯曲的地势，而$ \kappa_g $则是你对方向盘的操作。</p>

<h3 id="weingarten-map">Weingarten Map</h3>

<p>Weingarten映射 $ \mathrm{d}N $ 是<strong>高斯映射 $ N $ 的微分</strong>，描述曲面法向量沿切方向的变化：</p>

<ul>
  <li>输入：切向量 $ X \in T_pM $</li>
  <li>输出：法向量的变化量 $ \mathrm{d}N(X) $，且 $ \mathrm{d}N(X) \in T_pM $（因为单位法向量的变化必正交于自身）</li>
</ul>

<p><strong>几何解释</strong>：</p>

<p>将曲面上沿 $ X $ 的微小移动，映射为球面 $ S^2 $ 上法向量的切向变化（如图）。</p>

\[dN: T_pM \to T_pM\]

<p>这是一个线性算子，称为<strong>形状算子（Shape Operator）</strong>，它将曲面在某点的切空间中的向量，线性地映射到该点法向量的变化方向。在几何上，这个映射有一个直观的解释：当我们把曲面在一点附近的所有切方向对应的法向量变化绘制在单位球面 $ S^2 $ 上时，这些变化量会形成一个<strong>椭圆</strong>。这个椭圆的长短轴方向就是曲面的<strong>主方向</strong>，而半轴长度则对应<strong>主曲率</strong>，分别描述了曲面在该点处弯曲最剧烈和最平缓的方向及其程度。</p>

<h3 id="法曲率与主曲率">法曲率与主曲率</h3>

<p><strong>法曲率（Normal Curvature）</strong></p>

<p><strong>定义</strong>：给定曲面上的曲线，其<strong>法曲率</strong>衡量曲线在曲面法向的弯曲程度：</p>

\[\kappa_N(X) := \frac{\langle df(X), dN(X) \rangle}{| df(X)|^2}\]

<p>法曲率 $\kappa_N(X)$ 是曲面 $M$ 上沿切方向 $X$ 的弯曲程度的度量，其几何定义为：</p>

<ol>
  <li>在点 $p \in M$ 处，取切向量 $df(X) \in T_pM$ 和曲面法向量 $N$。</li>
  <li>用由 $df(X)$ 和 $N$ 张成的平面（称为 <strong>法截面</strong>）切割曲面，得到一条平面曲线 $\gamma$。</li>
  <li>该曲线 $\gamma$ 在 $p$ 点的曲率即为法曲率 $\kappa_N(X)$。</li>
</ol>

<p><strong>主曲率（Principal Curvatures）</strong></p>

<p><strong>定义</strong>：法曲率的极值 $ \kappa_1 $ 和 $ \kappa_2 $，对应正交的<strong>主方向</strong> $ X_1 $、$ X_2 $。</p>

<ul>
  <li>
    <p>数学上，是Weingarten映射 $ dN $ 的特征值：</p>

\[dN(X_i) = \kappa_i df(X_i)\]
  </li>
</ul>

<h3 id="shape-operator">Shape Operator</h3>

<p>形状算子 $ S $ 是一个<strong>线性映射</strong>，将切向量 $ X $ 映射为法向量 $ N $ 的变化量在切平面上的投影：</p>

\[df(SX)=dN(X)\]

<p>形状算子的<strong>特征值与特征向量</strong>直接给出曲面的主曲率和主方向：</p>

<ul>
  <li><strong>主方向</strong> $ X_1, X_2 $：$ S $ 的特征向量，即法向量变化最剧烈/平缓的方向。</li>
  <li><strong>主曲率</strong> $ \kappa_1, \kappa_2 $：$ S $ 的特征值，表示沿主方向的弯曲程度。</li>
</ul>

<p><strong>数学表达</strong>：<br />
\(S(X_i) = \kappa_i X_i\)</p>

<p><strong>非对称性与正交性</strong></p>

<ul>
  <li><strong>非对称性</strong>：$ S $ 的矩阵表示在标准坐标系中通常不是对称矩阵。</li>
  <li><strong>度量正交性</strong>：主方向在曲面<strong>内蕴度量</strong> $ g $ 下正交（$ g(X_1, X_2) = 0 $），但在 $ \mathbb{R}^3 $ 中未必正交。</li>
</ul>

<p>形状算子 $ S $ 的非对称性导致 Weingarten 映射将切平面的单位圆扭曲为椭圆。</p>

<p><strong>例子</strong>（斜圆柱面）：</p>

<p>对于圆柱面 $ f(u,v) = (\cos u, \sin u, v) $：</p>

<ul>
  <li>
    <p><strong>df</strong>：</p>

\[df = [ (-\sin u, \cos u, 0) \,\, (0, 0, 1) ]\]
  </li>
  <li><strong>N</strong>：法向量 $ N = (\cos u, \sin u, 0) $。</li>
  <li>
    <p><strong>dN</strong>：</p>

\[dN = [ (-\sin u, \cos u, 0) \,\, (0, 0, 0) ]\]
  </li>
  <li><strong>形状算子</strong>：<br />
由 $ dN = df \cdot S $，解得 $ S = \begin{bmatrix} 1 &amp; 0 \ 0 &amp; 0 \end{bmatrix} $，对应主曲率 $ \kappa_1 = 1 $（圆周方向）和 $ \kappa_2 = 0 $（直线方向）。</li>
</ul>

<h4 id="umbilic-points">Umbilic Points</h4>

<p>脐点是曲面上<strong>主曲率相等</strong>的点，即满足 $ \kappa_1 = \kappa_2 $。</p>
<ul>
  <li><strong>典型例子</strong>：
    <ul>
      <li>球面上所有点均为脐点（$ \kappa_1 = \kappa_2 = 1/R $）。</li>
      <li>平面上的点也是脐点（$ \kappa_1 = \kappa_2 = 0 $）。</li>
    </ul>
  </li>
</ul>

<h4 id="主曲率线网">主曲率线网</h4>

<ul>
  <li><strong>定义</strong>：沿着曲面“最弯”或“最平”方向（主方向）画出的曲线。</li>
  <li><strong>特点</strong>：
    <ul>
      <li>每条线代表一个主方向（κ₁或κ₂方向）。</li>
      <li>整个曲面的主曲率线构成网状结构，称为<strong>主曲率线网</strong>。</li>
    </ul>
  </li>
</ul>

<p><strong>主曲率线的三种情况</strong></p>

<ol>
  <li><strong>终止于脐点</strong>（分离线）
    <ul>
      <li>脐点是主曲率相等的点（如球面上所有点都是脐点）。</li>
      <li>分离线像“分界线”，将曲面分成规则区域（如椭球面被分成四块）。</li>
    </ul>
  </li>
  <li><strong>闭合循环</strong>
    <ul>
      <li>主曲率线首尾相连（如圆柱面的竖直直线或水平圆圈）。</li>
    </ul>
  </li>
  <li><strong>无限延伸或螺旋</strong>
    <ul>
      <li>多数曲面中，曲率线既不停下也不闭合，而是复杂延伸（如马鞍面）。</li>
    </ul>
  </li>
</ol>

<h3 id="gaussian-and-mean-curvature">Gaussian and Mean Curvature</h3>

<ul>
  <li>
    <p><strong>高斯曲率（Gaussian Curvature）</strong>：<br />
$ K = \kappa_1 \kappa_2 $</p>
  </li>
  <li>
    <p><strong>平均曲率（Mean Curvature）</strong>：<br />
$ H = \frac{1}{2} (\kappa_1 + \kappa_2 ) $</p>
  </li>
</ul>

<p><strong>几何意义</strong></p>

<table>
  <thead>
    <tr>
      <th>曲率类型</th>
      <th>描述</th>
      <th>示例场景</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>高斯曲率 K</strong></td>
      <td>曲面局部面积的”伸缩比”</td>
      <td>- 球面：$ K &gt; 0 $（所有点相同）<br />- 圆柱：$ K = 0 $<br />- 马鞍面：$ K &lt; 0 $</td>
    </tr>
    <tr>
      <td><strong>平均曲率 H</strong></td>
      <td>曲面局部朝向的”平均弯曲程度”</td>
      <td>- 最小曲面：$ H = 0 $（如肥皂膜）<br />- 球面：$ H = 1/R $</td>
    </tr>
  </tbody>
</table>

<p><strong>关键特性</strong></p>

<ul>
  <li><strong>高斯曲率</strong>是<strong>内蕴性质</strong>（仅依赖曲面本身的度量，与外部空间无关）</li>
  <li><strong>平均曲率</strong>是<strong>外蕴性质</strong>（依赖曲面在空间中的嵌入方式）</li>
</ul>

<p><strong>与算子关系</strong></p>

<ul>
  <li>高斯曲率 $ K = \det(S) $（形状算子的行列式）</li>
  <li>平均曲率 $ H = \frac{1}{2} \text{tr}(S) $（形状算子的迹）</li>
</ul>

<h4 id="局部几何的偏离">局部几何的偏离</h4>

<p>高斯曲率 $ K $ 直观表达了曲面局部与欧氏平面 ($ \mathbb{R}^2 $) 的差异：</p>

\[K \propto 1 - \frac{|B_g|}{|B_{\mathbb{R}^2}|}\]

\[|B_g| = \pi\epsilon^2 \left(1 - \frac{K}{12}\epsilon^2 + O(\epsilon^4)\right)\]

<ul>
  <li>
    <table>
      <tbody>
        <tr>
          <td>$</td>
          <td>B_g</td>
          <td>$：曲面上半径为 $ \epsilon $ 的<strong>测地圆</strong>（geodesic ball）的面积或周长。</td>
        </tr>
      </tbody>
    </table>
  </li>
  <li>
    <table>
      <tbody>
        <tr>
          <td>$</td>
          <td>B_{\mathbb{R}^2}</td>
          <td>$：欧氏平面中相同半径圆的面积（$ \pi\epsilon^2 $）或周长（$ 2\pi\epsilon $）。</td>
        </tr>
      </tbody>
    </table>
  </li>
  <li><strong>比例关系</strong>：高斯曲率 $ K $ 正比于曲面局部几何与平面几何的“偏离程度”。</li>
</ul>

<p><strong>几何意义</strong></p>

<ul>
  <li><strong>$ K &gt; 0 $</strong>（如球面）：<br />
$ |B_g| &lt; \pi\epsilon^2 $，测地圆比平面圆更小（正曲率收缩）。<br />
<strong>例子</strong>：地球极区的圆周小于赤道同半径圆。</li>
  <li><strong>$ K &lt; 0 $</strong>（如马鞍面）：<br />
$ |B_g| &gt; \pi\epsilon^2 $，测地圆比平面圆更大（负曲率扩张）。</li>
  <li><strong>$ K = 0 $</strong>（如平面、圆柱）：<br />
$ |B_g| = \pi\epsilon^2 $，局部与欧氏几何一致。</li>
</ul>

<p><strong>为什么是内蕴性质</strong></p>

<p>高斯曲率 $ K $ 仅依赖曲面的<strong>度量</strong>（第一基本形式 $ g $），与外部空间嵌入无关。例如：</p>
<ul>
  <li><strong>圆柱</strong>与<strong>平面</strong>：局部度量相同（$ K=0 $），尽管圆柱在三维空间中“看起来”弯曲。</li>
</ul>

<h3 id="gauss-bonnet-theorem">Gauss-Bonnet Theorem</h3>

<p>对于<strong>封闭、紧致、可定向</strong>的曲面 $ M $，其总高斯曲率与欧拉示性数 $ \chi $ 满足：</p>

\[\int_M K \, dA = 2\pi \chi\]

<p>其中：</p>

<ul>
  <li>$ K $ 是高斯曲率（局部弯曲）。</li>
  <li>$ \chi = 2 - 2g $（$ g $ 为曲面genus，即“洞”的数量）。</li>
</ul>

<p><strong>边界推广</strong>：若曲面有边界 $ \partial M $，则：</p>

\[\int_M K \, dA + \int_{\partial M} \kappa_g \, ds = 2\pi \chi\]

<ul>
  <li>$ \kappa_g $ 为边界曲线的测地曲率。</li>
  <li>此时 $ \chi = 2 - 2g - b $（$ b $ 为number of boundary components）。</li>
</ul>

<p><strong>几何意义</strong></p>

<ul>
  <li><strong>全局拓扑约束局部几何</strong>：无论曲面如何弯曲，总曲率始终由拓扑（欧拉示性数）决定。</li>
  <li><strong>边界贡献</strong>：边界上的“转弯”补偿内部曲率（如平面圆盘的总边界曲率为 $ 2\pi $）。</li>
</ul>

<h4 id="总平均曲率">总平均曲率</h4>

<p>闵可夫斯基（Minkowski）定理指出：对于<strong>封闭凸曲面</strong> $ M \subset \mathbb{R}^3 $，其总平均曲率满足以下不等式：</p>

\[\int_M H \, dA \geq \sqrt{4\pi A}\]

<p>其中：</p>
<ul>
  <li>$ H $ 为平均曲率（$ H = \frac{1}{2}(\kappa_1 + \kappa_2) $）</li>
  <li>$ A $ 为曲面面积</li>
</ul>

<h3 id="i--ii-fundamental-form">I &amp; II Fundamental Form</h3>

<p>第一基本形式 $ I $ 是曲面的<strong>黎曼度量</strong> $ g $，描述曲面上的内蕴几何（长度、角度、面积）：</p>

\[I(X, Y) = g(X, Y) = \langle df(X), df(Y) \rangle\]

<p>其中 $ df $ 是曲面的微分映射，$ X, Y $ 为切向量。</p>

<p>第二基本形式 $ II $ 描述曲面在空间中的<strong>外蕴弯曲</strong>，通过法向变化量化：</p>

\[II(X, Y) = \langle dN(X), df(Y) \rangle\]

<p>其中 $ N $ 为单位法向量，$ dN $ 为 Weingarten 映射。</p>

<p><strong>与法曲率的关系</strong>：</p>

\[\kappa_N(X) = \frac{II(X, X)}{I(X, X)}\]

<p>即，法曲率可以看作是第二基本形式 $II$ 与第一基本形式 $I$ 的比值。而高斯曲率虽然表面上依赖于 $II$，但其实借助结构方程（Gauss–Codazzi–Mainardi 方程），可以将第二基本形式完全表示为 <strong>第一基本形式及其导数</strong> 的函数。这也正是为什么：</p>

<blockquote>
  <p>你无法在不产生拉伸或压缩的情况下，将地球的表面（球面）完整地摊平成平面（地图总会带有畸变）。</p>
</blockquote>]]></content><author><name></name></author><category term="DDG" /><category term="Geometry" /><summary type="html"><![CDATA[原课件来自：https://brickisland.net/ddg-web/]]></summary></entry><entry><title type="html">DDG Discrete Surfaces</title><link href="https://pasu.github.io/blog/2025/Discrete_Surfaces/" rel="alternate" type="text/html" title="DDG Discrete Surfaces" /><published>2025-06-30T00:00:00+00:00</published><updated>2025-06-30T00:00:00+00:00</updated><id>https://pasu.github.io/blog/2025/Discrete_Surfaces</id><content type="html" xml:base="https://pasu.github.io/blog/2025/Discrete_Surfaces/"><![CDATA[<p>原课件来自：https://brickisland.net/ddg-web/</p>

<h2 id="离散曲面模型">离散曲面模型</h2>

<p>在离散微分几何中，曲面主要有两种模型：</p>

<ul>
  <li><strong>单纯形模型（Simplicial）</strong> (图左)
    <ul>
      <li>曲面由<strong>simplicial 2-manifolds</strong>（单纯形2-流形）构成</li>
      <li>天然适配<strong>discrete exterior calculus</strong>（离散外积分）</li>
    </ul>
  </li>
  <li><strong>网格模型（Nets）</strong>  (图左)
    <ul>
      <li>曲面由分段整数格（<strong>piecewise integer lattices</strong>）组成</li>
      <li>天然适配<strong>discrete integrable systems</strong>（离散可积系统）</li>
    </ul>
  </li>
</ul>

<p>在应用中，单纯形模型更为常见，也是本课程的重点。</p>

<h3 id="单纯形曲面simplicial-surface">单纯形曲面（Simplicial Surface）</h3>

<p>简单来说，<strong>单纯形曲面</strong>可以理解为一个“三角形网格”（triangle mesh）。然而，通过更严谨的定义，我们可以将“三角形网格”与微分几何的概念联系起来。</p>

<p>与光滑曲面类似，单纯形曲面也需要满足一定的<strong>正则性条件</strong>，以确保其几何性质良好：</p>

<ul>
  <li><strong>拓扑条件（topology）</strong>：网格的连通性必须满足<strong>流形（manifold）</strong>性质。
    <ul>
      <li>每条边最多属于两个三角形（边界边则属于一个）。</li>
      <li>每个顶点周围的三角形必须构成一个单连通的环（边界顶点则为路径）。</li>
    </ul>
  </li>
  <li><strong>几何条件（geometry）</strong>：顶点的坐标必须构成一个<strong>单纯形浸入（simplicial immersion）</strong>，即局部单射映射，避免自交或退化。</li>
</ul>

<p>通过这样的定义，离散的三角形网格就能在微分几何的框架下进行严格的数学分析。</p>

<h3 id="抽象单纯形曲面abstract-simplicial-surface">抽象单纯形曲面（Abstract Simplicial Surface）</h3>

<p><strong>抽象单纯形曲面</strong>是指一个满足流形条件的单纯形2-复形（manifold simplicial 2-complex），其定义如下：</p>

<ul>
  <li><strong>基本结构</strong>：
    <ul>
      <li>最高维的单纯形是三角形（2-单纯形）</li>
      <li>每条边（1-单纯形）必须属于两个三角形（若在边界上则属于一个）</li>
      <li>每个顶点（0-单纯形）周围的三角形必须构成一个单连通的环（边界顶点则为路径）</li>
    </ul>
  </li>
  <li><strong>数学表示</strong>：通常记作 $ K = (V, E, F) $，其中：
    <ul>
      <li>$ V $：顶点集合</li>
      <li>$ E $：边集合</li>
      <li>$ F $：面（三角形）集合</li>
    </ul>
  </li>
</ul>

<p><strong>核心思想</strong>：抽象单纯形曲面仅描述<strong>连接关系（connectivity）</strong>，不涉及具体的几何形状或空间嵌入。这种纯粹的拓扑结构为后续引入几何映射（如单纯形浸入）提供了基础框架。</p>

<h3 id="单纯形映射simplicial-map">单纯形映射（Simplicial Map）</h3>

<p>单纯形映射的数学核心在于<strong>定义域的构造</strong>。我们需要明确：抽象单纯形复形本身仅包含离散的顶点、边和面（作为集合的子集），但映射 $ f $ 需要作用于整个几何化的“曲面”上，包括单纯形内部的点。以下是关键步骤：</p>

<h4 id="从抽象复形到几何载体"><strong>从抽象复形到几何载体</strong></h4>

<ul>
  <li><strong>抽象单纯形复形</strong> $ K = (V, E, F) $ 仅描述连接关系（如“顶点 $ v_1 $ 和 $ v_2 $ 通过一条边相连”）。</li>
  <li>但映射 $ f $ 需要处理的是每个单纯形（如三角形）<strong>内部的点</strong>，而不仅仅是顶点。</li>
</ul>

<h4 id="重心坐标的作用"><strong>重心坐标的作用</strong></h4>

<ul>
  <li>
    <p>通过<strong>重心坐标 $ (t_0, t_1, t_2) $</strong>，我们将每个抽象三角形 $ \sigma = {v_i, v_j, v_k} $ 关联到一个<strong>标准单纯形</strong>（即二维空间中的单位三角形）：</p>

\[\sigma \mapsto \left\{ (t_0, t_1, t_2) \mid t_0 + t_1 + t_2 = 1, \, t_i \geq 0 \right\}\]
  </li>
  <li>
    <p>例如：顶点 $ v_i $ 对应 $ (1, 0, 0) $，边 $ v_i v_j $ 对应 $ (t, 1-t, 0) $，三角形内部点则为 $ (t_0, t_1, t_2) $。</p>
  </li>
</ul>

<h4 id="定义域">定义域</h4>

<p><strong>定义</strong>：单纯形映射 $ f $ 的定义域，是通过把抽象三角网格的每个三角形”撑开”成标准三角形后，再把它们按照原来的连接方式粘起来形成的连续曲面。</p>

<p><strong>两步构造法</strong>：</p>

<ol>
  <li><strong>无交并（Disjoint Union）</strong>
    <ul>
      <li>把网格的每个三角形都当作一个独立的”纸片”</li>
      <li>此时相邻三角形虽然共享边，但这些边还是分开的（就像两片没粘好的折纸）</li>
    </ul>
  </li>
  <li><strong>沿共享边粘合（Gluing）</strong>
    <ul>
      <li>把那些在抽象网格中本应相连的边（如图中的边jk）严格对齐粘合</li>
      <li>粘合规则：共享边的对应点必须完全重合（比如两个三角形的中点要粘在同一个位置）</li>
    </ul>
  </li>
</ol>

<p><strong>核心思想</strong>：单纯形映射的域是抽象复形的“几何实现”，通过重心坐标和粘合操作，将<strong>离散</strong>的组合结构转化为<strong>连续</strong>的几何对象。这一过程是离散微分几何中模拟光滑曲面的关键步骤。</p>

<h3 id="离散微分discrete-differential">离散微分（Discrete Differential）</h3>

<ol>
  <li><strong>离散映射 $ f $ 的性质</strong>
    <ul>
      <li>$ f $ 是一个离散的、$ \mathbb{R}^n $-值的 <strong>0-形式</strong>，即它为每个顶点 $ i $ 赋予一个坐标向量 $ f_i \in \mathbb{R}^n $。</li>
    </ul>
  </li>
  <li><strong>离散微分 $ df $ 的定义</strong>
    <ul>
      <li>$ df $ 是 $ f $ 的<strong>离散外导数</strong>，作为 <strong>1-形式</strong>，它为每条有向边 $ ij $ 赋予一个值：<br />
\((df)_{ij} := f_j - f_i\)</li>
      <li><strong>几何解释</strong>：$ (df)_{ij} $ 就是连接顶点 $ i $ 和 $ j $ 的<strong>边向量</strong>（从 $ f_i $ 指向 $ f_j $）。</li>
    </ul>
  </li>
  <li><strong>与光滑理论的类比</strong>
    <ul>
      <li>在光滑曲面中，微分 $ df $ 作用于切向量 $ X $，输出方向导数 $ df(X) $。</li>
      <li>在离散情况下，边 $ ij $ 可视为“离散切向量”，而 $ (df)_{ij} = f_j - f_i $ 直接给出了该方向的变化量。</li>
    </ul>
  </li>
  <li><strong>反对称性</strong>
    <ul>
      <li>
        <p>对反向边 $ ji $，有：</p>

\[(df)_{ji} = f_i - f_j = - (df)_{ij}\]

        <p>这与经典微分几何中 1-形式的定向一致性一致。</p>
      </li>
    </ul>
  </li>
</ol>

<p>若将 $ df $ 视为光滑 1-形式的离散版本，则：</p>

\[(df)_{ij} \approx \int_{\sigma_{ij}} df = f_j - f_i\]

<p>离散微分 $ df $ 用简单的边向量 $ f_j - f_i $，在离散网格上复现了光滑微分的关键性质。</p>

<h3 id="immersion-discrete-immersion与simplicial-immersion">Immersion, Discrete Immersion与Simplicial Immersion</h3>

<p>参数化曲面 $ f $ 是浸入，若其微分 $ df $ 处处非退化（即 $ df(X) = 0 $ 当且仅当 $ X = 0 $）。</p>

<p><strong>几何意义</strong>：</p>
<ul>
  <li>曲面无“折叠”或“退化”区域，保证切空间处处维数正确。</li>
  <li>是定义曲率、法向量等微分量的基础条件。</li>
</ul>

<h4 id="离散浸入discrete-immersion">离散浸入（Discrete Immersion）</h4>

<p><strong>问题</strong>：</p>
<ul>
  <li>若仅要求离散微分 $ df $ 的边向量非零（即边长 $ |f_j - f_i| &gt; 0 $），仍可能丢失光滑浸入的关键性质。</li>
</ul>

<p><strong>分支点（Branch Points）</strong>：</p>

<ul>
  <li>在左边的离散网格中，围绕顶点 $0$ 的三角形拼接得很好，如果你沿着 $0$ 走一圈，刚好走完一次，总角度是 $2\pi$。</li>
  <li>在右边的映射图中，通过映射 $f$，这些点被映射到 $f_0, f_1, \dots, f_9$。现在围绕 $f_0$ 的面 <strong>会绕中心多转几圈</strong>，即围绕 $f_0$ 的总角度大于 $2\pi$。</li>
  <li>这意味着这个映射在 $f_0$ 处是 <strong>locally many-to-one</strong>（局部多值），在离散域中绕 $f_0$ 走一圈，映射后会绕 $f_0$ 转多圈。这正是所谓的 <strong>branch point</strong>（类似复分析中全纯函数出现 $z \mapsto z^n$ 的情形）。</li>
</ul>

<h4 id="单纯形浸入simplicial-immersion">单纯形浸入（Simplicial Immersion）</h4>

<p><strong>修正定义</strong>：</p>
<ul>
  <li>要求单纯形映射 $ f $ 是<strong>局部单射</strong>（locally injective），即每个顶点邻域（star）在映射下无重叠或翻转。</li>
  <li><strong>等价条件</strong>：
    <ul>
      <li>每个顶点邻域的三角形在 $ \mathbb{R}^n $ 中<strong>嵌入</strong>（无自交或退化）。</li>
      <li>所有三角形面积非零，且相邻三角形法向量方向一致。</li>
    </ul>
  </li>
</ul>

<p><strong>示例</strong>：</p>
<ul>
  <li><strong>合法</strong>：两个相邻三角形共享边，且张开角度 $ \theta \in (0, 2\pi) $。</li>
  <li><strong>非法</strong>：
    <ol>
      <li>边长和面积为0</li>
      <li>dihedral角度为0</li>
      <li>不满足locally injective</li>
    </ol>
  </li>
</ul>

<p><strong>必要非充分条件</strong>：<br />
  边长、面积、角度非零仅是单纯形浸入的必要条件，但还需局部单射性。</p>

<h3 id="离散高斯映射discrete-gauss-map">离散高斯映射（Discrete Gauss Map）</h3>

<p><strong>定义</strong>：<br />
对于离散浸入曲面，<strong>高斯映射</strong>即为每个三角形的单位法向量 $ N_f \in \mathbb{R}^3 $（属于对偶离散0-形式）。</p>

<p><strong>几何表现</strong>：</p>
<ul>
  <li>将每个三角形法向量可视作单位球面上的点（如图）。</li>
  <li>连接相邻法向量的弧线对应于<strong>共享边的正交法向族</strong>（即所有包含该边的三角形的法向量在球面上的轨迹）。</li>
</ul>

<p><strong>局限性</strong>：</p>
<ul>
  <li>仅定义在三角形面片层级，无法直接给出顶点或边的法向。</li>
</ul>

<h4 id="顶点法向的传统问题">顶点法向的传统问题</h4>

<ul>
  <li>
    <table>
      <tbody>
        <tr>
          <td><strong>均匀平均面法向</strong>：$ N_v = \frac{1}{</td>
          <td>F(v)</td>
          <td>} \sum_{f \in F(v)} N_f $</td>
        </tr>
      </tbody>
    </table>
    <ul>
      <li>问题：结果依赖网格剖分密度，几何意义不明确（如图中不同细分导致法向偏移）。</li>
    </ul>
  </li>
</ul>

<h4 id="基于向量面积的离散法向discrete-vector-area">基于向量面积的离散法向（Discrete Vector Area）</h4>

<p><strong>光滑理论回顾</strong>：<br />
向量面积 $ \int_\Omega N \, dA = \frac{1}{2} \int_{\partial \Omega} f \times df $。</p>

<p><strong>离散版本</strong>：</p>
<ul>
  <li>
    <p>对顶点 $ v $ 的邻域 $ \Omega $，积分 $ N \, dA $ 转化为对邻域边界的求和：</p>

\[\frac{1}{3} \int_\Omega N \mathrm{d}A = \frac{1}{6} \int_{\partial \Omega} f \times \mathrm{d}f = \frac{1}{6} \sum_{ij \in \partial \Omega} \int_{e_{ij}} f \times \mathrm{d}f\]

\[N_v = \frac{1}{2} \sum_{ij \in \partial \Omega} f_i \times f_j\]
  </li>
  <li>
    <p><strong>关键性质</strong>：</p>
    <ul>
      <li>与顶点坐标 $ p $ 无关（仅依赖邻域顶点位置）。</li>
    </ul>
  </li>
</ul>

<h4 id="其他自然定义">其他自然定义</h4>

<ul>
  <li><strong>面积加权</strong>：适合需要物理精确性的场景（如曲率计算）。</li>
  <li><strong>角度加权</strong>：适合几何处理（如网格平滑、去噪），因其对网格质量不敏感。</li>
</ul>

<h3 id="discrete-exterior-calculus-on-curved-surfaces">Discrete Exterior Calculus on Curved Surfaces</h3>

<ul>
  <li><strong>光滑曲面</strong>：外微积分在 $ \mathbb{R}^n $ 中定义后，通过调整 <strong>霍奇星算子（Hodge star）</strong> 推广到弯曲曲面，该算子编码了几何信息（长度、角度、面积等）。</li>
  <li><strong>离散曲面</strong>：单纯形曲面（如三角网格）的每个面片本身是平的，因此可直接沿用 $ \mathbb{R}^2 $ 中的离散霍奇星算子公式，无需修改！</li>
</ul>

<p>我们可以直接将平面中的离散霍奇星算子公式(DDG (11): Discrete Exterior Calculus)应用于曲面上。</p>

<ul>
  <li><strong>内蕴性</strong>：霍奇星算子的作用仅依赖于曲面的 <strong>内蕴几何</strong>（如边长、内角），与曲面如何嵌入 $ \mathbb{R}^3 $ 无关。</li>
  <li><strong>平坦性</strong>：每个三角形局部是欧几里得的，因此 $ \mathbb{R}^2 $ 的离散公式可直接应用。</li>
</ul>

<h4 id="关键性质">关键性质</h4>

<ul>
  <li><strong>局部性</strong>：每个算子的计算仅依赖相邻单元（如顶点邻域或边邻域）。</li>
  <li><strong>兼容性</strong>：与离散外导数 $ d $ 结合后，可构建离散拉普拉斯算子等微分工具。</li>
  <li><strong>几何无关性</strong>：即使曲面在 $ \mathbb{R}^3 $ 中弯曲，公式仍仅用原始边长和内角计算。</li>
</ul>

<h4 id="离散-laplace-beltrami-算子">离散 Laplace-Beltrami 算子</h4>

<p>在光滑曲面中，Laplace-Beltrami 算子定义为：</p>

\[\Delta = \star d \star d \phi\]

<p>在离散下，通过组合 $ \star $ 和 $ d $，我们得到著名的 <strong>cotan 公式</strong>，实现了连续拉普拉斯算子的自然离散化：</p>

\[(\Delta u)_i = \frac{1}{2} \sum_{j \in \mathcal{N}(i)} (\cot \alpha_{ij} + \cot \beta_{ij}) (u_j - u_i)\]

<p>其中：</p>
<ul>
  <li>$ \mathcal{N}(i) $ 是顶点 $ i $ 的邻接顶点集合，形成$e_{ij}$</li>
  <li>$ \alpha_{ij} $ 和 $ \beta_{ij} $ 是边 $ ij $ 的两个对角</li>
</ul>

<h4 id="cotan-公式的几何解释">Cotan 公式的几何解释</h4>

<ul>
  <li><strong>权重意义</strong>：$ \frac{1}{2}(\cot \alpha_{ij} + \cot \beta_{ij}) $ 实际上表示边 $ ij $ 的对偶边长</li>
  <li><strong>内在性质</strong>：只依赖于局部边长和内角，与曲面在空间中的弯曲方式无关</li>
  <li><strong>保角性</strong>：cotan 权重自然地捕捉了曲面的共形结构</li>
</ul>

<h3 id="离散曲面的重建问题">离散曲面的重建问题</h3>

<p>在微分几何中，许多几何对象可以通过其微分量唯一确定（需初始条件）：</p>
<ul>
  <li><strong>平面曲线</strong>：由曲率函数 + 初始点/方向确定</li>
  <li><strong>空间曲线</strong>：由曲率和挠率确定</li>
  <li><strong>光滑曲面</strong>：由第一/第二基本形式确定</li>
  <li><strong>凸曲面</strong>：由黎曼度量唯一确定</li>
</ul>

<p>如果给定一个离散高斯映射（即所有三角形法向），能否重建顶点位置？</p>

<p><strong>离散重建算法</strong>：</p>

<ol>
  <li><strong>边方向确定</strong>：相邻三角形法向 $ N_1 $, $ N_2 $ 的叉积给出共享边方向 $ N_1 \times N_2 $</li>
  <li><strong>角度计算</strong>：通过边方向的点积计算三角形内角</li>
  <li><strong>三角形重建</strong>：根据三边方向+内角确定三角形形状（尺度未定）</li>
  <li><strong>全局拼接</strong>：将所有三角形按共享边匹配，恢复完整网格</li>
</ol>

<h4 id="光滑情形的局限性">光滑情形的局限性</h4>
<p>| 特性                | 离散曲面                     | 光滑曲面                     |
|———————|—————————-|—————————-|
| 重建所需数据         | 法向 + 连接关系             | 法向 + 参数化（如弧长参数） |
| 唯一性              | 唯一（模去刚体变换）         | 需额外条件才唯一           |
| 核心约束            | 组合结构（连接关系）         | 微分方程的可积条件         |</p>

<p>以平面曲线为例：</p>
<ul>
  <li><strong>给定法向场</strong>：$ N(s) = (\cos\theta(s), \sin\theta(s)) $</li>
  <li><strong>重建问题</strong>：需解微分方程 $ \frac{df}{ds} = R_{90^\circ}N(s) $（$ R_{90^\circ} $为旋转矩阵）</li>
  <li><strong>关键缺陷</strong>：<br />
除非已知弧长参数 $ s $，否则 $ \theta(s) $ 可任意重参数化 → <strong>无穷多解</strong>（如图1）</li>
</ul>

<h4 id="从度量重建曲面">从度量重建曲面</h4>

<p><strong>光滑曲面（Cohn-Vossen定理）</strong>：</p>
<ul>
  <li>凸光滑曲面由其黎曼度量<strong>唯一确定</strong>（差一个刚体运动）</li>
  <li>度量 $ g $ 编码了曲面的所有内蕴几何（长度、角度、面积等）</li>
</ul>

<p><strong>离散曲面（Alexandrov-Connelly定理）</strong>：</p>
<ul>
  <li>凸多面体由其<strong>边长</strong>唯一确定</li>
  <li>非凸情形不成立：存在不同构的多面体具有相同边长</li>
</ul>

<h5 id="重建网格算法">重建网格算法</h5>

<p><strong>Chern等（2018）的”Shape from Metric”方法</strong>：</p>
<ol>
  <li><strong>输入</strong>：离散度量（所有边长 $ \ell_{ij} $）</li>
  <li><strong>核心步骤</strong>：
    <ul>
      <li>构造离散<strong>浸入条件</strong>（Discrete Immersion）</li>
      <li>引入离散<strong>自旋结构</strong>（Discrete Spin Structure）</li>
      <li>求解非线性优化问题，使边长匹配目标度量</li>
    </ul>
  </li>
  <li><strong>输出</strong>：顶点坐标 $ f_i \in \mathbb{R}^3 $</li>
</ol>

<p><strong>总结</strong>：离散微分几何通过单纯形映射和组合结构，在三角网格上重建了光滑曲面的微分几何框架——从离散微分、霍奇星算子到Laplace-Beltrami算子，其核心在于利用边长和内角等内蕴几何量保持微分几何的本质特性。离散情形的独特刚性（如从法向或度量重建曲面）揭示了组合结构与几何的深刻联系，为几何处理算法提供了既严谨又高效的理论基础，也彰显了”离散逼近连续”在计算应用中的强大优势。</p>]]></content><author><name></name></author><category term="DDG" /><category term="Geometry" /><summary type="html"><![CDATA[原课件来自：https://brickisland.net/ddg-web/]]></summary></entry><entry><title type="html">DDG Smooth Surfaces II</title><link href="https://pasu.github.io/blog/2025/Smooth_Surfaces_2/" rel="alternate" type="text/html" title="DDG Smooth Surfaces II" /><published>2025-06-29T00:00:00+00:00</published><updated>2025-06-29T00:00:00+00:00</updated><id>https://pasu.github.io/blog/2025/Smooth_Surfaces_2</id><content type="html" xml:base="https://pasu.github.io/blog/2025/Smooth_Surfaces_2/"><![CDATA[<p>原课件来自：https://brickisland.net/ddg-web/</p>

<h2 id="光滑曲面-ii">光滑曲面 II</h2>

<p>好久不看DDG，导致每次看，感觉上次写的自己都看不懂，什么玩意，都需要在简单的温故一下，然后有会觉得有一些上次学习忽略的地方。不管怎样，今天无论如何都要看完Surface II。</p>

<h3 id="第一节高斯映射gauss-map">第一节：高斯映射（Gauss Map）</h3>

<h4 id="1-基本概念">1. 基本概念</h4>

<p>高斯映射是微分几何中描述曲面法向量方向的重要工具，它将曲面上的每一点映射到其单位法向量，从而建立从曲面到单位球面 $ S^2 $ 的对应关系。</p>

<ul>
  <li>
    <p><strong>单位法向量</strong>：对于曲面 $ M $，其高斯映射定义为：</p>

\[N: M \to S^2, \quad p \mapsto N(p)\]

    <p>其中 $ N(p) $ 是点 $ p $ 处的单位法向量，满足 $ N(p) \perp T_pM $（与切空间正交）。</p>
  </li>
  <li>
    <p><strong>非唯一性</strong>：法向量本身可以有不同方向和长度，但高斯映射标准化为单位长度，仅保留方向信息（正反方向需一致）。</p>
  </li>
</ul>

<p><strong>几何意义</strong>：高斯映射通过记录曲面上各点的法向，反映曲面的弯曲和形状特征。例如：</p>

<ul>
  <li>平面映射到球面的一个固定点（法向量恒定）。</li>
  <li>球面映射到整个单位球面（法向量方向全覆盖）。</li>
</ul>

<h4 id="2-可定向性orientability">2. 可定向性（Orientability）</h4>

<p>并非所有曲面都能全局定义高斯映射，其存在性取决于曲面的<strong>可定向性</strong>：</p>

<ul>
  <li><strong>可定向曲面</strong>（如球面、环面）：可定义连续的高斯映射。</li>
  <li><strong>不可定向曲面</strong>（如莫比乌斯带）：法向量沿环路移动时会反转，导致高斯映射矛盾。</li>
</ul>

<p><strong>关键结论</strong>：</p>

<ul>
  <li>高斯映射的全局定义要求曲面可定向。</li>
  <li>不可定向曲面的法向量场存在拓扑障碍（如莫比乌斯带的单侧性）。</li>
</ul>

<h4 id="3-示例">3. 示例</h4>

<p>通过参数化曲面的切向量计算高斯映射：</p>

<ol>
  <li>
    <p>给定参数化 $ f(u,v) $，计算切向量：</p>

\[\mathrm{d}f_u = \frac{\partial f}{\partial u}, \quad \mathrm{d}f_v = \frac{\partial f}{\partial v}\]
  </li>
  <li>
    <p>法向量由叉积得到：</p>

\[N = \frac{\mathrm{d}f_u \times \mathrm{d}f_v}{\|\mathrm{d}f_u \times \mathrm{d}f_v\|}\]

    <p><strong>条件</strong>：切向量必须线性独立（叉积非零）。</p>
  </li>
</ol>

<p><strong>球面例子</strong>：</p>

<ul>
  <li>参数化 $ f(u,v) = (\cos u \sin v, \sin u \sin v, \cos v) $</li>
  <li>
    <p>切向量：</p>

    <p>$ \mathrm{d}f(\frac{\partial}{\partial u}) = (-\sin u \sin v, \cos u \sin v, 0) $,<br />
$ \mathrm{d}f(\frac{\partial}{\partial v}) = (\cos u \cos v, \sin u \cos v, -\sin v) $。</p>
  </li>
  <li>
    <p>叉积结果：</p>

    <p>$ \mathrm{d}f(\frac{\partial}{\partial u}) \times \mathrm{d}f(\frac{\partial}{\partial v}) = -\sin v \cdot f(u,v) $。</p>
  </li>
  <li>单位法向量：$ N = -f(u,v) $（与球心对称，直接取反即可）。</li>
</ul>

<h4 id="4-满射性surjectivity">4. 满射性（Surjectivity）</h4>

<p><strong>问题</strong>：高斯映射是否能覆盖整个单位球面？</p>

<ul>
  <li><strong>封闭凸曲面</strong>（如椭球）：满射（所有法向量方向均存在）。</li>
  <li><strong>非凸或非闭曲面</strong>（如圆柱、平面）：非满射。
    <ul>
      <li>圆柱面映射到赤道圆，平面映射到单点。</li>
    </ul>
  </li>
</ul>

<p><strong>数学意义</strong>：</p>

<ul>
  <li>满射性反映曲面法向方向的完备性，与曲率分布紧密相关。</li>
  <li><strong>应用</strong>：在曲面设计中，需控制法向覆盖范围以满足需求（如纹理映射）。</li>
</ul>

<h4 id="5-向量面积vector-area">5. 向量面积（Vector Area）</h4>

<p><strong>定义</strong>：对曲面片 $ \Omega $，向量面积是法向量的加权积分：</p>

\[\text{Vector Area} = \int_\Omega N \, \mathrm{d}A = \frac{1}{2} \int_\Omega \mathrm{d}f \wedge \mathrm{d}f\]

\[A = \frac{1}{2} \mathrm{d}f \wedge \mathrm{d}f\]

<h3 id="exterior-calculus-on-immersed-surfaces">Exterior Calculus on Immersed Surfaces</h3>

<h4 id="基本概念">基本概念</h4>

<p>Immersed surface是指通过光滑映射 $ f: M \to \mathbb{R}^3 $ 定义的曲面，其中微分 $ \mathrm{d}f $ 处处非退化（即切空间维度保持为2）。</p>

<h4 id="induced-area-2-form">Induced Area 2-Form</h4>

<ul>
  <li>
    <p><strong>定义</strong>：给定参数域中的向量 $ X, Y $，其映射后的有向面积由叉积给出：</p>

\[\mathrm{d}A(X, Y) = \| \mathrm{d}f(X) \times \mathrm{d}f(Y) \| \cdot \text{orientation}\]
  </li>
  <li>
    <p><strong>坐标表达式</strong>：若 $ f(u,v) $ 是参数化，则：</p>

\[\mathrm{d}A = \| f_u \times f_v \| \, du \wedge dv\]
  </li>
  <li>
    <p><strong>与法向量的关系</strong>：</p>

\[\mathrm{d}f \wedge \mathrm{d}f = 2 (\mathrm{d}f(X) \times \mathrm{d}f(Y)) \, du \wedge dv = 2 N \, \mathrm{d}A\]

    <p>（$ \mathrm{d}f \wedge \mathrm{d}f $ 的方向与单位法向量 $ N $ 一致，大小为 $ 2 \, \mathrm{d}A $）。</p>
  </li>
</ul>

<h4 id="hodge-star">Hodge Star</h4>

<p>在浸入曲面 $ f(M) $ 上，霍奇星算子需根据微分形式的阶数分别定义：</p>

<h5 id="0-forms">0-Forms</h5>

<ul>
  <li>
    <p><strong>定义</strong>：</p>

    <p>给定面积2-形式 $ \mathrm{d}A $ 和标量函数（0-形式）$ \phi $，定义：</p>

\[\star \phi := \phi \, \mathrm{d}A\]
  </li>
  <li>
    <p><strong>几何意义</strong>：</p>

    <p>将函数 $ \phi $ 的值作为权重，缩放曲面的局部面积形式 $ \mathrm{d}A $，生成一个<strong>带权面积2-形式</strong>。<br />
<strong>示例</strong>：<br />
若 $ \phi $ 表示曲面的温度分布，则 $ \star \phi $ 表示“温度加权的面积微元”。</p>
  </li>
</ul>

<h5 id="2-forms">2-Forms</h5>

<ul>
  <li>
    <p><strong>定义</strong>：</p>

    <p>对任意2-形式 $ \omega $，存在唯一的标量函数 $ \phi $ 使得：</p>

\[\omega = \phi \, \mathrm{d}A\]

    <p>则定义其霍奇对偶为：</p>

\[\star \omega := \phi\]
  </li>
  <li>
    <p><strong>几何意义</strong>：</p>

    <p>将2-形式 $ \omega $ 分解为面积形式 $ \mathrm{d}A $ 和一个标量函数 $ \phi $，提取该函数作为霍奇对偶。</p>

    <p><strong>示例</strong>：<br />
若 $ \omega = \sin v \, du \wedge dv $ 且 $ \mathrm{d}A = \sin v \, du \wedge dv $，则 $ \star \omega = 1 $。</p>
  </li>
</ul>

<h3 id="complex-structure">Complex Structure</h3>

<h4 id="基本定义">基本定义</h4>

<p>复结构 $ J $ 是浸入曲面 $ f: M \to \mathbb{R}^3 $ 切空间上的线性算子，满足以下核心性质：</p>

<ol>
  <li><strong>旋转特性</strong>：$ J^2 = -\text{Id} $，即对任意切向量连续应用两次 $ J $ 等价于反向。</li>
  <li>
    <p><strong>几何实现</strong>：通过法向量叉积定义切向量的旋转：</p>

\[\mathrm{d}f(JX) = N \times \mathrm{d}f(X), \quad \forall X \in T_p M\]

    <p>其中 $ N $ 是单位法向量，$ \mathrm{d}f $ 是微分映射。</p>
  </li>
</ol>

<p>在 $ \mathbb{R}^2 $ 中，标准复结构为固定矩阵：</p>

\[J_{\mathbb{R}^2} = \begin{bmatrix} 0 &amp; -1 \\ 1 &amp; 0 \end{bmatrix}, \quad \text{对应旋转} \begin{bmatrix} x \\ y \end{bmatrix} \mapsto \begin{bmatrix} -y \\ x \end{bmatrix}\]

<p>曲面上的 $ J $ 是此概念的弯曲推广，其矩阵形式依赖局部几何。</p>

<h4 id="显式计算与度量依赖">显式计算与度量依赖</h4>

<p>复结构可通过雅可比矩阵 $ A = [\mathrm{d}f_u \ \mathrm{d}f_v] $ 和法向量叉积矩阵 $ \hat{N} $ 显式求解：</p>

\[J = (A^T A)^{-1} A^T \hat{N} A\]

<p><strong>关键步骤</strong>：</p>

<ol>
  <li><strong>度量矩阵</strong>：$ A^T A $ 是诱导度量 $ g $ 的坐标表示。</li>
  <li>
    <p><strong>叉积矩阵</strong>：</p>

\[\hat{N} = \begin{bmatrix} 0 &amp; -N_z &amp; N_y \\ N_z &amp; 0 &amp; -N_x \\ -N_y &amp; N_x &amp; 0 \end{bmatrix}\]
  </li>
  <li><strong>方程意义</strong>：$ A J = \hat{N} A $ 确保参数域旋转与 $ \mathbb{R}^3 $ 叉积旋转一致。</li>
</ol>

<h4 id="共形浸入的判定">共形浸入的判定</h4>

<p>浸入 $ f $ 是共形（保角）的充要条件为：</p>

\[J = J_{\mathbb{R}^2}\]

<p>此时曲面仅允许局部伸缩，角度保持不变。</p>

\[\mathrm{d}f(JX) = N \times \mathrm{d}f(X) \Rightarrow J = (A^T A)^{-1} A^T \hat{N} A\]

<h5 id="hodge-star-on-1-forms">Hodge star on 1-forms</h5>

<p>对于浸入曲面 $f: M \to \mathbb{R}^3$ 上的 1-形式 $\alpha$，其Hodge star运算定义为：</p>

\[(\star_f \alpha)(X) = \alpha(\mathcal{J}_f X)\]

<p>其中：</p>

<ul>
  <li>$X$ 是 $ T_p M$ 中的任意切向量。</li>
  <li>
    <p>$\mathcal{J}_f$ 就是你前面定义的曲面上的复结构（局部90度旋转）：</p>

\[\mathrm{d}f(\mathcal{J}_f X) = N \times \mathrm{d}f(X)\]
  </li>
</ul>

<p><strong>几何理解</strong>：</p>

<ul>
  <li>在 $\mathbb{R}^2$ 中，$\star$ 对 1-形式相当于把向量旋转 $90^\circ$。</li>
  <li>在曲面 $M$ 上，$\star_f$ 就通过局部法向量来确定“哪边是左，哪边是右”，从而将切向量场沿着面内旋转 $90^\circ$，再用 $\alpha$ 取值。</li>
</ul>

<h6 id="与其他阶霍奇星的统一性">与其他阶霍奇星的统一性</h6>

<ul>
  <li><strong>0-形式</strong>：$ \star_f \phi = \phi \, \mathrm{d}A $</li>
  <li><strong>1-形式</strong>：$ \star_f \alpha(X) = \alpha(\mathcal{J}_f X) $</li>
  <li><strong>2-形式</strong>：$ \star_f (\phi \, \mathrm{d}A) = \phi $</li>
</ul>

<h4 id="metric-area-form-and-complex-structure">Metric, Area Form, and Complex Structure</h4>

<p>在曲面上，黎曼度规 $ g(X,Y) $ 可以分解为<strong>面积形式 $ \mathrm{d}A $</strong> 和<strong>复结构 $ J $</strong> 的组合：</p>

\[g(X, Y) = \mathrm{d}A(X, JY)\]

<p>其中：</p>
<ul>
  <li>$ \mathrm{d}A $ 是曲面的有向面积2-形式（$ \mathrm{d}A(X,Y) = |X \times Y| $）。</li>
  <li>$ J $ 是切空间中的90度旋转算子（复结构），满足 $ J^2 = -\text{Id} $。</li>
</ul>

<h5 id="二维平面-mathbbr2-中的类比">二维平面（$ \mathbb{R}^2 $）中的类比</h5>

<p>在平面上，Metric、Cross和Complex Structure $ J $ 满足类似关系：</p>

\[X \cdot Y = X \times (JY)\]

<p><strong>推导</strong>：</p>

<ol>
  <li>设 $ X = (x_1, x_2) $，$ Y = (y_1, y_2) $，平面复结构 $ J = \begin{bmatrix} 0 &amp; -1 \ 1 &amp; 0 \end{bmatrix} $。</li>
  <li>计算 $ JY = (-y_2, y_1) $。</li>
  <li>叉积 $ X \times (JY) = x_1 y_1 + x_2 y_2 = X \cdot Y $。</li>
</ol>

<p><strong>几何意义</strong>：</p>
<ul>
  <li>左边 $ X \cdot Y $ 是向量的点积（度量内积）。</li>
  <li>右边 $ X \times (JY) $ 通过旋转 $ Y $ 后与 $ X $ 叉积，结果等于点积。</li>
  <li><strong>本质</strong>：点积与叉积通过复结构 $ J $ 联系起来。</li>
</ul>

<h4 id="曲面上的sharp与flat算子">曲面上的Sharp（♯）与Flat（♭）算子</h4>

<p>在曲面 $ f: M \to \mathbb{R}^3 $ 上，<strong>诱导度量 $ g $</strong> 允许我们在<strong>向量场</strong>和<strong>1-形式</strong>之间转换：</p>
<ul>
  <li><strong>Flat（♭）</strong>：将向量场 $ X $ 转换为对应的1-形式 $ X^b $。</li>
  <li><strong>Sharp（♯）</strong>：将1-形式 $ \alpha $ 转换为对应的向量场 $ \alpha^# $。</li>
</ul>

<h5 id="flat-算子">Flat 算子（♭）</h5>

<p>对向量场 $ X $，定义其对应的1-形式 $ X^b $ 为：</p>

\[X^b(Y) := g(X, Y) = \langle \mathrm{d}f(X), \mathrm{d}f(Y) \rangle_{\mathbb{R}^3}\]

<h5 id="sharp-算子">Sharp 算子（♯）</h5>

<p>对1-形式 $ \alpha $，定义其对应的向量场 $ \alpha^# $ 为：</p>

\[g(\alpha^\#, Y) := \alpha(Y), \quad \forall Y\]]]></content><author><name></name></author><category term="DDG" /><category term="Geometry" /><summary type="html"><![CDATA[原课件来自：https://brickisland.net/ddg-web/]]></summary></entry><entry><title type="html">DDG Discrete Curves</title><link href="https://pasu.github.io/blog/2025/Discrete_Curve/" rel="alternate" type="text/html" title="DDG Discrete Curves" /><published>2025-06-11T10:27:00+00:00</published><updated>2025-06-11T10:27:00+00:00</updated><id>https://pasu.github.io/blog/2025/Discrete_Curve</id><content type="html" xml:base="https://pasu.github.io/blog/2025/Discrete_Curve/"><![CDATA[<h2 id="平面中的离散曲线">平面中的离散曲线</h2>

<p>在离散微分几何中，<strong>离散曲线</strong>被定义为一种<strong>分段线性参数化曲线</strong>，即由一系列点通过直线段连接而成的几何对象。形式上，给定一组有序点 $\gamma_0, \gamma_1, \ldots, \gamma_n \in \mathbb{R}^2$，离散曲线 $\gamma$ 是由这些点依次相连构成的折线。其参数化表示为：</p>

\[\gamma(s) = (1-t)\gamma_i + t\gamma_{i+1}, \quad \text{其中} \ s \in [s_i, s_{i+1}], \ t = \frac{s-s_i}{s_{i+1}-s_i}.\]

<p>为简化记号，常用 $\gamma_i$ 表示 $\gamma(s_i)$，即第 $i$ 个顶点的位置。</p>

<p>关键特性有：</p>

<ol>
  <li><strong>分段线性</strong>：曲线在每对相邻点之间是直线段，整体呈现折线形态。</li>
  <li><strong>连续性与参数化</strong>：尽管离散，曲线仍是连续的参数化映射，但与传统光滑曲线的解析表达式不同。</li>
  <li><strong>离散微分形式</strong>：可通过抽象单纯复形和离散0-形式（顶点坐标）定义，利用Whitney基函数（如“帽子函数”）实现边上的插值。</li>
</ol>

<h3 id="示例">示例</h3>

<p>一个简单的例子是由两段线段组成的L形曲线：</p>

\[\gamma(s) = 
\begin{cases} 
(s, 0), &amp; 0 \leq s \leq 1, \\ 
(1, s-1), &amp; 1 \leq s \leq 2.
\end{cases}\]

<p>此曲线从点 $(0,0)$ 水平延伸至 $(1,0)$，再垂直延伸至 $(1,1)$。</p>

<h3 id="离散曲线的微分">离散曲线的微分</h3>

<p>在光滑曲线的理论中，微分 $d\gamma$ 描述了曲线在每一点的切向量场。对于离散曲线，这一概念可以通过<strong>离散外微积分</strong>（Discrete Exterior Calculus）自然地推广：</p>

<p>离散曲线的微分 $d\gamma$ 被定义为<strong>边向量</strong>的集合。对于相邻顶点 $\gamma_i$ 和 $\gamma_j$，其对应的边向量为：</p>

\[(d\gamma)_{ij} = \gamma_j - \gamma_i.\]

<p>这一表达式直接类比于光滑曲线中微分 $d\gamma = \frac{d\gamma}{ds}ds$ 的离散形式，其中边向量 $(d\gamma)_{ij}$ 取代了连续情形下的切向量 $\frac{d\gamma}{ds}$。</p>

<h3 id="离散切线向量">离散切线向量</h3>

<p>在光滑曲线中，切线方向由导数 $\frac{d\gamma}{ds}$ 给出。对于离散曲线，我们通过归一化<strong>边向量</strong>来定义切线，但需要特别注意离散几何与连续几何的关键差异：</p>

<p>对于离散曲线的每一条边 $ij$（连接顶点 $\gamma_i$ 和 $\gamma_j$），其<strong>离散切线向量</strong> $T_{ij}$ 定义为：</p>

<p>$
T_{ij} = \frac{(d\gamma)<em>{ij}}{|(d\gamma)</em>{ij}|} = \frac{\gamma_j - \gamma_i}{|\gamma_j - \gamma_i|}.
$</p>

<p>这表示该边的单位方向向量，与光滑曲线中切线的局部方向作用类似。</p>

<h3 id="离散法向量">离散法向量</h3>

<p>在平面离散曲线中，法向量的定义延续了光滑曲线中的直观几何思想——通过切线旋转90度得到。然而，离散特性为其带来了独特的性质和应用限制。对于离散曲线的每一条边 $ij$，其<strong>离散法向量</strong> $N_{ij}$ 由对应的单位切线 $T_{ij}$ 逆时针旋转90度生成：</p>

\[N_{ij} = \mathcal{J}T_{ij}\]

<p>在二维平面中，若 $T_{ij} = (a, b)$，则法向量为 $N_{ij} = (-b, a)$。</p>

<h3 id="正则离散曲线与离散浸入">正则离散曲线与离散浸入</h3>

<p>在离散微分几何中，为了保证离散曲线具有与光滑曲线类似的良好性质，我们需要引入<strong>正则性</strong>（regularity）的概念。对于光滑曲线 其正则性要求等价于参数化是<strong>局部单射</strong>的（无自交或尖点）。</p>

<p>离散化后，直接推广会面临新问题：</p>

<ol>
  <li><strong>边长度非零</strong>：
    <ul>
      <li>若边长度为零（$\gamma_i = \gamma_j$），则微分 $(d\gamma)_{ij} = 0$，破坏了正则性。</li>
      <li>但仅此条件不足，因相邻边可能形成零夹角。</li>
    </ul>
  </li>
  <li><strong>局部单射性</strong>：
    <ul>
      <li>更强的要求是曲线作为映射是<strong>局部单射</strong>的，即排除以下情况：
        <ul>
          <li>边重叠（如两条边共线且部分重合）。</li>
          <li>顶点自交（如一条边的端点穿过另一条边）。</li>
        </ul>
      </li>
    </ul>
  </li>
</ol>

<h3 id="离散曲率">离散曲率</h3>

<p>在《DDG(2)：Curvature》已经提到了如下的定义：</p>

<h3 id="离散平面曲线的基本定理">离散平面曲线的基本定理</h3>

<p>对于正则离散平面曲线，<strong>在刚体运动（平移/旋转）意义下，曲线由其边长度序列 ${l_{ij}}$ 和转角序列 ${\theta_i}$ 唯一确定</strong>。</p>

<p>其中：</p>
<ul>
  <li><strong>边长度</strong> $l_{ij} = |\gamma_j - \gamma_i|$</li>
  <li><strong>转角</strong> $\theta_i$ 为相邻边 $ (i-1,i) $ 与 $ (i,i+1) $ 的有向夹角（逆时针为正）。</li>
</ul>

<p>给定 ${l_{ij}}, {\theta_i}$ 和初始点 $\gamma_0$，按以下步骤重构曲线：</p>

<ol>
  <li>
    <p><strong>计算累积转角</strong></p>

    <p>从初始方向 $T_0 = (1,0)$ 开始，逐顶点计算边的全局方向角 $\varphi_i$：</p>

\[\varphi_i = \varphi_{i-1} + \theta_{i-1}, \quad \text{其中} \ \varphi_0 = 0.\]
  </li>
  <li>
    <p><strong>生成单位切向量</strong></p>

    <p>将方向角转换为单位切向量：</p>

\[T_i = (\cos \varphi_i, \sin \varphi_i).\]
  </li>
  <li>
    <p><strong>逐边积分求顶点坐标</strong></p>

    <p>通过累加边长与切向量的乘积得到顶点位置：<br />
\(\gamma_i = \gamma_{i-1} + l_{i-1,i} \cdot T_{i-1}.\)</p>
  </li>
</ol>

<h4 id="示例演示">示例演示</h4>

<p><strong>给定数据</strong>：</p>

<ul>
  <li>边长度：$l_{01} = 1, l_{12} = 1, l_{23} = 1$</li>
  <li>转角：$\theta_0 = 0°, \theta_1 = 90°, \theta_2 = 0°$</li>
  <li>初始点：$\gamma_0 = (0,0)$</li>
</ul>

<p><strong>重建过程</strong>：</p>

<ol>
  <li>
    <p>计算方向角：</p>

    <ul>
      <li>$\varphi_0 = 0°$</li>
      <li>$\varphi_1 = 0° + 0° = 0°$</li>
      <li>$\varphi_2 = 0° + 90° = 90°$</li>
      <li>$\varphi_3 = 90° + 0° = 90°$</li>
    </ul>
  </li>
  <li>
    <p>切向量：</p>

    <ul>
      <li>$T_0 = (1,0)$</li>
      <li>$T_1 = (1,0)$</li>
      <li>$T_2 = (0,1)$</li>
      <li>$T_3 = (0,1)$</li>
    </ul>
  </li>
  <li>
    <p>顶点坐标：</p>
    <ul>
      <li>$\gamma_1 = (0,0) + 1 \cdot (1,0) = (1,0)$</li>
      <li>$\gamma_2 = (1,0) + 1 \cdot (0,1) = (1,1)$</li>
      <li>$\gamma_3 = (1,1) + 1 \cdot (0,1) = (1,2)$</li>
    </ul>
  </li>
</ol>

<p>最终曲线为直角折线，验证定理正确性。</p>

<h3 id="离散whitney-graustein定理">离散Whitney-Graustein定理</h3>

<p>对于<strong>局部单射的正则离散平面曲线</strong>，其<strong>正则同伦类</strong>（即在不违反局部单射性的连续变形下的等价类）完全由离散转向数（Discrete Turning Number）决定，完美类比于光滑曲线的Whitney-Graustein定理。</p>

<table>
  <thead>
    <tr>
      <th>方法</th>
      <th>提出者</th>
      <th>核心思想</th>
      <th>适用场景</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>构造性算法</strong></td>
      <td>Mehlhorn &amp; Yap (1991)</td>
      <td>通过案例分析将曲线逐步变形为标准多边形</td>
      <td>计算几何实现</td>
    </tr>
    <tr>
      <td><strong>凸多面体法</strong></td>
      <td>Pinkall (1994)</td>
      <td>将曲线提升到三维空间构造凸包，利用投影性质</td>
      <td>理论分析</td>
    </tr>
  </tbody>
</table>

<p><strong>共同策略</strong>：</p>
<ol>
  <li>将目标曲线变形为<strong>标准参考曲线</strong>（如正多边形）。</li>
  <li>通过组合两条曲线到参考曲线的路径得到同伦。</li>
</ol>

<h3 id="离散空间曲线">离散空间曲线</h3>

<p>同理，<strong>离散空间曲线</strong>是三维空间中的分段线性参数化曲线，由有序顶点序列 ${\gamma_i} \in \mathbb{R}^3$ 通过直线段连接而成，其数学表示为：</p>

\[\gamma(s) = (1-t)\gamma_i + t\gamma_{i+1}, \quad t \in [0,1], \ s \in [s_i,s_{i+1}].\]

<h3 id="离散空间曲线基本定理">离散空间曲线基本定理</h3>

<p>在刚体运动（平移+旋转）意义下，<strong>正则离散空间曲线</strong>由以下数据唯一确定：</p>

<ol>
  <li><strong>边长度</strong> ${l_{ij}}$（替代弧长参数）</li>
  <li><strong>顶点曲率</strong> ${\kappa_i}$（相邻边外角）</li>
  <li><strong>边挠率</strong> ${\tau_{ij}}$（法向量扭转角）</li>
</ol>

<p>与光滑理论的类比</p>

<table>
  <thead>
    <tr>
      <th>光滑曲线</th>
      <th>离散曲线</th>
      <th>几何意义</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>弧长参数 $s$</td>
      <td>边长度 $l_{ij}$</td>
      <td>局部尺度度量</td>
    </tr>
    <tr>
      <td>曲率 $\kappa(s)$</td>
      <td>顶点外角 $\kappa_i$</td>
      <td>局部弯曲程度</td>
    </tr>
    <tr>
      <td>挠率 $\tau(s)$</td>
      <td>边扭转角 $\tau_{ij}$</td>
      <td>局部扭转程度</td>
    </tr>
  </tbody>
</table>

<h4 id="曲线重构算法">曲线重构算法</h4>

<p><strong>输入</strong>：</p>
<ul>
  <li>边长度 ${l_{01}, l_{12}, …, l_{n-1,n}}$</li>
  <li>顶点曲率 ${\kappa_1, \kappa_2, …, \kappa_{n-1}}$</li>
  <li>边挠率 ${\tau_{01}, \tau_{12}, …, \tau_{n-1,n}}$</li>
  <li>初始条件：$\gamma_0 \in \mathbb{R}^3$, 初始标架 $(T_0, N_0, B_0)$</li>
</ul>

<p><strong>逐边递推</strong>：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
       <span class="c1"># 计算下一顶点位置
</span>       <span class="n">γ</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">γ</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
       
       <span class="c1"># 曲率旋转：绕当前法向量N旋转κ_i
</span>       <span class="n">R_κ</span> <span class="o">=</span> <span class="nf">rotation_matrix</span><span class="p">(</span><span class="n">N</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">κ</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
       <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">R_κ</span> <span class="o">@</span> <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
       <span class="n">B_temp</span> <span class="o">=</span> <span class="n">R_κ</span> <span class="o">@</span> <span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
       
       <span class="c1"># 挠率旋转：绕新切向量T[i+1]旋转τ_i
</span>       <span class="n">R_τ</span> <span class="o">=</span> <span class="nf">rotation_matrix</span><span class="p">(</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">τ</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
       <span class="n">N</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">R_τ</span> <span class="o">@</span> <span class="n">N</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
       <span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">R_τ</span> <span class="o">@</span> <span class="n">B_temp</span>
</code></pre></div></div>

<h3 id="曲率流">曲率流</h3>

<p>曲率流描述曲线随时间演化，其运动速度由曲率函数决定：</p>

\[\frac{\partial \gamma}{\partial t} = V(\kappa)N\]

<p>其中 $V(\kappa)$ 是曲率 $\kappa$ 的标量函数，$N$ 为单位法向量。</p>

<h3 id="length-shortening-flow">Length Shortening Flow</h3>

<p>长度缩短流是最基础的曲率流，其演化方程由曲线长度的变分直接导出：</p>

\[\frac{\partial \gamma}{\partial t} = \kappa N\]

<p>其中曲率 $\kappa$ 和法向量 $N$ 共同决定了曲线的收缩速度。</p>

<ol>
  <li><strong>凸性保持</strong>
    <ul>
      <li>初始凸的曲线保持凸性</li>
      <li>非凸曲线会产生拐点（根据Gage-Hamilton定理）</li>
    </ul>
  </li>
  <li><strong>封闭曲线演化</strong><br />
| 阶段 | 现象 | 数学描述 |<br />
|——|——|———-|<br />
| 早期 | 高频振荡快速平滑 | $|\kappa|_{max}$ 递减 |<br />
| 中期 | 渐近圆形化 | $\text{偏心率} \to 0$ |<br />
| 末期 | 收敛到圆点 | $\text{面积} \sim O(t_f-t)$ |</li>
</ol>

<h4 id="gage-grayson-hamilton">Gage-Grayson-Hamilton</h4>

<p>质心守恒定理
渐近圆形化（Round Points）
嵌入性保持（Embeddedness）</p>

<h3 id="离散长度缩短流">离散长度缩短流</h3>

<p>给定连续方程：</p>

\[\frac{d}{dt} \gamma(s, t) = -\kappa(s, t) N(s, t)\]

<p>离散化为显式欧拉格式，这里的$\tau$是离散下的$\Delta t$：</p>

\[\frac{\gamma^{k+1}(s) - \gamma^k(s)}{\tau} = -\kappa^k(s) N^k(s)\]

<p>最终得到顶点更新公式：</p>

\[\gamma_i^{k+1} = \gamma_i^k - \tau \kappa_i^k N_i^k\]

<h3 id="elastic-flow-弹性流">Elastic Flow 弹性流</h3>

<p>弹性流以<strong>弯曲能最小化</strong>为目标，其连续形式能量泛函为欧拉-伯努利能量：</p>

\[E(\gamma) = \int_\gamma \kappa^2 \, ds\]

<p>对应的梯度流方程为：</p>

\[\frac{\partial \gamma}{\partial t} = -\left( \frac{\partial^2 \kappa}{\partial s^2} + \frac{1}{2}\kappa^3 \right)N\]

<h4 id="isometric-elastic-flow-等距弹性流">Isometric Elastic Flow 等距弹性流</h4>

<p>通过<strong>直接调整离散曲率</strong>（转角）实现曲线平滑，同时严格保持边长不变。其优势在于：</p>
<ul>
  <li><strong>刚性保持</strong>：不改变边长度（等距约束）</li>
  <li><strong>数值稳定性</strong>：避免显式处理高阶导数</li>
  <li><strong>几何直观</strong>：曲率缩放对应物理上的”弯曲刚度”调节</li>
</ul>

<p>曲线还有很多其他的应用，具体可以查看slides以及对应的videos，比如：</p>

<ol>
  <li><strong>弹性杆 (Elastic Rods)</strong>
    <ul>
      <li><strong>核心量</strong>：曲率κ + 挠率τ</li>
      <li><strong>能量</strong>：$E = \int (\alpha \kappa^2 + \beta \tau^2) ds$</li>
      <li><strong>应用</strong>：头发/电缆模拟</li>
    </ul>
  </li>
  <li><strong>粘性丝线 (Viscous Threads)</strong>
    <ul>
      <li><strong>核心量</strong>：曲率κ + 黏度η</li>
      <li><strong>方程</strong>：$\gamma_t = \eta (\kappa N)_t$</li>
      <li><strong>特性</strong>：拉伸时变细，松弛时回弹</li>
    </ul>
  </li>
  <li><strong>解结算法 (Untangling Knots)</strong>
    <ul>
      <li><strong>方法</strong>：Möbius能量最小化</li>
      <li>
        <table>
          <tbody>
            <tr>
              <td><strong>能量</strong>：$E = \iint \frac{1}{</td>
              <td>\gamma(s)-\gamma(t)</td>
              <td>^2} ds dt$</td>
            </tr>
          </tbody>
        </table>
      </li>
      <li><strong>用途</strong>：分子生物学/拓扑优化</li>
    </ul>
  </li>
  <li><strong>排斥曲线 (Repulsive Curves)</strong>
    <ul>
      <li><strong>核心</strong>：几何排斥势 $E = \sum e^{-d_{ij}^2/\sigma}$</li>
      <li><strong>优势</strong>：避免自交同时保持光滑</li>
    </ul>
  </li>
  <li><strong>烟环流 (Smoke Ring Flow)</strong>
    <ul>
      <li><strong>方程</strong>：$\gamma_t = \kappa B$ (Binormal流)</li>
      <li><strong>特性</strong>：保持涡丝环量</li>
      <li><strong>离散</strong>：Hashimoto离散格式</li>
    </ul>
  </li>
  <li><strong>气泡环与墨水晶灯 (Bubble Rings &amp; Ink Chandeliers)</strong>
    <ul>
      <li><strong>现象</strong>：流体-固体耦合中的三维涡环</li>
      <li><strong>关键</strong>：浸入边界法 + 表面张力模型</li>
    </ul>
  </li>
</ol>

<h2 id="总结">总结</h2>

<ul>
  <li><strong>离散曲线</strong>：由顶点序列 ${\gamma_i}$ 和连接它们的直线段（边）构成的分段线性曲线。</li>
  <li><strong>参数化</strong>：$γ(s) = (1-t)γ_i + tγ_{i+1}$，其中 $t \in [0,1]$ 为局部参数。</li>
  <li><strong>正则性</strong>：要求无自交、无退化边（边长 $&gt;0$），且局部单射。</li>
  <li><strong>长度缩短流</strong>：$\gamma_t = -\kappa N$
    <ul>
      <li>特性：收缩曲线，凸性保持，封闭曲线收敛到圆点（Gage-Grayson-Hamilton定理）。</li>
    </ul>
  </li>
  <li><strong>弹性流</strong>：最小化弯曲能 $E = \int \kappa^2 ds$，方程为 $\gamma_t = -(\kappa_{ss} + \frac{1}{2}\kappa^3)N$。</li>
  <li><strong>等距弹性流</strong>：缩放曲率但保持边长不变，适用于刚性变形。</li>
</ul>]]></content><author><name></name></author><category term="DDG" /><category term="Geometry" /><summary type="html"><![CDATA[平面中的离散曲线]]></summary></entry><entry><title type="html">DDG Smooth Surfaces</title><link href="https://pasu.github.io/blog/2025/Smooth_Surfaces_1/" rel="alternate" type="text/html" title="DDG Smooth Surfaces" /><published>2025-06-11T10:27:00+00:00</published><updated>2025-06-11T10:27:00+00:00</updated><id>https://pasu.github.io/blog/2025/Smooth_Surfaces_1</id><content type="html" xml:base="https://pasu.github.io/blog/2025/Smooth_Surfaces_1/"><![CDATA[<h2 id="光滑曲面">光滑曲面</h2>

<p>在上一部分中，我们研究了一维曲线的几何性质，包括光滑曲线（如参数化曲线、弧长参数化、曲率等）和离散曲线（如折线、离散曲率等）。现在，我们将视角扩展到二维曲面，探讨如何将曲线的概念推广到更高维度的几何对象。</p>

<h4 id="局部视角">局部视角</h4>

<p>最初，我们通过<strong>局部几何</strong>来描述曲面。与曲线类似，曲面的<strong>参数化</strong>提供了一种<strong>外在描述</strong>，即曲面如何嵌入在空间中。例如，给定一个二维区域 ( U \subset \mathbb{R}^2 ) 和一个映射 ( f: U \to \mathbb{R}^3 )，我们可以通过 ( f ) 的像 ( f(U) ) 来表示曲面。这种描述依赖于曲面的具体位置和形状在空间中的表现。</p>

<h4 id="全局视角">全局视角</h4>

<p>通过将多个局部参数化片段拼接在一起，可以描述整个曲面。这种<strong>全局描述</strong>仍然是外在的，因为它依赖于曲面在空间中的嵌入方式。例如，球面可以通过多个局部参数化（如经纬度坐标）覆盖，最终组合成一个完整的几何对象。</p>

<h3 id="内蕴视角-intrinsic">内蕴视角 (Intrinsic)</h3>

<p>从全局描述出发，我们可以进一步“抛弃”曲面的空间嵌入，仅保留其<strong>内蕴几何</strong>。此时，曲面的形状信息由<strong>黎曼度量</strong>（Riemannian metric）编码，它记录了曲面上每一点的切空间中的长度和角度关系。</p>

<ul>
  <li>黎曼度量 ( g(X, Y) ) 是一个光滑变化的双线性形式，满足正定性。</li>
  <li>通过度量，可以计算曲线的长度、区域的面积、切向量的夹角等，而无需知道曲面如何嵌入更高维空间。</li>
  <li><strong>关键思想</strong>：内蕴几何不依赖于外部空间，甚至可以描述无法嵌入低维空间的几何对象（如双曲平面）。</li>
</ul>

<h4 id="离散视角">离散视角</h4>

<p>在离散几何中，曲面的几何性质可以通过<strong>边长</strong>（内蕴）而非顶点坐标（外在）来定义。例如，三角形网格的几何完全由边长和夹角决定，无需显式指定顶点在空间中的位置。</p>

<p>这种从局部到全局再到内蕴的视角，不仅适用于光滑曲面，也为离散几何的研究提供了重要工具。</p>

<h3 id="参数化曲面parameterized-surface">参数化曲面（Parameterized Surface）</h3>

<p>一个<strong>参数化曲面</strong>是指从二维区域 $ U \subset \mathbb{R}^2 $ 到空间 $ \mathbb{R}^n $的映射：</p>

\[f: U \to \mathbb{R}^n, \quad (u, v) \mapsto f(u, v)\]

<p>其中：</p>
<ul>
  <li>$ U $ 是参数域（如单位圆盘、矩形等）。</li>
  <li>$ f $ 的像 $ f(U) $ 称为曲面的<strong>图像（image）</strong>，表示曲面在空间中的实际形状。</li>
</ul>

<p>通常，平滑曲面具有如下的性质：<strong>连续性（Continuous）</strong>，<strong>可微性（Differentiable）</strong>，<strong>光滑性（Smooth, $ C^\infty $）</strong>。</p>

<h4 id="示例鞍面saddle-surface">示例：鞍面（Saddle Surface）</h4>

<p>鞍面（双曲抛物面）的标准参数化可表示为：</p>

\[f(u, v) = (u, v, u^2 - v^2), \quad \text{其中} \quad (u, v) \in U \subset \mathbb{R}^2\]

<p>这里，参数域 $ U $ 通常取单位圆盘 $ U = {(u, v) \mid u^2 + v^2 \leq 1} $ 或其他有界区域。</p>

<h3 id="曲面的重新参数化reparameterization">*曲面的重新参数化（Reparameterization）</h3>

<p>重新参数化是指用<strong>不同的参数域映射</strong>描述<strong>同一个几何曲面</strong>。例如，鞍面可以表示为：</p>

\[f(u,v) = (u, v, u^2 - v^2) \quad \text{或} \quad \hat{f}(s,t) = (s+t, s-t, 4st)\]

<p>尽管参数形式不同，但它们的像（即实际曲面）完全相同。</p>

<h4 id="重新参数化的意义">重新参数化的意义</h4>

<ol>
  <li><strong>数学灵活性</strong>
    <ul>
      <li>某些计算（如积分、曲率）在特定参数化下更简单（如保角参数化）。</li>
    </ul>
  </li>
  <li><strong>应用需求</strong>
    <ul>
      <li>在计算机图形学中，不同的参数化可能影响纹理映射的质量或数值模拟的稳定性。</li>
    </ul>
  </li>
  <li><strong>几何不变性</strong>
    <ul>
      <li>曲面的本质属性（如高斯曲率）与参数化无关，但显式计算依赖参数选择。</li>
    </ul>
  </li>
</ol>

<p>重新参数化揭示了曲面描述中的自由度，既是理论研究的工具，也是实际应用中需解决的难题（如形状匹配）。理解这一概念有助于区分几何的<strong>本质属性</strong>与<strong>描述方式</strong>的差异。</p>

<h3 id="嵌入曲面embedded-surface">嵌入曲面（Embedded Surface）</h3>

<p>一个<strong>嵌入曲面</strong>是指通过参数化映射 $ f: U \to \mathbb{R}^3 $ 将二维区域 $ U $ <strong>无自交</strong>、<strong>无撕裂</strong>地放入三维空间，且保持原域的基本拓扑结构。</p>
<ul>
  <li><strong>关键要求</strong>：曲面不能“穿过自身”（无自交），也不能出现“粘合”（如将圆柱两端粘合为环面时需特殊处理）。</li>
</ul>

<p>参数化 $ f $ 是一个<strong>嵌入</strong>，若满足：</p>
<ol>
  <li><strong>连续双射</strong>：$ f $ 是 $ U $ 到 $ f(U) $ 的一一对应连续映射。</li>
  <li><strong>逆映射连续</strong>：$ f^{-1}: f(U) \to U $ 也连续。</li>
</ol>

<h3 id="曲面微分differential-of-a-surface">曲面微分（Differential of a Surface）</h3>

<p>曲面的微分 $ \mathrm{d}f $ 是一个关键工具，它描述了<strong>参数域上的切向量</strong>如何被“推前”（push forward）到<strong>三维空间的切平面</strong>中。</p>

<p>$ \mathrm{d}f $ 将参数平面的“微小箭头” $ X $ 拉伸、旋转为曲面上的切向量，揭示了曲面的局部线性近似。</p>

<h4 id="坐标表示differential-in-coordinates">坐标表示（Differential in Coordinates）</h4>

<p>曲面的微分 $ \mathrm{d}f $ 可以显式表示为参数化的<strong>外导数</strong>，它将参数域 $ U \subset \mathbb{R}^2 $ 上的向量场 $ X $ 映射到曲面切空间中的向量 $ \mathrm{d}f(X) $。</p>

<p>给定参数化 $ f: U \to \mathbb{R}^3 $，其微分 $ \mathrm{d}f $ 可展开为：</p>

\[\mathrm{d}f = \frac{\partial f}{\partial u} \mathrm{d}u + \frac{\partial f}{\partial v} \mathrm{d}v\]

<p>其中：</p>
<ul>
  <li>$ \mathrm{d}u $ 和 $ \mathrm{d}v $ 是参数域的<strong>对偶基</strong>（1-形式），表示沿 $ u $、$ v $ 方向的微小变化。</li>
  <li>$ \frac{\partial f}{\partial u} $ 和 $ \frac{\partial f}{\partial v} $ 是曲面的<strong>切向量</strong>（Jacobian 矩阵的列）。</li>
</ul>

<p><strong>几何解释</strong>：</p>

<p>$ \mathrm{d}f $ 将参数平面的向量 $ X = a \partial_u + b \partial_v $ 线性组合为曲面切向量：</p>

\[\mathrm{d}f(X) = a \frac{\partial f}{\partial u} + b \frac{\partial f}{\partial v}\]

<h5 id="推前向量场push-forward">推前向量场（Push Forward）</h5>

<p>若参数域上有向量场 $ X = \alpha(u,v) \partial_u + \beta(u,v) \partial_v $，则其推前 $ \mathrm{d}f(X) $ 为：</p>

\[\mathrm{d}f(X) = \alpha(u,v) \frac{\partial f}{\partial u} + \beta(u,v) \frac{\partial f}{\partial v}\]

<h5 id="鞍面示例">鞍面示例</h5>

<p>考虑鞍面 $ f(u,v) = (u, v, u^2 - v^2) $：</p>

<ol>
  <li>
    <p><strong>求偏导</strong>：</p>

\[\frac{\partial f}{\partial u} = (1, 0, 2u), \quad \frac{\partial f}{\partial v} = (0, 1, -2v)\]
  </li>
  <li>
    <p><strong>向量场推前</strong>：对 $ X = \frac{3}{4} (\partial_u - \partial_v) $，有：</p>

\[\mathrm{d}f(X) = \frac{3}{4} \left( (1,0,2u) - (0,1,-2v) \right) = \frac{3}{4} (1, -1, 2(u + v))\]

    <p>在点 $ (u,v) = (0,0) $ 处，$ \mathrm{d}f(X) = \left( \frac{3}{4}, -\frac{3}{4}, 0 \right) $。</p>
  </li>
</ol>

<h3 id="雅可比矩阵jacobian">雅可比矩阵（Jacobian）</h3>

<p>对于映射 $ f: \mathbb{R}^n \to \mathbb{R}^m $，其<strong>雅可比矩阵</strong> $ J_f $ 是一个 $ m \times n $ 矩阵，表示 $ f $ 的微分 $ \mathrm{d}f $ 在标准基下的线性变换：</p>

\[J_f := 
\begin{bmatrix}
\frac{\partial f^1}{\partial x^1} &amp; \cdots &amp; \frac{\partial f^1}{\partial x^n} \\
\vdots &amp; \ddots &amp; \vdots \\
\frac{\partial f^m}{\partial x^1} &amp; \cdots &amp; \frac{\partial f^m}{\partial x^n}
\end{bmatrix}\]

<p>其中 $ f^1, \ldots, f^m $ 是 $ f $ 的分量函数，$ x^1, \ldots, x^n $ 是 $ \mathbb{R}^n $ 的坐标。</p>

<h4 id="几何意义">几何意义</h4>

<ol>
  <li>
    <p><strong>微分的作用</strong>：<br />
雅可比矩阵将输入空间 $ \mathbb{R}^n $ 的切向量 $ X $ 线性映射到输出空间 $ \mathbb{R}^m $ 的切向量：</p>

\[\mathrm{d}f(X) = J_f X\]

    <ul>
      <li><strong>曲线</strong>（$ n=1 $）：$ J_f $ 是切向量 $ \gamma’(t) $。</li>
      <li><strong>曲面</strong>（$ n=2, m=3 $）：$ J_f $ 的列向量张成切平面（如 $ \partial_u f, \partial_v f $）。</li>
    </ul>
  </li>
  <li>
    <p><strong>局部线性近似</strong>：</p>

    <p>$ J_f $ 描述了 $ f $ 在一点附近的<strong>最佳线性逼近</strong>，即：</p>

\[f(p + h) \approx f(p) + J_f h \quad \text{（当 } \|h\| \to 0\text{）}\]
  </li>
</ol>

<h3 id="浸入曲面immersed-surface">浸入曲面（Immersed Surface）</h3>

<p>一个参数化映射 $ f: U \to \mathbb{R}^n $ 称为<strong>浸入（immersion）</strong>，如果其微分 $ \mathrm{d}f $ 在每一点 $ p \in U $ 都是<strong>非退化的</strong>，即：</p>

\[\mathrm{d}f(X)|_p = 0 \iff X|_p = 0 \quad \forall p \in U.\]

<ul>
  <li><strong>几何意义</strong>：曲面的切空间在每点都保持二维性，没有“压扁”或“退化”。</li>
  <li><strong>关键性质</strong>：即使曲面全局自交（如自交的 Klein 瓶），局部仍可定义切平面、法向量等几何量。</li>
</ul>

<h4 id="示例球面参数化">示例：球面参数化</h4>

<p>考虑球面的标准参数化：</p>

\[f(u,v) = (\cos u \sin v, \sin u \sin v, \cos v), \quad v \in (0, \pi)\]

<p>其微分 ( \mathrm{d}f ) 的矩阵表示为：</p>

\[J_f = 
\begin{bmatrix}
-\sin u \sin v &amp; \cos u \cos v \\
\cos u \sin v &amp; \sin u \cos v \\
0 &amp; -\sin v
\end{bmatrix}\]

<ul>
  <li><strong>问题</strong>：当 $ v = 0 $ 或 $ v = \pi $（两极）时，$ \frac{\partial f}{\partial u} = (0, 0, 0) $，微分退化 （无法向东西或南北行走）。</li>
  <li><strong>结论</strong>：球面参数化在<strong>两极不是浸入</strong>（无法定义东西方向的切向量）。</li>
</ul>

<p>浸入是微分几何中“最弱”的光滑性条件，允许全局复杂性（如自交）但保留局部可计算性。理解浸入有助于处理实际中的非理想曲面（如扫描重建的噪声模型）。</p>

<h4 id="浸入immersion与嵌入embedding的对比">浸入（Immersion）与嵌入（Embedding）的对比</h4>

<table>
  <thead>
    <tr>
      <th><strong>特性</strong></th>
      <th><strong>浸入（Immersion）</strong></th>
      <th><strong>嵌入（Embedding）</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>自交性</strong></td>
      <td>允许全局自交（如 Klein 瓶在 $ \mathbb{R}^3 $）</td>
      <td>禁止自交（如球面、环面）</td>
    </tr>
    <tr>
      <td><strong>局部性质</strong></td>
      <td>每点处微分 $ \mathrm{d}f $ 满秩，切空间二维</td>
      <td>浸入 + 全局单射（无自交）</td>
    </tr>
    <tr>
      <td><strong>拓扑保持</strong></td>
      <td>仅局部同胚于平面</td>
      <td>全局同胚于参数域的拓扑</td>
    </tr>
    <tr>
      <td><strong>物理合理性</strong></td>
      <td>非物理（自交）</td>
      <td>物理可实现（无自交）</td>
    </tr>
  </tbody>
</table>

<h3 id="正则同伦regular-homotopy">正则同伦（Regular Homotopy）</h3>

<p>正则同伦描述了两个浸入曲面 $ f_0, f_1: U \to \mathbb{R}^3 $ 之间通过一系列“良好形变”相互转化的过程。具体表现为：</p>

<p>存在连续映射 $ h: U \times [0,1] \to \mathbb{R}^3 $，使得：</p>
<ol>
  <li><strong>边界条件</strong>：$ h(x,0) = f_0(x) $，$ h(x,1) = f_1(x) $；</li>
  <li><strong>浸入保持</strong>：对任意固定 $ t \in [0,1] $，映射 $ h(\cdot, t) $ 仍是浸入（即微分 $ d h_t $ 处处满秩）。</li>
</ol>

<p><strong>几何意义</strong>：形变过程中不允许曲面出现“捏缩”（pinches）、“尖锐褶皱”（sharp creases）或“停顿”（stops），始终保持局部光滑性。</p>

<h3 id="圆与球面的外翻circle-eversion-vs-sphere-eversion">圆与球面的外翻（Circle Eversion vs. Sphere Eversion）</h3>

<ul>
  <li>平面闭合曲线的<strong>正则同伦类</strong>由其<strong>环绕数（Turning Number）</strong> $ k $ 决定。</li>
  <li><strong>环绕数</strong>：单位切向量绕原点的旋转次数（逆时针为 $ +1 $，顺时针为 $ -1 $）。</li>
  <li><strong>结论</strong>：
    <ul>
      <li>标准圆 $ k=+1 $ 无法通过浸入形变（正则同伦）变为 $ k=-1 $ 的“内翻圆”。</li>
      <li>二维平面上不允许曲线自交时穿过自身（需第三维空间）。</li>
    </ul>
  </li>
</ul>

<p><strong>反直觉的突破</strong></p>
<ul>
  <li>在三维空间中，球面可通过<strong>自交浸入</strong>实现外翻（Inside-Out），且过程中始终保持光滑（正则同伦）。</li>
  <li><strong>关键区别</strong>：三维空间提供了额外的自由度，允许自交曲线动态移动并最终消除。</li>
</ul>

<ol>
  <li><strong>历史与人物</strong>
    <ul>
      <li><strong>Bernhard Morin（1976）</strong>：首位给出具体外翻方法的数学家（虽本人失明，但通过触觉想象完成）。</li>
      <li><em>Outside In</em>（1994）：几何中心制作的经典动画，直观展示外翻过程。</li>
      <li><strong>Optiverse</strong>：Francis、Kusner、Sullivan 提出的“最优”外翻路径（能量最小化）。</li>
    </ul>
  </li>
  <li><strong>外翻步骤（直观描述）</strong>
    <ul>
      <li><strong>阶段1</strong>：引入“凹陷”使球面自交为环形。</li>
      <li><strong>阶段2</strong>：逐步推动自交环向两极移动并消失。</li>
      <li><strong>结果</strong>：初始外表面最终变为内表面。</li>
    </ul>
  </li>
</ol>

<blockquote>
  <p><em>“我们的空间想象源于手的操作…而非视觉。”</em><br />
——Bernhard Morin（以触觉“看见”几何的盲人数学家）</p>
</blockquote>

<p>从圆的不可外翻到球面的可外翻，揭示了维度对几何形变的深刻影响。这一现象不仅是微分拓扑的经典课题，也是连接数学理论与可视化技术的桥梁。</p>

<h3 id="黎曼度量riemannian-metric">黎曼度量（Riemannian Metric）</h3>

<p>黎曼度量 $ g $ 是光滑流形（如曲线、曲面）上的一种结构，用于测量<strong>切向量的长度</strong>和<strong>夹角</strong>。具体表现为：</p>

<ul>
  <li>
    <p>对每一点 $ p $ 的切空间 $ T_p M $，$ g $ 给出一个正定对称双线性形式：</p>

\[g_p: T_p M \times T_p M \to \mathbb{R}, \quad (X, Y) \mapsto g_p(X, Y).\]
  </li>
</ul>

<p>黎曼度量 $ g $ 不同于距离函数 $ d(x, y) $，后者是全局的测地线长度。</p>

<ol>
  <li><strong>长度与角度</strong>：
    <ul>
      <li>向量 $ X $ 的长度：$ |X| = \sqrt{g(X, X)} $。</li>
      <li>两向量 $ X, Y $ 的夹角：$ \theta = \arccos\left( \frac{g(X, Y)}{|X| |Y|} \right) $。</li>
    </ul>
  </li>
  <li><strong>局部几何</strong>：$ g $ 决定了曲面的<strong>第一基本形式</strong>（如曲率、测地线）。</li>
</ol>

<h3 id="浸入诱导的度量metric-induced-by-an-immersion">浸入诱导的度量（Metric Induced by an Immersion）</h3>

<p>对于浸入（immersion）$ f: U \to \mathbb{R}^n $，如何正确测量其参数域 $ U \subset \mathbb{R}^2 $ 上切向量 $ X, Y $ 的内积？</p>

<ul>
  <li><strong>错误做法</strong>：直接使用参数域 $ U $ 的欧氏内积 $ \langle X, Y \rangle_{\mathbb{R}^2} $。</li>
  <li><strong>原因</strong>：参数域的平面内积无法反映曲面在空间中的实际几何（如拉伸或弯曲）。</li>
</ul>

<p><strong>正确方法：诱导度量（Induced Metric）</strong></p>

<p>定义曲面上的内积为推前切向量的欧氏内积：</p>

\[g(X, Y) := \langle \mathrm{d}f(X), \mathrm{d}f(Y) \rangle_{\mathbb{R}^n},\]

<p>其中 $ \mathrm{d}f $ 是微分（雅可比矩阵），将参数域的向量 $ X $ 映射到曲面的切空间。</p>

<h3 id="诱导度量induced-metric的矩阵表示与计算">诱导度量（Induced Metric）的矩阵表示与计算</h3>

<p>诱导度量 $ g $ 可以表示为一个对称正定的 $ 2 \times 2 $ 矩阵 $ \mathbf{I} $，称为<strong>第一基本形式</strong>。其定义如下：</p>

<p>$
g(X, Y) = X^\top \mathbf{I} Y,
$</p>

<p>其中：</p>
<ul>
  <li>$ X, Y $ 是参数域 $ U \subset \mathbb{R}^2 $ 上的切向量。</li>
  <li>
    <p>矩阵 $ \mathbf{I} $ 的分量为：</p>

\[I_{ij} = g\left( \frac{\partial}{\partial x^i}, \frac{\partial}{\partial x^j} \right) = \left\langle \mathrm{d}f\left( \frac{\partial}{\partial x^i} \right), \mathrm{d}f\left( \frac{\partial}{\partial x^j} \right) \right\rangle.\]
  </li>
</ul>

<p><strong>关键点</strong>：</p>
<ul>
  <li>$ \mathbf{I} $ 通过曲面的微分 $ \mathrm{d}f $ 定义，编码了参数化导致的拉伸和扭曲。</li>
  <li>
    <p>矩阵 $ \mathbf{I} $ 也可以由雅可比矩阵 $ J_f $ 计算：</p>

\[\mathbf{I} = J_f^\top J_f.\]
  </li>
</ul>

<h4 id="saddle-示例">Saddle 示例</h4>

<p><strong>参数化曲面</strong>：</p>

\[f(u, v) = (u, v, u^2 - v^2), \quad (u, v) \in U \subset \mathbb{R}^2.\]

<p><strong>步骤1：计算微分 $ \mathrm{d}f $ 和雅可比矩阵 $ J_f $</strong></p>

<ul>
  <li>
    <p>切向量的偏导数：</p>

\[\frac{\partial f}{\partial u} = (1, 0, 2u), \quad \frac{\partial f}{\partial v} = (0, 1, -2v).\]
  </li>
  <li>
    <p>雅可比矩阵：</p>

\[J_f = 
\begin{bmatrix}
1 &amp; 0 \\
0 &amp; 1 \\
2u &amp; -2v
\end{bmatrix}.\]
  </li>
</ul>

<p><strong>步骤2：计算第一基本形式 $ \mathbf{I} = J_f^\top J_f $</strong></p>

\[\mathbf{I} = 
\begin{bmatrix}
1 &amp; 0 &amp; 2u \\
0 &amp; 1 &amp; -2v
\end{bmatrix}
\begin{bmatrix}
1 &amp; 0 \\
0 &amp; 1 \\
2u &amp; -2v
\end{bmatrix}
= 
\begin{bmatrix}
1 + 4u^2 &amp; -4uv \\
-4uv &amp; 1 + 4v^2
\end{bmatrix}.\]

<p><strong>分量解释</strong>：</p>
<ul>
  <li>$ E = 1 + 4u^2 $：$ u $-方向的拉伸系数（含 $ 2u $ 的扭曲项）。</li>
  <li>$ F = -4uv $：$ u $ 和 $ v $-方向的耦合项（反映曲面的非正交性）。</li>
  <li>$ G = 1 + 4v^2 $：$ v $-方向的拉伸系数。</li>
</ul>

<h5 id="3-几何意义"><strong>3. 几何意义</strong></h5>

<ul>
  <li>
    <p><strong>长度计算</strong>：向量 $ X = (a, b)^\top $ 的长度为：</p>

\[\|X\| = \sqrt{g(X, X)} = \sqrt{a^2 (1 + 4u^2) + 2ab (-4uv) + b^2 (1 + 4v^2)}.\]
  </li>
  <li>
    <p><strong>角度计算</strong>：两向量 $ X, Y $ 的夹角 $ \theta $ 满足：</p>

\[\cos \theta = \frac{g(X, Y)}{\|X\| \|Y\|} = \frac{X^\top \mathbf{I} Y}{\sqrt{X^\top \mathbf{I} X \cdot Y^\top \mathbf{I} Y}}.\]
  </li>
</ul>

<p>在点 $ (u, v) = (1, 0) $ 处，度量矩阵为：</p>

\[\mathbf{I} = 
\begin{bmatrix}
5 &amp; 0 \\
0 &amp; 1
\end{bmatrix}.\]

<ul>
  <li>向量 $ X = (1, 0)^\top $ 的长度为 $ \sqrt{5} $，而 $ Y = (0, 1)^\top $ 的长度为 $ 1 $。</li>
  <li>此时 $ g(X, Y) = 0 $，说明 $ X $ 和 $ Y $ 在该点正交。</li>
</ul>

<p>诱导度量 ( \mathbf{I} ) 将曲面的内在几何从嵌入空间“拉回”到参数域，是计算长度、角度、曲率的基础。</p>

<h3 id="共形坐标conformal-coordinates">共形坐标（Conformal Coordinates）</h3>

<p>一个参数化 $ f: U \subset \mathbb{R}^2 \to \mathbb{R}^3 $ 是<strong>共形的</strong>（conformal），如果其诱导的黎曼度量 $ \mathbf{I} $ 满足：</p>

\[\mathbf{I} = \lambda(u,v) \begin{bmatrix} 1 &amp; 0 \\ 0 &amp; 1 \end{bmatrix}, \quad \lambda(u,v) &gt; 0.\]

<ul>
  <li><strong>几何意义</strong>：曲面的度量是参数域平面度量的<strong>标量倍</strong>，仅通过一个函数 $ \lambda(u,v) $ 缩放。</li>
  <li><strong>核心性质</strong>：
    <ul>
      <li><strong>保角性</strong>：曲面上任意两向量的夹角与其在参数域中的夹角相同。</li>
      <li><strong>长度非均匀缩放</strong>：长度在参数域和曲面之间按比例 $ \sqrt{\lambda(u,v)} $ 变化。</li>
    </ul>
  </li>
</ul>

<h4 id="共形参数化的重要性">共形参数化的重要性</h4>

<ol>
  <li><strong>简化计算</strong>：
    <ul>
      <li>度量矩阵仅含一个自由度（$ \lambda $），而非三个（$ E, F, G $），极大简化曲率、测地线等计算。</li>
    </ul>
  </li>
  <li><strong>几何不变性</strong>：
    <ul>
      <li>保角性使局部形状（如角度）不受参数化扭曲影响，适用于纹理映射、曲面重建。</li>
    </ul>
  </li>
  <li><strong>理论普适性</strong>：
    <ul>
      <li>任何光滑曲面均存在共形参数化（Uniformization Theorem），而等距参数化通常不存在。</li>
    </ul>
  </li>
</ol>

<hr />

<h4 id="3-共形-vs-等距参数化"><strong>3. 共形 vs. 等距参数化</strong></h4>
<p>| <strong>特性</strong>          | <strong>共形参数化</strong>                     | <strong>等距参数化</strong>                     |
|——————-|———————————–|———————————–|
| <strong>度量形式</strong>      | $ \mathbf{I} = \lambda(u,v) \mathbb{I}_2 $ | $ \mathbf{I} = \mathbb{I}_2 $（理想情况） |
| <strong>长度保持</strong>      | 非均匀缩放                        | 完全保持                          |
| <strong>角度保持</strong>      | 是                             | 是                             |
| <strong>存在性</strong>        | 总存在（如球面、环面）            | 仅限可展曲面（平面、圆柱）        |</p>

<h4 id="恩内佩尔曲面enneper-surface示例">恩内佩尔曲面（Enneper Surface）示例</h4>

<p>恩内佩尔曲面是一个经典的<strong>极小曲面</strong>（Minimal Surface），其参数化方程为：</p>

\[f(u,v) = \begin{bmatrix} 
uv^2 + u - \frac{1}{3}u^3 \\ 
\frac{1}{3}v(v^2 - 3u^2 - 3) \\ 
u^2 - v^2 
\end{bmatrix}\]

<ul>
  <li><strong>几何特性</strong>：具有自交性质，对称且无限延伸，是数学上研究共形度量的理想例子。</li>
</ul>

<p><strong>雅可比矩阵 $ J_f $</strong>（切向量的矩阵表示）：</p>

\[J_f = \begin{bmatrix} 
\frac{\partial f_1}{\partial u} &amp; \frac{\partial f_1}{\partial v} \\ 
\frac{\partial f_2}{\partial u} &amp; \frac{\partial f_2}{\partial v} \\ 
\frac{\partial f_3}{\partial u} &amp; \frac{\partial f_3}{\partial v} 
\end{bmatrix}
= \begin{bmatrix} 
-u^2 + v^2 + 1 &amp; 2uv \\ 
-2uv &amp; -u^2 + v^2 - 1 \\ 
2u &amp; -2v 
\end{bmatrix}\]

<p><strong>诱导度量 $ \mathbf{I} = J_f^\top J_f $</strong>：</p>

\[\mathbf{I} = 
\begin{bmatrix} 
1 + 4u^2 + (u^2 - v^2 - 1)^2 &amp; -4uv \\ 
-4uv &amp; 1 + 4v^2 + (u^2 - v^2 + 1)^2 
\end{bmatrix}\]

<p>经过化简后，神奇地简化为：</p>

\[\mathbf{I} = (u^2 + v^2 + 1)^2 \begin{bmatrix} 1 &amp; 0 \\ 0 &amp; 1 \end{bmatrix}.\]

<p>恩内佩尔曲面通过其简洁的共形度量，展示了极小曲面与复分析之间的深刻联系。其度量形式 $ \mathbf{I} = \lambda(u,v) \mathbb{I}_2 $ 是理论与应用中的黄金标准，为曲面参数化提供了最优的局部几何描述。</p>

<h3 id="抽象黎曼度量abstract-riemannian-metric">抽象黎曼度量（Abstract Riemannian Metric）</h3>

<p>黎曼度量是流形上<strong>逐点光滑变化的内积</strong> $ g_p $，赋予切空间 $ T_p M $ 长度和角度的测量能力。其核心在于：</p>
<ol>
  <li><strong>内蕴性</strong>：无需依赖嵌入空间，仅通过 $ g_p(X,Y) $ 即可定义几何量（如曲率、测地线）。</li>
  <li><strong>灵活性</strong>：任意指定对称正定双线性形式 $ g_{ij} $ 均可构造合法度量（如双曲平面 $ \delta_p $）。</li>
  <li><strong>普适公式</strong>：长度 $ |X| = \sqrt{g(X,X)} $，夹角 $ \cos\theta = \frac{g(X,Y)}{|X||Y|} $。</li>
</ol>

<p>黎曼度量是“弯曲空间的尺规”，完全由局部内积决定全局几何。</p>

<h4 id="例子单位圆盘的双曲度量">例子：单位圆盘的双曲度量</h4>

<table>
  <tbody>
    <tr>
      <td>在单位圆盘 $ U = { p \in \mathbb{R}^2 \mid</td>
      <td>p</td>
      <td>&lt; 1 } $ 上定义双曲度量：</td>
    </tr>
  </tbody>
</table>

\[g_p(X, Y) = \frac{4}{(1 - |p|^2)^2} \langle X, Y \rangle_{\mathbb{R}^2},\]

<p>其中 $ \langle \cdot, \cdot \rangle_{\mathbb{R}^2} $ 是欧氏内积。</p>

<ol>
  <li>
    <p><strong>局部长度膨胀</strong></p>

    <p>在点 $ p = (0.5, 0) $ 处，取向量 $ X = (1, 0) $：</p>

\[|X|_{g} = \sqrt{g_p(X, X)} = \frac{2}{1 - 0.5^2} \cdot 1 = \frac{8}{3}.\]

    <table>
      <tbody>
        <tr>
          <td><strong>结论</strong>：相同欧氏长度的向量在 $ p $ 点处双曲长度更大，且仅依赖 $ p $ 的局部坐标 $</td>
          <td>p</td>
          <td>$。</td>
        </tr>
      </tbody>
    </table>
  </li>
  <li>
    <p><strong>角度不变性（保角性）</strong><br />
对任意两向量 $ X, Y $，夹角：</p>

\[\theta = \arccos \left( \frac{g_p(X, Y)}{|X|_g |Y|_g} \right) = \arccos \left( \frac{\langle X, Y \rangle}{\|X\| \|Y\|} \right).\]

    <table>
      <tbody>
        <tr>
          <td><strong>结论</strong>：双曲度量与欧氏角度相同，仅通过 $ g_p $ 的标量因子 $ \lambda(p) = \frac{4}{(1-</td>
          <td>p</td>
          <td>^2)^2} $ 即可确定，无需全局信息。</td>
        </tr>
      </tbody>
    </table>
  </li>
  <li>
    <p><strong>面积</strong><br />
对参数域 $ D \subset U $，面积为：</p>

\[\text{Area}(D) = \iint_D \sqrt{\det(g_p)} \, du \, dv = \iint_D \frac{4}{(1 - u^2 - v^2)^2} \, du \, dv.\]

    <p><strong>结论</strong>：当 $ R \to 1 $，面积 $ \to +\infty $，与长度共同反映双曲空间的“膨胀”性质。</p>
  </li>
  <li>
    <p><strong>长度</strong><br />
在双曲度量 $ g_p $ 下，曲线 $ \gamma: [a,b] \to U $ 的长度为：</p>

\[\text{Length}(\gamma) = \int_a^b \sqrt{g_{\gamma(t)}(\gamma'(t), \gamma'(t))} \, dt = \int_a^b \frac{2 \|\gamma'(t)\|_{\mathbb{R}^2}}{1 - |\gamma(t)|^2} \, dt.\]

    <p><strong>结论</strong>：当 $ r \to 1 $，长度 $ \to +\infty $，体现双曲几何的“无限延伸”特性。</p>
  </li>
</ol>

<p>双曲度量 $ g_p $ 展示了如何仅通过局部内积定义弯曲空间的完整几何，无需全局嵌入。这是内蕴几何的核心思想——<strong>几何即局部测量的规则</strong>。</p>

<h3 id="嵌入定理embedding-theorems">嵌入定理（Embedding Theorems）</h3>

<ol>
  <li>
    <p><strong>核心问题</strong><br />
给定黎曼度量 $ g $，能否找到嵌入映射 $ f $ 使得 $ g(X,Y) = \langle \mathrm{d}f(X), \mathrm{d}f(Y) \rangle $？即：能否将抽象流形等距嵌入欧氏空间？</p>
  </li>
  <li><strong>Hilbert定理（负结果）</strong>
    <ul>
      <li><strong>双曲空间</strong>：无法将常负曲率（如双曲平面）光滑嵌入 $ \mathbb{R}^3 $。</li>
      <li><strong>限制</strong>：某些内蕴几何需更高维空间实现。</li>
    </ul>
  </li>
  <li><strong>Nash嵌入定理（正结果）</strong>
    <ul>
      <li><strong>存在性</strong>：任何 $ n $-维黎曼流形均可全局嵌入 $ \mathbb{R}^N $（$ N $ 足够大，如 $ N = \frac{n(n+1)(3n+11)}{2} $）。</li>
      <li><strong>低维优化</strong>：若允许 $ C^1 $ 光滑性，可嵌入 $ \mathbb{R}^{n+1} $；若初始嵌入“不拉伸距离”（short），则存在保距嵌入。</li>
    </ul>
  </li>
</ol>

<h3 id="atlas--charts">Atlas &amp; Charts</h3>

<p>复杂曲面通常无法用单一参数化表示，需通过<strong>重叠的局部坐标卡</strong>（charts）覆盖，构成<strong>图册</strong>（atlas）。每个坐标卡 $ \phi_i: U_i \subset \mathbb{R}^2 \to \mathbb{R}^3 $ 提供曲面的局部参数化。</p>

<ol>
  <li><strong>度量的局部一致性</strong>
    <ul>
      <li>每个坐标卡 $ \phi_i $ 诱导局部黎曼度量 $ g_i(X,Y) = \langle d\phi_i(X), d\phi_i(Y) \rangle $。</li>
      <li>
        <p><strong>关键条件</strong>：在坐标卡重叠区域 $ U_i \cap U_j $，度量需满足相容性：</p>

\[g_j(d\phi_{ij}(X), d\phi_{ij}(Y)) = g_i(X,Y), \quad \phi_{ij} = \phi_j^{-1} \circ \phi_i.\]

        <p>这确保几何量（如长度、曲率）与坐标选择无关。</p>
      </li>
    </ul>
  </li>
  <li><strong>几何意义</strong>
    <ul>
      <li><strong>局部简化</strong>：将复杂曲面拆分为可计算的“碎片”（如球面需至少两片坐标卡）。</li>
      <li><strong>全局一致性</strong>：通过转移映射 $ \phi_{ij} $ 和度量相容性，拼合出整体几何。</li>
    </ul>
  </li>
</ol>

<h3 id="抽象黎曼流形abstract-riemannian-manifold">抽象黎曼流形（Abstract Riemannian Manifold）</h3>

<p>无需依赖流形在欧氏空间中的具体嵌入，仅通过<strong>局部坐标卡</strong>（charts）和<strong>相容的黎曼度量</strong> $ g_i $ 即可定义几何结构。</p>
<ul>
  <li><strong>组成要素</strong>：
    <ul>
      <li>开集覆盖 $ {U_i} $ 和转移映射 $ \phi_{ij} $。</li>
      <li>每片 $ U_i $ 上的度量 $ g_i $，且在重叠区域满足 $ g_j(\mathrm{d}\phi_{ij}(X), \mathrm{d}\phi_{ij}(Y)) = g_i(X,Y) $。</li>
    </ul>
  </li>
</ul>

<ol>
  <li><strong>核心定理</strong>
    <ul>
      <li><strong>几何量的内蕴性</strong>：长度、角度、曲率等均可通过局部度量 $ g_i $ 计算，与坐标选择无关。</li>
      <li><strong>脱离嵌入的自由</strong>：允许定义无法低维嵌入的流形（如双曲平面、高维时空）。</li>
    </ul>
  </li>
  <li><strong>意义与应用</strong>
    <ul>
      <li><strong>数学</strong>：统一处理弯曲空间，如广义相对论的时空流形。</li>
      <li><strong>计算</strong>：离散几何中通过局部边长和夹角定义流形（如三角网格）。</li>
    </ul>
  </li>
</ol>

<p>Charts是“地图”，抽象黎曼流形是“带比例尺的地图集”</p>

<h2 id="总结">总结</h2>

<p><strong>两种几何描述的对比</strong></p>

<table>
  <thead>
    <tr>
      <th><strong>描述方式</strong></th>
      <th><strong>外在（Extrinsic）参数化</strong></th>
      <th><strong>内蕴（Intrinsic）黎曼度量</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>核心思想</strong></td>
      <td>将曲面表示为映射 $ f: U \to \mathbb{R}^n $ 的像，依赖外部空间坐标。</td>
      <td>通过切空间上的内积 $ g(X,Y) $ 定义几何，完全脱离嵌入空间。</td>
    </tr>
    <tr>
      <td><strong>优点</strong></td>
      <td>直观描述曲面形状（如顶点位置、法向量）。</td>
      <td>独立于参数化，直接反映曲面的内在性质（如曲率、测地线）。</td>
    </tr>
    <tr>
      <td><strong>局限性</strong></td>
      <td>依赖嵌入空间，无法描述抽象流形（如无法嵌入的拓扑空间）。</td>
      <td>缺乏直观的空间位置信息，需通过计算提取几何特征。</td>
    </tr>
    <tr>
      <td><strong>关键工具</strong></td>
      <td>微分 $ \mathrm{d}f $、法向量 $ N = \partial_u f \times \partial_v f $。</td>
      <td>第一基本形式 $ \mathbf{I} = J_f^\top J_f $、高斯曲率 $ K $。</td>
    </tr>
    <tr>
      <td><strong>应用场景</strong></td>
      <td>计算机图形学（网格建模）、物理模拟（流体表面）。</td>
      <td>广义相对论（时空流形）、离散微分几何（仅知边长和夹角时的曲面重建）。</td>
    </tr>
  </tbody>
</table>

<p>外在参数化与内蕴度量是研究光滑曲面的“一体两面”，前者提供直观形状，后者揭示本质几何。理解二者的转换与互补，是微分几何及其应用（如离散曲面处理）的核心基础。</p>]]></content><author><name></name></author><category term="DDG" /><category term="Geometry" /><summary type="html"><![CDATA[光滑曲面]]></summary></entry><entry><title type="html">DDG Smooth Curves</title><link href="https://pasu.github.io/blog/2025/Smooth_Curve/" rel="alternate" type="text/html" title="DDG Smooth Curves" /><published>2025-06-09T10:27:00+00:00</published><updated>2025-06-09T10:27:00+00:00</updated><id>https://pasu.github.io/blog/2025/Smooth_Curve</id><content type="html" xml:base="https://pasu.github.io/blog/2025/Smooth_Curve/"><![CDATA[<h2 id="曲线与表面">曲线与表面</h2>

<h3 id="生活中的几何">生活中的几何</h3>

<p>我们日常接触的绝大多数几何对象，无论是自然界还是人造物，都可以用<strong>曲线</strong>和<strong>曲面</strong>来描述。比如行星的运行轨道和心电图都是曲线的形式，而飞机机翼，人脸建模则是曲面。即便是<strong>实体的边界</strong>，比如三维物体（如球体），其本质也是由曲面（边界）定义的。因此，曲线和曲面是连接数学与现实的桥梁。</p>

<p>微分几何则主要研究<strong>n维流形</strong>，通常聚焦于低维：  <strong>曲线（n=1）</strong>、<strong>曲面（n=2）</strong>、<strong>体积（n=3）</strong>。主要原因如下：</p>

<ul>
  <li>应用广泛：从机器人路径规划到计算机图形学。</li>
  <li>低维并非简单，也可能极其深刻：
    <ul>
      <li><strong>n=1</strong>：纽结识别（2022年才解决！）。</li>
      <li><strong>n=2</strong>：Willmore猜想（2012年证得部分结果）。</li>
      <li><strong>n=3</strong>：几何化猜想（2003年佩雷尔曼证明，价值百万美元）。</li>
    </ul>
  </li>
  <li>高维未必复杂，机器学习中的高维数据反而可能缺乏几何深度（如对称性、曲率流等）。</li>
</ul>

<blockquote>
  <p><strong>反直觉</strong>：低维流形是数学的“实验室”，蕴藏最丰富的结构与未解之谜。</p>
</blockquote>

<p>描述几何的多种“方言”：</p>
<ul>
  <li><strong>局部参数化</strong>（如圆弧 $(\cos\theta, \sin\theta)$）。</li>
  <li><strong>微分形式</strong>（坐标无关，适合全局分析）。</li>
  <li><strong>活动标架</strong>（Frenet标架用于曲线，曲面上的标架场）。</li>
  <li><strong>隐式方程</strong>（如 $x^2 + y^2 = 1$ 定义圆）。</li>
</ul>

<p>同样，复杂问题下不必拘泥于一种方法，就如同一个人掌握多种语言的必要性一般。</p>

<h3 id="离散描述"><strong>离散描述</strong></h3>

<p>数值计算需要离散化：<br />
| <strong>方法</strong>       | <strong>优点</strong>                     | <strong>缺点</strong>                     |<br />
|—————-|—————————–|—————————–|<br />
| <strong>隐式</strong>（如水平集） | 拓扑变化灵活（如分裂、合并）   | 存储成本高、自适应困难       |<br />
| <strong>显式</strong>（如网格）  | 计算高效、工具成熟           | 拓扑修改复杂                 |</p>

<p>就如同DDG课程所讲，本课程的目标就是在<strong>光滑理论</strong>上，通过微分形式揭示几何本，而在<strong>离散逼近</strong>上，用网格和离散微分形式实现算法，从而实现在理论（纸上推导）与计算（代码实现）间的自由切换。</p>

<p>比如在汽车设计中，设计汽车曲面（光滑）-&gt;生成有限元网格（离散）-&gt; 模拟碰撞（算法）。</p>

<h2 id="平面曲线">平面曲线</h2>

<h3 id="隐式描述">隐式描述</h3>

<p><strong>定义</strong>：通过函数$\phi(x,y)=0$定义的平面点集</p>

<ul>
  <li><strong>典型示例</strong>：单位圆的方程$x^2+y^2-1=0$</li>
  <li><strong>优势</strong>：
    <ul>
      <li>表示简洁，一个方程描述完整曲线</li>
      <li>容易判断点是否在曲线上（代入验证）</li>
    </ul>
  </li>
  <li><strong>局限</strong>：
    <ul>
      <li>自交点处理困难（如双纽线）</li>
      <li>难以直接获取几何属性（如切线方向）</li>
    </ul>
  </li>
</ul>

<blockquote>
  <p>数学内涵：体现了曲线的全局性质，是代数几何的研究对象。</p>
</blockquote>

<h3 id="参数化描述">参数化描述</h3>

<p><strong>定义</strong>：通过$\gamma:[a,b] \rightarrow \mathbb{R}^2$的映射给出</p>
<ul>
  <li><strong>经典示例</strong>：圆的参数方程$\gamma (\theta) = (\cos \theta, \sin \theta)$</li>
  <li><strong>显著优势</strong>：
    <ul>
      <li>明确处理自交（浸入vs.嵌入）</li>
      <li>自然包含运动信息（$\gamma^\prime (t)$表示速度）</li>
      <li>适合物理建模（如粒子轨迹）</li>
    </ul>
  </li>
</ul>

<blockquote>
  <p>关键特征：参数化本质上是将一维区间”拉伸扭曲”到平面。</p>
</blockquote>

<p>参数化曲线自然地导出离散表示：用顶点序列${v_0,v_1,…,v_n}$逼近。</p>

<table>
  <thead>
    <tr>
      <th>特征</th>
      <th>隐式描述</th>
      <th>参数化描述</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>自交处理</td>
      <td>困难</td>
      <td>明确</td>
    </tr>
    <tr>
      <td>几何计算</td>
      <td>需隐函数求导</td>
      <td>直接微分</td>
    </tr>
    <tr>
      <td>运动描述</td>
      <td>不自然</td>
      <td>包含速度信息</td>
    </tr>
    <tr>
      <td>离散化难度</td>
      <td>复杂（如体素化）</td>
      <td>简单（取采样点）</td>
    </tr>
  </tbody>
</table>

<p>一个<strong>平面参数化曲线</strong>是指从实数区间到平面的映射：</p>

\[\gamma: [0,L] \to \mathbb{R}^2\]

<p>其中：</p>

<ul>
  <li>定义域 $[0,L]$ 是实直线上的闭区间（参数空间）</li>
  <li>值域 $\gamma([0,L])$ 是平面上的点集（轨迹）</li>
</ul>

<h3 id="曲线微分">曲线微分</h3>

<p>参数化曲线 $\gamma: [0,L] \to \mathbb{R}^2$ 的微分 $ \mathrm{d} \gamma$ 是将参数空间的切向量映射到平面切向量的线性变换：</p>

\[\mathrm{d} \gamma: T_s[0,L] \to T_{\gamma(s)}\mathbb{R}^2\]

<h3 id="曲线切向量">曲线切向量</h3>

<p>切向量是曲线在某点的”最佳逼近直线”的方向向量:</p>

<p>对于 $ C^1 $ 类正则曲线 $\gamma: I \to \mathbb{R}^n $：</p>

\[T(t) = \frac{\mathrm{d}\gamma/\mathrm{d}t}{\|\mathrm{d}\gamma/\mathrm{d}t\|} \in S^{n-1}\]

<p>其中正则性条件 $|d\gamma/dt| \neq 0$ 确保定义良好。</p>

<ul>
  <li><strong>微分</strong> 如同”橡皮筋拉伸规则”：
    <ul>
      <li>参数空间是松弛的橡皮筋，$\mathrm{d}\gamma$ 描述它被拉伸到曲线时的变形方式。</li>
    </ul>
  </li>
  <li><strong>切向量</strong> 如同”指南针方向”：
    <ul>
      <li>在曲线每点标出一个箭头，指向曲线前进方向（长度固定为1）。</li>
    </ul>
  </li>
</ul>

<h3 id="曲线的重新参数化">曲线的重新参数化</h3>

<p>给定一条参数化曲线 $\gamma: [a,b] \to \mathbb{R}^n$ 和一个双射映射 $\eta: [c,d] \to [a,b]$，我们可以构造<strong>重新参数化的曲线</strong>：</p>

\[\tilde{\gamma}(t) = \gamma(\eta(t)), \quad t \in [c,d]\]

<p><strong>关键性质</strong>：</p>
<ul>
  <li>新曲线 (\tilde{\gamma}) 与原始曲线 (\gamma) <strong>几何形状完全相同</strong></li>
  <li>仅改变了曲线的<strong>遍历方式</strong>（速度、参数间隔等）</li>
</ul>

<p>微分 $\mathrm{d}\tilde{\gamma}$ 揭示了参数变换导致的向量伸缩：</p>

\[\mathrm{d}\tilde{\gamma} = \mathrm{d}\gamma \circ d\eta\]

<p>一条参数化曲线 $\gamma: [a,b] \to \mathbb{R}^n$ 是<strong>正则的</strong>，其微分（速度向量）处处非零：</p>

\[\gamma'(t) \neq 0, \quad \forall t \in [a,b]\]

<h4 id="几何解释">几何解释</h4>

<ul>
  <li><strong>“永不停滞”</strong>：曲线在任意点都有明确的前进方向</li>
  <li><strong>切空间良定义</strong>：每点存在一维切空间 $T_{\gamma(t)}\mathcal{C}$</li>
  <li><strong>排除奇点</strong>：如尖点（cusp）、回溯点等病理情况</li>
</ul>

<h3 id="非正则曲线示例">非正则曲线示例</h3>

<p>同样，一个非正则曲线则表明其曲线微分在至少某一点上为零。如果举一个例子。</p>

<ul>
  <li>
    <p><strong>原始曲线</strong>：</p>

\[\gamma(s) = 
\begin{cases} 
(s, s) &amp; s \leq 0 \\
(s, -s) &amp; s &gt; 0
\end{cases}\]
  </li>
  <li>
    <p><strong>重新参数化</strong>：取$\eta(s) = s^3$，得到：</p>

\[\tilde{\gamma}(s) = \gamma(s^3) = 
\begin{cases} 
(s^3, s^3) &amp; s \leq 0 \\
(s^3, -s^3) &amp; s &gt; 0
\end{cases}\]
  </li>
</ul>

<h4 id="微分分析"><strong>微分分析</strong></h4>
<p>计算一阶导数：</p>

\[\tilde{\gamma}'(s) = 
\begin{cases} 
(3s^2, 3s^2) &amp; s &lt; 0 \\
(0, 0) &amp; s = 0 \\
(3s^2, -3s^2) &amp; s &gt; 0
\end{cases}\]

<ul>
  <li><strong>连续性</strong>：$\lim_{s\to 0^-} \tilde{\gamma}’(s) = \lim_{s\to 0^+} \tilde{\gamma}’(s) = (0,0)$</li>
  <li><strong>正则性破坏点</strong>：在$s=0$处$\tilde{\gamma}’(0) = 0$</li>
</ul>

<h3 id="嵌入曲线embedded-curve">嵌入曲线（Embedded Curve）</h3>

<h4 id="直观理解">直观理解</h4>

<p>嵌入曲线是<strong>不自交</strong>的曲线，满足：</p>

<ul>
  <li>没有交叉点（如数字”8”不是嵌入曲线）</li>
  <li>没有端点重合（如闭合环除外）</li>
  <li>在平面上看起来是”一根连续不断的线”</li>
</ul>

<h4 id="数学定义">数学定义</h4>

<p>对于参数化曲线 $\gamma: [a,b] \to \mathbb{R}^n$，它是<strong>嵌入的</strong>当且仅当：</p>

<ol>
  <li><strong>连续单射</strong>：$\gamma$ 是连续且一一映射的</li>
  <li><strong>逆映射连续</strong>：$\gamma^{-1}: \gamma([a,b]) \to [a,b]$ 也是连续的（即同胚嵌入）</li>
</ol>

<h4 id="反例">反例</h4>

<ul>
  <li>
    <p><strong>构造方式</strong>：</p>

\[\gamma: [0,1) \to S^1, \quad t \mapsto (\cos 2\pi t, \sin 2\pi t)\]
  </li>
  <li>
    <p><strong>性质分析</strong>：</p>

    <ul>
      <li><strong>连续单射</strong>：每个$t$对应圆上唯一点，且连续</li>
      <li><strong>非嵌入</strong>：当$t \to 1^-$时，$\gamma(t)$趋近于$(1,0)$，但$\gamma^{-1}$在$(1,0)$处不连续（无法连续”解开”圆）</li>
    </ul>
  </li>
</ul>

<p><strong>几何表现</strong>：</p>
<ul>
  <li>图像是一个<strong>缺了一个点的圆</strong>（极限点未闭合）</li>
  <li>若强行闭合（令$\gamma(1)=(1,0)$），则失去单射性</li>
</ul>

<h3 id="单位法向量">单位法向量</h3>

<p>法向量是垂直于切向量的单位向量，满足：</p>

<ul>
  <li><strong>“竖直外伸”</strong>：在平面曲线的每点指向曲率中心方向</li>
  <li><strong>正交性</strong>：始终与切向量 $ T(s) $ 满足 $ T \cdot N = 0 $</li>
  <li><strong>定向规则</strong>：通常取逆时针旋转90°（右手系）</li>
</ul>

<h4 id="数学定义-1">数学定义</h4>

<p>对于弧长参数化曲线 $\gamma(s)$，单位法向量定义为：</p>

\[N(s) = JT(s)\]

<p>其中 $ J $ 是逆时针旋转90°的线性算子：</p>

\[J(x,y) = (-y,x)\]

<h3 id="曲率">曲率</h3>

<p>曲率 $\kappa$ 量化曲线在某点的<strong>弯曲程度</strong>：</p>

<ul>
  <li>$\kappa = 0$：直线（不弯曲）</li>
  <li>$\kappa$ 越大：弯曲越剧烈</li>
  <li>符号：表示弯曲方向（逆时针为正，顺时针为负）</li>
</ul>

<p>对于弧长参数化曲线 $\gamma(s)$，曲率为单位切向量 $T(s)$ 的变化率：</p>

\[\kappa(s) = \left\| \frac{dT}{ds} \right\| = \| T'(s) \|\]

<p>若用法向量 $N(s)$ 表示：</p>

\[\kappa(s) = \langle N(s), T'(s) \rangle\]

<h4 id="密切圆osculating-circle">密切圆（Osculating Circle）</h4>

<p>过曲线上点 $p$ 及左右邻近两点，当邻近点无限接近 $p$ 时，这三个点确定的圆的极限位置即为<strong>密切圆</strong>。</p>

<ul>
  <li>
    <p><strong>曲率半径</strong>：密切圆半径 $r$ 与曲率的关系：</p>

\[\kappa(p) = \frac{1}{r(p)}\]
  </li>
</ul>

<p>（半径越小，曲率越大）</p>

<h3 id="曲率决定曲线">曲率决定曲线</h3>

<p>对于弧长参数化的平面曲线 $\gamma(s)$，在<strong>刚体运动（平移+旋转）意义下</strong>：</p>

<ul>
  <li><strong>唯一性</strong>：曲线的形状完全由曲率函数 $\kappa(s)$ 决定</li>
  <li><strong>存在性</strong>：任意给定的连续函数 $\kappa(s)$ 对应一条平面曲线</li>
</ul>

<h4 id="几何直观">几何直观</h4>

<p><strong>方向盘比喻</strong>：</p>
<ul>
  <li>曲率 $\kappa(s)$ 如同方向盘转角</li>
  <li>以单位速度行驶时，$\kappa(s)$ 决定行驶方向的变化率</li>
</ul>

<h3 id="从曲率函数重建平面曲线">从曲率函数重建平面曲线</h3>

<p>根据<strong>平面曲线基本定理</strong>，给定曲率函数 $\kappa(s)$ 和初始条件，可通过三步重建曲线：</p>

<ol>
  <li>
    <p><strong>积分曲率得角度</strong>：</p>

\[\theta(s) = \int_0^s \kappa(t) dt + \theta_0\]

    <p>（$\theta_0$ 为初始切向角度）</p>
  </li>
  <li>
    <p><strong>构造切向量</strong>：</p>

\[T(s) = (\cos\theta(s), \sin\theta(s))\]
  </li>
  <li>
    <p><strong>积分切向量得曲线</strong>：</p>

\[\gamma(s) = \gamma(0) + \int_0^s T(t) dt\]
  </li>
</ol>

<h4 id="示例验证常曲率-kappas--1">示例验证：常曲率 $\kappa(s) = 1$</h4>

<ol>
  <li>
    <p><strong>角度函数</strong>：</p>

\[\theta(s) = \int_0^s 1 \, dt = s \quad (\text{设} \theta_0=0)\]
  </li>
  <li>
    <p><strong>切向量</strong>：</p>

\[T(s) = (\cos s, \sin s)\]
  </li>
  <li>
    <p><strong>曲线积分</strong>：</p>

\[\gamma(s) = \int_0^s (\cos t, \sin t) dt = (\sin s, 1-\cos s)\]

    <p><strong>结果</strong>：半径为1的圆沿x轴滚动的摆线</p>
  </li>
</ol>

<h3 id="转向数turning-number与环绕数winding-number">转向数（Turning Number）与环绕数（Winding Number）</h3>

<ul>
  <li><strong>转向数 $ k $</strong>：<br />
想象一个小车沿曲线行驶，方向盘总共转了多少圈。
    <ul>
      <li>$ k=+1 $：标准逆时针圆（方向盘逆时针转1圈）</li>
      <li>$ k=0 $：直线或”8”字形（净转向为零）</li>
    </ul>
  </li>
  <li><strong>环绕数 $ n(p) $</strong>：<br />
用一根绳子连接点 $ p $ 和曲线，数绳子绕 $ p $ 的净圈数。
    <ul>
      <li>若 $ p $ 在曲线内部，通常 $ n(p) \neq 0 $</li>
      <li>若 $ p $ 在外部，$ n(p) = 0 $</li>
    </ul>
  </li>
</ul>

<p>切线数是“切线映射”绕原点的环绕数。也就是说，如果我们不是用原始曲线去绕某个点，而是用单位切向量在单位圆上形成的路径去计算环绕数，那得到的数就是切线数。</p>

<h3 id="whitneygraustein-定理">Whitney–Graustein 定理</h3>

<p>当两条曲线之间可以通过<strong>连续变形</strong>（homotopy）变换，且在整个过程中始终保持“正则”（即处处导数不为零、没有尖点或停顿）时，我们称这两条曲线是<strong>正则同伦</strong>（regularly homotopic）的。</p>

<p><strong>Whitney–Graustein 定理</strong>指出：</p>

<blockquote>
  <p><strong>两条平面正则曲线具有相同的切线数（turning number）当且仅当它们是正则同伦的。</strong></p>
</blockquote>

<p>也就是说，切线数是判断两条曲线能否在不“撕裂”或“折断”的前提下相互变形的<strong>拓扑不变量</strong>。</p>

<h4 id="推论">推论：</h4>

<blockquote>
  <p>不可能把一个“正向绕一圈”的圆形变形成“反向绕一圈”的圆形。
换句话说，<strong>无法在保持正则性的前提下把一个圆“翻转过来”</strong>，因为它们的切线数为 $+1$ 和 $-1$，不同。</p>
</blockquote>

<p>这一定理将“几何上的连续变形”与“拓扑不变量”之间建立了深刻的联系，是理解曲线同伦分类的核心结果之一。</p>

<h3 id="应用六面体网格划分hexahedral-meshing">应用：六面体网格划分（Hexahedral Meshing）</h3>

<p>在数值模拟中，<strong>六面体网格划分</strong>指的是将一个三维形状划分成许多“小立方体”来进行物理计算或几何处理。</p>

<h4 id="定理thurstonmitchell">定理（Thurston–Mitchell）：</h4>

<blockquote>
  <p>一个genus-0的四边形网格，<strong>当且仅当其面数为偶数</strong>时，才能作为某个六面体网格的边界。</p>
</blockquote>

<h4 id="证明思路概述">证明思路概述：</h4>

<ul>
  <li>在球面上的每一条曲线都可以通过正则同伦变形为一个圆形或“8”字形；</li>
  <li>将网格的<strong>对偶图（dual graph）</strong>变形成一系列<strong>互不相交的圆和“8”字形</strong>；</li>
  <li>然后通过“收缩”球面来在这些曲线之间插值，逐渐“扫出”一套新的表面；</li>
  <li>这些表面正好构成一个六面体网格（可能需要补充一些额外结构以使其闭合）。</li>
</ul>

<p>该构造方式会生成 $O(n^2)$ 个六面体单元（其中 $n$ 为原始网格规模），但在优化算法下可以做到 $O(n)$ 复杂度。</p>

<p>此外，Erickson 的研究表明，该方法还可以推广到<strong>任意亏格</strong>的情形。</p>

<p>以下是该段内容关于“广义环绕数（Generalized Winding Numbers）”的中文翻译，适合用于博客文章风格：</p>

<hr />

<h3 id="应用广义环绕数generalized-winding-numbers">应用：广义环绕数（Generalized Winding Numbers）</h3>

<p><strong>环绕数（winding number）</strong>表示一条<strong>封闭曲线</strong>绕某个给定点“缠绕”的次数——它帮助我们判断某个点是<strong>在曲线内部</strong>还是<strong>外部</strong>。在真实数据中，曲线往往<strong>不是完美封闭</strong>的，比如：</p>

<ul>
  <li>存在测量噪声；</li>
  <li>曲线存在小的缝隙或不连续。</li>
</ul>

<p>但即使在这种情况下，我们<strong>仍然希望判断哪些点是在“里面”或“外面”。</strong></p>

<h4 id="解决方法">解决方法：</h4>

<p>我们可以通过<strong>累加曲线对某点的“有符号投影长度”或“有符号面积”</strong>，得到一个<strong>小数形式的“广义环绕数”</strong>（fractional winding number）。</p>

<h4 id="优点">优点：</h4>

<ul>
  <li>虽然结果不再是整数，但它仍然<strong>很好地反映了“内”与“外”的概率</strong>；</li>
  <li>通过设定一个阈值（threshold），我们可以在嘈杂数据中<strong>稳健地区分内外区域</strong>。</li>
</ul>

<h4 id="应用场景包括">应用场景包括：</h4>

<ul>
  <li>提取<strong>水密网格</strong>（watertight mesh）；</li>
  <li><strong>四面体网格划分</strong>（tetrahedral meshing）；</li>
  <li><strong>实体布尔操作</strong>（Constructive Solid Geometry, CSG），如并集、交集、差集等。</li>
</ul>

<h2 id="空间曲线">空间曲线</h2>

<p>一条<strong>参数化空间曲线</strong>是如下映射：</p>

\[\gamma: [0, L] \to \mathbb{R}^3\]

<p>其中：</p>
<ul>
  <li><strong>定义域</strong>：实直线上的闭区间 $[0,L]$（通常表示弧长或时间参数）</li>
  <li><strong>值域</strong>：三维欧氏空间中的点集 ${\gamma(t) \mid t \in [0,L]}$</li>
</ul>

<p>曲线的微分 $ \mathrm{d}\gamma $ 实现了切空间的线性映射：</p>

\[\mathrm{d} \gamma: T_t\mathbb{R} \to T_{\gamma(t)}\mathbb{R}^3\]

<h3 id="推前映射pushforward">推前映射（Pushforward）</h3>

<p><strong>推前映射</strong> $ d\gamma $ 将定义在参数域上的向量场 $ X $ 推前（”拉伸”）到三维空间中的曲线切向量场：</p>

\[\mathrm{d} \gamma: T_t\mathbb{R} \to T_{\gamma(t)}\mathbb{R}^3\]

<p>这一操作是微分几何中<strong>切映射</strong>的特例，也是雅可比矩阵在曲线情形下的具体表现。</p>

<h4 id="具体构造步骤">具体构造步骤</h4>

<p>设曲线 $\gamma(t) = (x(t), y(t), z(t))$ 和参数域上的向量场 $ X = a(t)\frac{\partial}{\partial t} $，则：</p>

<ol>
  <li>
    <p><strong>坐标微分计算</strong>：</p>

\[\mathrm{d}\gamma = \left( \frac{dx}{dt}, \frac{dy}{dt}, \frac{dz}{dt} \right) dt\]
  </li>
  <li>
    <p><strong>推前映射作用</strong>：</p>

\[\mathrm{d}\gamma(X) = a(t) \left( \frac{dx}{dt}, \frac{dy}{dt}, \frac{dz}{dt} \right) \in \mathbb{R}^3\]

    <p><strong>几何意义</strong>：将参数速度 $ a(t) $ 转换为物理空间速度向量</p>
  </li>
</ol>

<h3 id="curvature-曲率-and-torsion-扭率">Curvature （曲率） and Torsion (扭率？)</h3>

<p>平面上的曲率描述曲线的弯曲程度，而在空间中，还包括torsion，描述扭曲的程度。</p>

<h3 id="frenet标架与frenet-serret方程空间曲线的局部坐标系">Frenet标架与Frenet-Serret方程：空间曲线的局部坐标系</h3>

<p>对于正则空间曲线 $\gamma(s)$（弧长参数化），其Frenet标架由三个单位正交向量组成：</p>

<ol>
  <li>
    <p><strong>切向量（Tangent）</strong>：</p>

    <p>\(T(s) = \gamma'(s)\)
<em>方向：曲线瞬时运动方向</em></p>
  </li>
  <li>
    <p><strong>法向量（Normal）</strong>：</p>

    <p>\(N(s) = \frac{T'(s)}{\|T'(s)\|} = \frac{\gamma''(s)}{\kappa(s)}\)
<em>方向：指向曲率中心</em></p>
  </li>
  <li>
    <p><strong>副法向量（Binormal）</strong>：</p>

\[B(s) = T(s) \times N(s)\]

    <p><em>方向：垂直于密切平面，构成右手系</em></p>
  </li>
</ol>

<h4 id="frenet-serret">Frenet-Serret</h4>

<p>Frenet标架沿曲线的演化由曲率 $\kappa$ 和挠率 $\tau$ 完全控制，<strong>矩阵形式</strong>：</p>

\[\frac{d}{ds}
\begin{bmatrix}
T \\
N \\
B
\end{bmatrix}
=
\begin{bmatrix}
0 &amp; -\kappa &amp; 0 \\
\kappa &amp; 0 &amp; -\tau \\
0 &amp; \tau &amp; 0
\end{bmatrix}
\begin{bmatrix}
T \\
N \\
B
\end{bmatrix}\]

<h4 id="几何解释-1">几何解释</h4>

<table>
  <thead>
    <tr>
      <th><strong>方程</strong></th>
      <th><strong>物理意义</strong></th>
      <th><strong>类比</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>$ T’ = \kappa N $</td>
      <td>切向变化率 ⇒ 弯曲强度</td>
      <td>离心力指向曲率中心</td>
    </tr>
    <tr>
      <td>$ N’ = -\kappa T + \tau B $</td>
      <td>法向变化由弯曲和扭转共同作用</td>
      <td>科里奥利力效应</td>
    </tr>
    <tr>
      <td>$ B’ = -\tau N $</td>
      <td>副法向变化率 ⇒ 纯扭转效应</td>
      <td>螺旋进</td>
    </tr>
  </tbody>
</table>

<h3 id="空间曲线基本定理">空间曲线基本定理</h3>

<p>和平面一样，对于给定的连续函数 $\kappa(s) &gt; 0$ 和 $\tau(s)$，存在<strong>唯一</strong>（刚体运动意义下）的弧长参数化空间曲线 $\gamma(s)$，使得：</p>
<ul>
  <li>$\kappa(s)$ 是该曲线的曲率</li>
  <li>$\tau(s)$ 是该曲线的挠率</li>
</ul>

<p><strong>唯一性</strong>：两条曲线若具有相同的 $\kappa(s)$ 和 $\tau(s)$，则仅相差一个刚体变换（旋转+平移）</p>

<h2 id="曲线总结">曲线总结</h2>

<p>描述曲线的方式有很多种，例如代数方式（algebraic curves）等。</p>

<p>在<strong>微分几何</strong>中，最常用的方式是使用<strong>参数化曲线</strong>，因为它可以通过对参数化函数求导数来提取许多关键的局部几何量：</p>

<ul>
  <li><strong>切向量、法向量、双法向量</strong>（组成 Frenet 框架）</li>
  <li><strong>曲率、挠率</strong>（curvature, torsion）</li>
</ul>

<p>此外，还有几个重要的概念：</p>

<ul>
  <li><strong>嵌入（embedded）</strong> vs. <strong>沉浸/正则（immersed / regular）</strong>：描述曲线是否自交、是否处处有定义良好的导数。</li>
  <li><strong>切线数（Turning Number）</strong>：单位切向量映射到单位圆的“度数”。</li>
  <li><strong>环绕数（Winding Number）</strong>：曲线绕某个点的“度数”。</li>
</ul>

<p>最后，微分几何中的一个重要结论：</p>

<blockquote>
  <p><strong>平面/空间曲线的基本定理</strong>：
只要知道一条曲线的<strong>曲率（和挠率）函数</strong>，就可以在刚体运动不变的意义下<strong>唯一确定这条曲线的形状</strong>。</p>
</blockquote>]]></content><author><name></name></author><category term="DDG" /><category term="Geometry" /><summary type="html"><![CDATA[曲线与表面]]></summary></entry></feed>