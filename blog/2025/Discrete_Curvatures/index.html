<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> DDG Discrete Curvatures | Guowei Lu </title> <meta name="author" content="Guowei Lu"> <meta name="description" content="Personal website of Peter Lu "> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.css"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%87%AC%F0%9F%87%B1&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://pasu.github.io/blog/2025/Discrete_Curvatures/"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?0afe9f0ae161375728f7bcc5eb5b4ab4"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Guowei</span> Lu </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">Blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">Publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">CV </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fa-solid fa-moon"></i> <i class="fa-solid fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">DDG Discrete Curvatures</h1> <p class="post-meta"> July 12, 2025 </p> <p class="post-tags"> <a href="/blog/2025"> <i class="fa-solid fa-calendar fa-sm"></i> 2025 </a>   ·   <a href="/blog/tag/geometry"> <i class="fa-solid fa-hashtag fa-sm"></i> Geometry</a>     ·   <a href="/blog/category/ddg"> <i class="fa-solid fa-tag fa-sm"></i> DDG</a>   </p> </header> <article class="post-content"> <div id="markdown-content"> <p>原课件来自：https://brickisland.net/ddg-web/</p> <h2 id="discrete-curvature">Discrete Curvature</h2> <p>上一节中，平滑的曲面曲率有多种表达形式：</p> <ul> <li> <strong>高斯曲率（Gauss Curvature）</strong>：$K = k_1 k_2$</li> <li> <strong>平均曲率（Mean Curvature）</strong>：$H = (k_1 + k_2)/2$</li> <li> <strong>主曲率（Principal Curvatures）</strong>： k_1, k_2（最大/最小曲率）</li> <li><strong>法曲率（Normal Curvature）</strong></li> <li><strong>测地曲率（Geodesic Curvature）</strong></li> </ul> <p>因此，光滑曲率的离散化看似有无数种不相关的方法，实际上存在统一框架可以解释大多数常见离散化选择。</p> <h3 id="统一视角unified-picture">统一视角（Unified Picture）</h3> <p>通过将光滑曲面与离散曲面建立联系，我们可以在统一的框架下理解许多散见于文献中的不同离散曲率定义。这样不仅有助于从微分几何的连续视角解释常用的离散曲率（如角缺陷(Angle Defect)、高斯曲率、平均曲率的边长度加权和等），还可以揭示它们与光滑情形中体积、面积及其变分的深刻对应关系，从而为几何处理、数值模拟和计算机图形学中的曲率计算提供更直观和理论一致的基础。</p> <h3 id="discrete-gaussian-curvature">Discrete Gaussian Curvature</h3> <h4 id="欧拉示性数-euler-characteristic">欧拉示性数 (Euler Characteristic)</h4> <p>对于多面体曲面（Polyhedral Surface），欧拉示性数定义为：</p> \[\chi = V - E + F\] <p>其中：</p> <ul> <li>$ V $：顶点数（Vertices）</li> <li>$ E $：边数（Edges）</li> <li>$ F $：面数（Faces）</li> </ul> <p><strong>示例</strong>：</p> <ul> <li> <strong>球面（Sphere）</strong>：$\chi = 2$（如立方体：8顶点、12边、6面 → 8-12+6=2）</li> <li> <strong>环面（Torus）</strong>：$\chi = 0$（如四边形环面：16顶点、32边、16面 → 16-32+16=0）</li> <li> <strong>双环面（Genus-2 Surface）</strong>：$\chi = -2$（推广公式：$\chi = 2 - 2g$，$g$为亏格）</li> </ul> <h4 id="topological-invariance">Topological Invariance</h4> <p><strong>定理（L’Huilier）</strong>：</p> <p>欧拉示性数是多面体曲面的<strong>拓扑不变量</strong>，即：</p> <ul> <li>与顶点的具体位置无关</li> <li>与曲面的细分方式（Tessellation）无关<br> 仅由曲面的<strong>拓扑类型（Topology）</strong>决定。</li> </ul> \[\chi = 2 - 2g\] <p>其中 $ g $ 是曲面的Genus（即“洞”的数量）, $\chi$是欧拉示性数。</p> <p>例如：</p> <ul> <li>球面（$g=0$）：$\chi = 2$</li> <li>环面（$g=1$）：$\chi = 0$</li> <li>双环面（$g=2$）：$\chi = -2$</li> </ul> <h4 id="angle-defect">Angle Defect</h4> <p>对于离散曲面（如三角网格）的顶点 $ i $，其角度缺损定义为：</p> \[\Omega_i = 2\pi - \sum_{ijk \in \text{St}(i)} \theta_i^{jk}\] <p>其中：</p> <ul> <li>$ \theta_i^{jk} $ 是顶点 $ i $ 在相邻三角形 $ ijk $ 中的内角，</li> <li>$ \text{St}(i) $ 表示顶点 $ i $ 的邻域（Star）。</li> </ul> <p>通过<strong>测地球（Geodesic Ball）</strong>的面积比较，离散高斯曲率 $ K_i $ 与角度缺损直接相关：</p> <p><strong>(1) 连续曲面的高斯曲率</strong></p> <p>在光滑曲面中，半径为 $ \epsilon $ 的测地球面积与平面圆面积 $ \pi \epsilon^2 $ 的偏差反映高斯曲率：</p> \[|B_g(\epsilon)| = \pi \epsilon^2 \left( 1 - \frac{K}{12} \epsilon^2 + O(\epsilon^3) \right)\] <p><strong>(2) 离散曲面的测地球面积</strong></p> <p>对于离散曲面：</p> <ul> <li> <table> <tbody> <tr> <td> <strong>欧几里得圆面积</strong>：$</td> <td>B_{\mathbb{R}^2}(\epsilon)</td> <td>= \pi \epsilon^2 $。</td> </tr> </tbody> </table> </li> <li> <p><strong>测地楔形面积</strong>（Geodesic Wedge）：顶点 $ i $ 的贡献为：</p> \[W_i(\epsilon) = \frac{\theta_i}{2\pi} \cdot \pi \epsilon^2 = \frac{1}{2} \epsilon^2 \theta_i\] <p>其中 $ \theta_i $ 是顶点邻域的总角度。</p> </li> <li> <p><strong>总测地球面积</strong>：</p> \[|B_g(\epsilon)| = \sum_i W_i(\epsilon) = \frac{\epsilon^2}{2} \sum_i \theta_i\] </li> </ul> <p><strong>(3) 曲率与角度缺损的关系</strong></p> <p>对比连续与离散的面积公式：</p> \[\frac{\epsilon^2}{12} K_i \approx 1 - \frac{\sum_i \theta_i}{2\pi}\] <p>整理后得到：</p> \[\Omega_i = 2\pi - \sum_i \theta_i = \frac{\pi}{6} \epsilon^2 K_i\] <p>可以把角缺陷看作一种积分曲率：它不是在一点上给出曲率的瞬时值，而是将曲率在顶点周围的小邻域上积分后的结果。这样角缺陷就自然对应于光滑曲面上的高斯曲率积分（即Gauss-Bonnet定理中的项），为离散几何提供了与连续曲率概念一致的几何直觉。</p> <h4 id="边界曲率的离散化">边界曲率的离散化</h4> <p><strong>边界顶点特性</strong>：</p> <ol> <li> <strong>高斯曲率为零</strong>：<br> 边界邻域可展平到平面（无角度缺损，$ \Omega_i = 0 $）。</li> <li> <p><strong>测地曲率（Geodesic Curvature）</strong>：<br> 通过边界顶点的<strong>外角缺损</strong>定义：</p> \[\kappa_i = \pi - \sum_{ijk \in \text{Boundary}} \theta_i^{jk}\] <p><strong>物理意义</strong>：度量边界“弯曲程度”（如直边 $ \kappa_i = 0 $）。</p> </li> </ol> <p><strong>离散高斯-博内定理（带边界）</strong>：</p> \[\sum_{i \in \text{Interior}} \Omega_i + \sum_{i \in \text{Boundary}} \kappa_i = 2\pi \chi\] <p><strong>高斯曲率的近似方法对比</strong></p> <table> <thead> <tr> <th><strong>方法</strong></th> <th><strong>优点</strong></th> <th><strong>缺点</strong></th> </tr> </thead> <tbody> <tr> <td><strong>角度缺损法</strong></td> <td>严格满足离散高斯-博内定理</td> <td>仅对特定顶点价数（4或6）收敛到连续曲率</td> </tr> <tr> <td><strong>二次曲面拟合</strong></td> <td>更接近光滑曲率定义</td> <td>不保证全局拓扑性质（如高斯-博内定理）</td> </tr> <tr> <td><strong>基于Mollification</strong></td> <td>物理直观（如Steiner公式）</td> <td>计算复杂</td> </tr> </tbody> </table> <ul> <li> <strong>无统一最优方法</strong>，需根据应用选择（如拓扑分析优先角度缺损法，几何建模可选拟合方法）。</li> <li> <strong>角度缺损法</strong>因保留拓扑性质，在理论推导中更受青睐。</li> </ul> <h3 id="curvature-normals">Curvature Normals</h3> <p><strong>三种基本曲率法向量</strong></p> <p>在微分几何中，曲面的几何信息可通过以下三种2-形式（2-forms）自然表达：</p> <table> <thead> <tr> <th><strong>类型</strong></th> <th><strong>光滑形式</strong></th> <th><strong>离散形式</strong></th> <th><strong>物理意义</strong></th> </tr> </thead> <tbody> <tr> <td><strong>面积法向量</strong></td> <td>$ \frac{1}{2} df \wedge df = N \, dA $</td> <td>$ \frac{1}{6} \sum_{ijk} f_j \times f_k $ （顶点邻域叉积和）</td> <td>曲面的定向面积</td> </tr> <tr> <td><strong>平均曲率法向量</strong></td> <td>$ \frac{1}{2} df \wedge dN = HN \, dA $</td> <td>$ \frac{1}{2} \sum_{ij} (\cot \alpha_{ij} + \cot \beta_{ij})(f_i - f_j) $</td> <td>曲面的平均弯曲程度</td> </tr> <tr> <td><strong>高斯曲率法向量</strong></td> <td>$ \frac{1}{2} dN \wedge dN = KN \, dA $</td> <td>$ \frac{1}{2} \sum_{ij} \frac{\varphi_{ij}}{\ell_{ij}} (f_j - f_i) $</td> <td>曲面的内在曲率（如“尖峰”或“鞍部”）</td> </tr> </tbody> </table> <p><strong>主曲率方向（Principal Directions）</strong></p> <ul> <li> <strong>定义</strong>：主方向 $ X_1, X_2 $ 是曲面上弯曲最大和最小的方向，对应主曲率 $ \kappa_1, \kappa_2 $。</li> <li> <p><strong>关键关系</strong>：法向量的微分与曲面微分通过<strong>Weingarten方程</strong>关联：</p> \[dN(X_i) = -\kappa_i \, df(X_i)\] <p>这一关系是推导曲率法向量的核心。</p> </li> </ul> <p><strong>面积法向量的推导</strong></p> \[df \wedge df(X_1, X_2) = df(X_1) \times df(X_2) - df(X_2) \times df(X_1) = 2 \, df(X_1) \times df(X_2) = 2N dA\] <p><strong>平均曲率法向量的推导</strong> \(\begin{align*} df \wedge dN(X_1, X_2) &amp;= df(X_1) \times dN(X_2) - df(X_2) \times dN(X_1) \\ &amp;= -\kappa_2 df(X_1) \times df(X_2) + \kappa_1 df(X_2) \times df(X_1) \\ &amp;= (\kappa_1 + \kappa_2) \, df(X_1) \times df(X_2) \\ &amp;= 2H \, N \, dA(X_1, X_2) \end{align*}\)</p> <p><strong>高斯曲率法向量的推导</strong></p> \[\begin{align*} dN \wedge dN(X_1, X_2) &amp;= dN(X_1) \times dN(X_2) - dN(X_2) \times dN(X_1) \\ &amp;= \kappa_1 \kappa_2 \, df(X_1) \times df(X_2) - \kappa_2 \kappa_1 \, df(X_2) \times df(X_1) \\ &amp;= 2K \, N \, dA(X_1, X_2) \end{align*}\] <h4 id="离散化的实现">离散化的实现</h4> <p><strong>面积法向量（离散）</strong></p> <p>对顶点 $ i $ 的邻域面求和：</p> \[N_i = \frac{1}{6} \sum_{ijk \in \text{St}(i)} f_j \times f_k\] <p><strong>平均曲率法向量（离散）</strong></p> <p>通过 <strong>cotangent公式</strong>：</p> \[(HN)_i = \frac{1}{2} \sum_{ij \in E} (\cot \alpha_{ij} + \cot \beta_{ij})(f_i - f_j)\] <ul> <li> <strong>推导依据</strong>： <ul> <li>积分 $ HN $ 对偶单元时，cotangent权重来自对偶边与原始边的长度比。</li> <li>与Laplace-Beltrami算子 $ \Delta f = 2HN $ 的离散化一致。</li> </ul> </li> </ul> <p><strong>高斯曲率法向量（离散）</strong></p> <p>假设法向量沿边在单位球面上弧线运动：</p> \[(KN)_i = \frac{1}{2} \sum_{ij \in E} \frac{\varphi_{ij}}{\ell_{ij}} (f_j - f_i)\] <ul> <li> <strong>关键区别</strong>： <ul> <li>法向量 $ N $ 的非线性变化由二面角 $ \varphi_{ij} $ 描述。</li> <li>边长 $ \ell_{ij} $ 归一化保证尺度不变性。</li> </ul> </li> </ul> <h3 id="steiners-formula">Steiner’s Formula</h3> <p>对于多面体（离散曲面），直接求导得到的曲率要么为零（平面上），要么无定义（顶点/边处）。</p> <p><strong>Steiner方法</strong>通过以下步骤定义离散曲率：</p> <ol> <li> <strong>平滑化（Mollification）</strong>：<br> 将多面体与半径为 $ \varepsilon $ 的球 $ B_\varepsilon $ 做 <strong>Minkowski求和</strong>（即 $ P + B_\varepsilon $），得到一个光滑逼近的曲面。</li> <li> <strong>极限分析</strong>：<br> 计算平滑后曲面的曲率，并取 $ \varepsilon \to 0 $ 的极限，提取离散曲率的合理定义。</li> </ol> <p><strong>Minkowski求和与体积增长</strong></p> <p>对于凸体 $ A \subset \mathbb{R}^n $，其Minkowski求和的体积可表示为 $ \varepsilon $ 的多项式（<strong>Steiner公式</strong>）：</p> \[\text{Vol}(A + B_\varepsilon) = V_0 + \varepsilon \Phi_1 + \varepsilon^2 \Phi_2 + \cdots + \varepsilon^n \Phi_n\] <ul> <li> <p><strong>系数 $ \Phi_k $</strong>：称为 <strong>quermassintegrals</strong>，描述不同维度（面、边、顶点）对体积增长的贡献。</p> </li> <li> <p><strong>与曲率的关系</strong>：</p> <ul> <li>$ \Phi_1 $：表面积（零阶曲率）。</li> <li>$ \Phi_2 $：总平均曲率。</li> <li>$ \Phi_3 $：总高斯曲率（三维时为 $ 4\pi $ 的倍数）。</li> </ul> </li> </ul> <p><strong>多面体的Steiner多项式（三维）</strong></p> <p>对多面体 $ P $，平滑后的体积增长分解为：</p> \[\text{Vol}(P + B_\varepsilon) = V_0 + \varepsilon A + \frac{1}{2} \varepsilon^2 \sum_{\text{edges } ij} \ell_{ij} \varphi_{ij} + \frac{1}{3} \varepsilon^3 \sum_{\text{vertices } i} \Omega_i\] <ul> <li> <p><strong>各项意义</strong>：</p> <table> <thead> <tr> <th><strong>项</strong></th> <th><strong>几何贡献</strong></th> <th><strong>对应曲率</strong></th> </tr> </thead> <tbody> <tr> <td>$ \varepsilon A $</td> <td>面的“平板”体积（厚度 $ \varepsilon $）</td> <td>面积（零阶曲率）</td> </tr> <tr> <td>$ \varepsilon^2 $</td> <td>边的“圆柱楔”体积（$ \ell_{ij} \varphi_{ij} $）</td> <td>平均曲率（边弯曲）</td> </tr> <tr> <td>$ \varepsilon^3 $</td> <td>顶点的“球锥”体积（$ \Omega_i $）</td> <td>高斯曲率（顶点缺陷）</td> </tr> </tbody> </table> </li> </ul> <p><strong>非凸多面体</strong>：公式依然成立，但需注意符号（如二面角 $ \varphi_{ij} $ 可能为负）。</p> <p><strong>曲率提取与几何意义</strong></p> <p>通过对体积多项式的微分得到曲率：</p> \[\begin{align*} \text{Area}_\varepsilon &amp;= \frac{d}{d\varepsilon} \text{Vol}_\varepsilon = A + \varepsilon \sum \ell_{ij} \varphi_{ij} + \varepsilon^2 \sum \Omega_i, \\ \text{Mean Curvature}_\varepsilon &amp;= \frac{1}{2} \frac{d}{d\varepsilon} \text{Area}_\varepsilon = \frac{1}{2} \sum \ell_{ij} \varphi_{ij} + \varepsilon \sum \Omega_i, \\ \text{Gauss Curvature}_\varepsilon &amp;= \frac{d}{d\varepsilon} \text{Mean Curvature}_\varepsilon = \sum \Omega_i. \end{align*}\] <ul> <li> <strong>当 $ \varepsilon \to 0 $</strong>： <ul> <li> <strong>总平均曲率</strong>：$ \frac{1}{2} \sum \ell_{ij} \varphi_{ij} $（边贡献）。</li> <li> <strong>总高斯曲率</strong>：$ \sum \Omega_i $（顶点角度缺损）。</li> </ul> </li> </ul> <p><strong>曲面上的Steiner公式</strong></p> <p>对光滑曲面 $ f: M \to \mathbb{R}^3 $，沿法向偏移 $ f_t = f + tN $ 时，面积变化为：</p> \[dA_t = (1 + 2tH + t^2 K) \, dA_0\] <ul> <li> <strong>几何解释</strong>： <ul> <li>$ df \wedge df $：原始面积。</li> <li>$ df \wedge dN $：平均曲率（“混合面积”）。</li> <li>$ dN \wedge dN $：高斯曲率（球面像面积）。</li> </ul> </li> </ul> <h3 id="几何微分的基本原理">几何微分的基本原理</h3> <ol> <li> <strong>方向</strong>：确定使几何量变化最快的移动方向</li> <li> <strong>大小</strong>：计算在该方向上变化的速率</li> <li> <strong>合成</strong>：将方向与大小结合得到梯度向量</li> </ol> <p>这种方法避免了繁琐的偏导数计算，直接利用几何直观解决问题。</p> <h4 id="角度导数的几何推导">角度导数的几何推导</h4> <p>计算两点(b,a)和(c,a)之间夹角θ关于点a坐标的梯度：</p> <ol> <li> <strong>方向</strong>：垂直于ab连线（这是改变角度最有效的方向）</li> <li> <table> <tbody> <tr> <td> <strong>大小</strong>：1/</td> <td>b-a</td> <td>（源自圆周运动的角度变化率）</td> </tr> </tbody> </table> </li> <li> <table> <tbody> <tr> <td> <strong>合成</strong>：∇ₐθ = J(b-a)/</td> <td>b-a</td> <td>²，其中J是90度旋转矩阵</td> </tr> </tbody> </table> </li> </ol> <h4 id="微分策略比较">微分策略比较</h4> <table> <thead> <tr> <th>方法</th> <th>优点</th> <th>缺点</th> </tr> </thead> <tbody> <tr> <td>闭式微分</td> <td>快速准确</td> <td>耗时，难以修改</td> </tr> <tr> <td>自动微分</td> <td>准确高效</td> <td>需要修改代码</td> </tr> <tr> <td>数值微分</td> <td>直接可用</td> <td>不精确，成本高</td> </tr> <tr> <td>符号微分</td> <td>精确</td> <td>表达式可能过于复杂</td> </tr> </tbody> </table> <p>几何微分融合了闭式微分的效率与几何直观性，是处理几何问题的理想选择。</p> <h3 id="curvature-variations">Curvature Variations</h3> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>体积 -&gt; 面积 -&gt; 平均曲率 -&gt; 高斯曲率 -&gt; 0
</code></pre></div></div> <h4 id="离散体积的梯度">离散体积的梯度</h4> <p>对于离散曲面网格，顶点i处的<strong>体积梯度</strong>可表示为：</p> \[\nabla_i V = \frac{1}{6} \sum (f_j \times f_k) = N_i A_i\] <p>这个等式建立了三个关键几何量的联系：</p> <ol> <li> <strong>体积变化率</strong>（左项）：顶点移动时包围体积的变化</li> <li> <strong>向量面积</strong>（中项）：通过相邻三角形边界的叉积和</li> <li> <strong>法向量积分</strong>（右项）：顶点邻域的法向量面积分</li> </ol> <p>当移动一个顶点时，体积变化主要来自相邻四面体的体积变化,这是离散版本的$\delta V = N \mathrm{d}A$</p> <h4 id="离散面积的梯度">离散面积的梯度</h4> <p>对于离散曲面，顶点 $i$ 的<strong>面积梯度</strong>可以用两种互补的形式表示：</p> \[\nabla_i A = \sum_{\triangle} \frac{1}{2} N_i \times e_i = \frac{1}{2} \sum_{j \in \mathcal{N}(i)} (\cot \alpha_{ij} + \cot \beta_{ij})(f_i - f_j)\] <p>其中，第一个求和遍历以 $i$ 为顶点的三角形，第二个求和遍历与顶点 $i$ 相邻的边。</p> <p><strong>单个三角形的面积梯度：</strong></p> <ul> <li>若移动顶点 $p$，其引起的面积变化率为</li> </ul> \[\nabla_p A = \frac{1}{2} N \times e\] <ul> <li>方向垂直于对边 $e$ 和三角形法向 $N$，即沿高度方向。</li> <li> <table> <tbody> <tr> <td>大小与对边长度成正比（因为 $A = \frac{1}{2}</td> <td>e</td> <td>h$）。</td> </tr> </tbody> </table> </li> </ul> <p><strong>整体曲面的面积梯度：</strong></p> <ul> <li>是相邻三角形梯度的线性叠加。</li> <li>可以简洁地重写为边权重形式，权重为 $\cot \alpha + \cot \beta$。</li> <li>这些余切权重不仅压缩了几何信息，还编码了局部曲率特征。</li> </ul> <h5 id="曲率与变分的几何联系">曲率与变分的几何联系</h5> <ul> <li>这样我们在离散中完美复现了光滑几何中的关系 $\delta A = HN$。</li> <li>其中 $\frac{1}{2}(\cot \alpha + \cot \beta)$ 就是离散平均曲率密度。</li> <li>梯度方向给出了面积最速下降的“展平”方向，自然成为形变优化的驱动场。</li> </ul> <h4 id="离散平均曲率的梯度">离散平均曲率的梯度</h4> <p>离散曲面的<strong>总平均曲率</strong>由边积分给出：</p> \[H_{total} = \frac{1}{2} \sum \ell_{ij} \varphi_{ij}\] <p>其中$\ell_{ij}$为边长，$\varphi_{ij}$为二面角。</p> <h5 id="schläfli公式的深刻内涵与应用">Schläfli公式的深刻内涵与应用</h5> <p>对于$\mathbb{R}^3$中的闭多面体，在顶点任意运动下保持：</p> \[\sum \ell_{ij} \mathrm{d} \varphi_{ij} = 0\] <p>其中$\ell_{ij}$为边长度，$\varphi_{ij}$为对应的二面角。 因此梯度简化为纯边长度变化项。</p> <p>对于顶点位置$ f_i $，总平均曲率的梯度为：</p> \[\nabla_{f_i} H_{\text{total}} = \frac{1}{2} \sum_{j \in \mathcal{N}(i)} \frac{\varphi_{ij}}{\ell_{ij}} (f_i - f_j)\] <p>其中：</p> <ul> <li>$\varphi_{ij}$是边$ij$的二面角</li> <li>$\ell_{ij}$是边长度</li> <li>$\mathcal{N}(i)$表示顶点$i$的邻域</li> </ul> <ol> <li> <strong>Schläfli公式</strong>： <ul> <li>原始表达式包含两项：边长变化和二面角变化</li> <li>根据Schläfli公式，二面角变化项相互抵消</li> <li>最终仅保留边长变化主导的简洁形式</li> </ul> </li> <li> <strong>曲率流</strong>： <ul> <li>梯度方向自动指向最优曲率调节方向</li> <li>权重系数$\varphi_{ij}/\ell_{ij}$编码了局部曲率信息</li> <li>完美再现连续情形的$\delta \text{mean} = KN$关系</li> </ul> </li> </ol> <h4 id="离散高斯曲率的拓扑不变性">离散高斯曲率的拓扑不变性</h4> <p>离散曲面的<strong>总高斯曲率</strong>由顶点角缺陷求和：</p> \[K_{\text{total}} = \sum_{i} (2\pi - \sum_{jk} \theta_i^{jk})\] <p>其中$\theta_i^{jk}$是顶点$i$处三角形$ijk$的内角。</p> <p><strong>离散高斯-博内定理</strong></p> <p>该定理揭示：</p> \[K_{\text{total}} = 2\pi\chi\] <p>其中欧拉示性数$\chi = V - E + F$是拓扑不变量。</p> <h4 id="关键性质">关键性质</h4> <ol> <li> <strong>梯度为零</strong>： <ul> <li>任意顶点运动下$K_{\text{total}}$保持不变</li> <li>变分序列自然终止：$\delta \text{Gauss} = 0$</li> </ul> </li> <li> <strong>几何解释</strong>： <ul> <li>局部角缺陷变化相互抵消</li> <li>保持整体拓扑约束不变</li> <li>反映曲面的内在刚性</li> </ul> </li> </ol> <h3 id="曲率流">曲率流</h3> <ol> <li> <strong>曲率计算</strong>：在每个顶点处评估曲率量（平均/H/Gauss曲率）</li> <li> <strong>运动方向</strong>：沿法向移动顶点 $ f_i^{k+1} = f_i^k - \tau \nabla E $</li> <li> <strong>迭代优化</strong>：重复直至收敛</li> </ol> <h4 id="数值实现关键">数值实现关键</h4> <p>采用前向欧拉格式：</p> <p>$ \frac{f_i^{k+1} - f_i^k}{τ} = - \nabla_{f_i} E(f^k) $</p> <p>其中梯度项自动包含曲率信息：</p> <ul> <li> <strong>平均曲率流</strong>：$ \nabla A = HN $</li> <li> <strong>Willmore流</strong>：$ \nabla(H^2) = \Delta H + 2H(H^2-K)N $</li> </ul> <h4 id="典型应用对比">典型应用对比</h4> <table> <thead> <tr> <th>流类型</th> <th>能量函数</th> <th>梯度表达式</th> <th>主要应用</th> </tr> </thead> <tbody> <tr> <td>平均曲率流</td> <td>表面积</td> <td>$ \frac{1}{2}∑(\cotα+\cotβ)(f_i-f_j) $</td> <td>表面平滑</td> </tr> <tr> <td>逆平均曲率流</td> <td>体积</td> <td>$ \frac{1}{6}∑(f_j×f_k) $</td> <td>体积膨胀</td> </tr> <tr> <td>Willmore流</td> <td>$ ∫H^2dA $</td> <td>包含双拉普拉斯项</td> <td>保特征平滑</td> </tr> </tbody> </table> <h4 id="willmore流的特殊处理">Willmore流的特殊处理</h4> <ol> <li> <strong>能量最小化</strong>：寻找$ ∫H^2dA $的临界点</li> <li> <strong>数值挑战</strong>：需要处理四阶导数项</li> <li> <strong>稳定技巧</strong>： <ul> <li>采用隐式时间积分</li> <li>添加面积约束项</li> <li>使用混合有限元离散化</li> </ul> </li> </ol> <p>这种基于曲率流的处理方法，通过几何量的自然变分实现了：</p> <ul> <li>噪声表面的自适应平滑</li> <li>特征结构的保持</li> <li>拓扑优化的自动化</li> </ul> <h3 id="总结">总结</h3> <p>离散微分几何通过统一的曲率框架，将连续曲面的几何特性（如高斯曲率、平均曲率）优雅地推广到离散网格，建立了基于顶点角缺陷、边二面角等几何量的离散曲率定义，并通过变分原理揭示了”体积→面积→平均曲率→高斯曲率”的层级关系，为曲面处理算法（如曲率流、网格平滑）提供了理论基础和高效实现方法，在计算机图形学、几何建模和物理仿真等领域具有重要应用价值。</p> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/Smooth_Curvatures/">DDG Smooth Curvatures</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/Discrete_Surfaces/">DDG Discrete Surfaces</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/exterior_derivative/">DDG k-Forms</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/DDG_Curvature/">DDG Curvature</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/Vector_Field/">DDG Vector-Valued Differential Forms</a> </li> <div id="giscus_thread" style="max-width: 800px; margin: 0 auto;"> <script>let giscusTheme=localStorage.getItem("theme"),giscusAttributes={src:"https://giscus.app/client.js","data-repo":"pasu/pasu.github.io","data-repo-id":"","data-category":"Comments","data-category-id":"","data-mapping":"title","data-strict":"1","data-reactions-enabled":"1","data-emit-metadata":"0","data-input-position":"bottom","data-theme":giscusTheme,"data-lang":"en",crossorigin:"anonymous",async:""},giscusScript=document.createElement("script");Object.entries(giscusAttributes).forEach(([t,e])=>giscusScript.setAttribute(t,e)),document.getElementById("giscus_thread").appendChild(giscusScript);</script> <noscript>Please enable JavaScript to view the <a href="http://giscus.app/?ref_noscript" rel="external nofollow noopener" target="_blank">comments powered by giscus.</a> </noscript> </div> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Guowei Lu. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script defer src="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?2930004b8d7fcd0a8e00fdcfc8fc9f24"></script> <script defer src="/assets/js/common.js?da39b660470d1ba6e6b8bf5f37070b6e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>