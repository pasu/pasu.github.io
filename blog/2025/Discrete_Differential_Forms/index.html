<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> DDG Discrete Differential Forms | Guowei Lu </title> <meta name="author" content="Guowei Lu"> <meta name="description" content="Personal website of Peter Lu "> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.css"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%87%AC%F0%9F%87%B1&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://pasu.github.io/blog/2025/Discrete_Differential_Forms/"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?0afe9f0ae161375728f7bcc5eb5b4ab4"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Guowei</span> Lu </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">Blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">Publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">CV </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fa-solid fa-moon"></i> <i class="fa-solid fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">DDG Discrete Differential Forms</h1> <p class="post-meta"> April 24, 2025 </p> <p class="post-tags"> <a href="/blog/2025"> <i class="fa-solid fa-calendar fa-sm"></i> 2025 </a>   ·   <a href="/blog/tag/geometry"> <i class="fa-solid fa-hashtag fa-sm"></i> Geometry</a>     ·   <a href="/blog/category/ddg"> <i class="fa-solid fa-tag fa-sm"></i> DDG</a>   </p> </header> <article class="post-content"> <div id="markdown-content"> <h3 id="为什么我们需要-discrete-exterior-calculus">为什么我们需要 Discrete Exterior Calculus？</h3> <p>经过之前的学习，我们已经理解了 <strong>exterior calculus</strong>，能够在光滑流形上实现 <em>k-form</em> 下的微分和积分表达，其求解问题则转化为一个关于 <em>differential forms</em> 的微分方程。</p> <p>但问题在于：</p> <ul> <li>即使是非常简单的微分方程，也往往难以手工求解！（更别说复杂情况了……）</li> <li>如果这些方程涉及实际测量数据（例如 domain geometry），那么手工求解几乎不可能完成。</li> <li>因此，我们需要借助计算机来<strong>数值逼近</strong>这些方程的解。</li> </ul> <p><strong>Discrete Exterior Calculus (DEC)</strong> 就是在这种背景下提出的，其核心思路是：</p> <ul> <li>使用 <strong>mesh</strong>（网格）代替连续的定义域 —— 通常是一个有向的 <strong>simplicial complex</strong>（单纯形复形）；</li> <li>使用网格上各 <em>k-simplex</em> 的数值来代替光滑的 <strong>differential k-form</strong>；</li> <li>使用稀疏矩阵来代替微分算子 —— 例如，用带符号的邻接矩阵（signed incidence matrix）来表达 <em>exterior derivative</em>（外导数）。</li> </ul> <p>通过这种方式，DEC 可以让我们在任意复杂曲面甚至非欧几何背景下，结构良好地离散化和求解微分形式相关的物理和几何问题。</p> <hr> <h3 id="basic-operations--composition-of-operators">Basic Operations &amp; Composition of Operators</h3> <p>在上一节我们看到了 DEC 的总体动机，本节我们进一步了解它的基本操作构建和常见算子的组合方式。</p> <h4 id="如何将光滑形式替换为离散表示">如何将光滑形式替换为离散表示</h4> <p>在 DEC 中，我们用下列方式将连续几何中的微分对象转化为离散表示：</p> <ul> <li>使用 <strong>oriented simplicial complex</strong>（有向单纯形复形）作为离散的计算网格；</li> <li>将 <em>differential k-form</em> 替换为网格中每个 <em>k-simplex</em> 上的一个数值 —— 这些称为 <strong>discrete differential forms</strong>；</li> <li>将微分算子（如 <em>exterior derivative</em>）表示为稀疏矩阵 —— 最常见的就是 <strong>signed incidence matrix</strong>（带符号邻接矩阵）。</li> </ul> <p>这些操作使得我们可以把原本复杂的几何和物理过程，转换为标准的线性代数问题。</p> <p>如上图，我们定义四个顶点（vertices）:</p> <ul> <li>$ v_0 = 0 $</li> <li>$ v_1 = 1 $</li> <li>$ v_2 = 2 $</li> <li>$ v_3 = 3 $</li> </ul> <p>对应的两个三角形（faces）:</p> <ul> <li>$ f_0 = {v_0, v_1, v_2} $</li> <li>$ f_1 = {v_0, v_2, v_3} $</li> </ul> <p>对应的5个 <strong>oriented edges</strong>:</p> <table> <thead> <tr> <th>Edge</th> <th>Orientation</th> <th>Index</th> </tr> </thead> <tbody> <tr> <td>$ e_0 $</td> <td>$ v_0 \rightarrow v_1 $</td> <td>0</td> </tr> <tr> <td>$ e_1 $</td> <td>$ v_1 \rightarrow v_2 $</td> <td>1</td> </tr> <tr> <td>$ e_2 $</td> <td>$ v_2 \rightarrow v_0 $</td> <td>2</td> </tr> <tr> <td>$ e_3 $</td> <td>$ v_0 \rightarrow v_3 $</td> <td>3</td> </tr> <tr> <td>$ e_4 $</td> <td>$ v_3 \rightarrow v_2 $</td> <td>4</td> </tr> </tbody> </table> <p>现在通过如上这个例子介绍算子。</p> <h4 id="基本算子dd-和-hodge-star">基本算子：d₀、d₁ 和 Hodge Star</h4> <p>我们先来看两个最基本的 <strong>离散外导数</strong>（discrete exterior derivative）矩阵：</p> <h5 id="dvertex--edge">d₀：Vertex → Edge</h5> <p>它是一个边对顶点的邻接矩阵，每一行对应一条有向边，每一列对应一个顶点。如果某条边的起点是顶点 $v_i$，终点是 $v_j$，则该行在 $i$ 位置是 $-1$，在 $j$ 位置是 $+1$。</p> \[d_0 = \begin{bmatrix} -1 &amp; +1 &amp; 0 &amp; 0 \\ 0 &amp; -1 &amp; +1 &amp; 0 \\ +1 &amp; 0 &amp; -1 &amp; 0 \\ -1 &amp; 0 &amp; 0 &amp; +1 \\ 0 &amp; 0 &amp; -1 &amp; +1 \\ \end{bmatrix}\] <p>这是离散版本的 <strong>gradient</strong>（梯度）操作。</p> <h5 id="dedge--face">d₁：Edge → Face</h5> <p>每一行对应一个三角形（face），每一列对应一条边。每个三角形的边若与其方向一致，则为 $+1$，否 则为 $-1$。</p> \[d_1 = \begin{bmatrix} +1 &amp; +1 &amp; -1 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; -1 &amp; +1 &amp; -1 \\ \end{bmatrix}\] <p>这是离散版本的 <strong>curl</strong>（旋度）操作。</p> <h5 id="hodge-star-star_k">Hodge Star ($\star_k$)</h5> <p>Hodge 星号算子将 <strong>primal k-form</strong> 映射为 <strong>dual (n–k)-form</strong>。在离散中，它通常表现为一个 <strong>对角矩阵</strong>，每一项表示 <em>dual cell</em> 与 <em>primal simplex</em> 之间的比例关系。例如：</p> <ul> <li>$\star_0$：顶点对应的 dual 面积；</li> <li>$\star_1$：边的 dual 长度 / 边的原始长度；</li> <li>$\star_2$：三角形面积的倒数。</li> </ul> <h4 id="组合操作gradcurldivlaplacian">组合操作：grad、curl、div、Laplacian</h4> <p>借助上面的基本矩阵，我们可以组合出熟悉的微分算子：</p> <ul> <li> <strong>grad</strong> = $ d_0 $：顶点函数 → 边的差值</li> <li> <strong>curl</strong> = $ \star_2 d_1 $：边上的 1-form → 三角形上的旋度（2-form）</li> <li> <strong>div</strong> = $ \star_0^{-1} d_0^\top \star_1 $：边上的 1-form → 顶点上的散度（0-form）</li> <li> <strong>Laplacian</strong> = $ \star_0^{-1} d_0^\top \star_1 d_0 $：离散 Poisson 方程中的主角</li> </ul> <h5 id="关于-divergence-的详细说明">关于 divergence 的详细说明</h5> <p>这个算子链：</p> \[\boxed{\text{div} = \star_0^{-1} d_0^\top \star_1}\] <p>的含义是：</p> <ol> <li> <strong>$\star_1$</strong>：将边上的 1-form 映射到 dual edge 上，编码了度量信息；</li> <li> <strong>$d_0^\top$</strong>：对应 gradient 的共轭操作，将边的信息“聚合”到每个顶点；</li> <li> <strong>$\star_0^{-1}$</strong>：把顶点的聚合值归一化为散度密度（例如除以顶点周围 dual 面积）。</li> </ol> <p>所以这个算子表达的是<strong>顶点处的净流出强度</strong>，它是 gradient 的 adjoint，符合离散散度的物理意义。</p> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/exterior_derivative/">DDG k-Forms</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/ddg_manifold/">DDG Manifold</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/ddg_k_forms/">DDG k-Forms</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/ddg_exterior/">DDG Exterior Algebra</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/integration/">DDG Integration</a> </li> <div id="giscus_thread" style="max-width: 800px; margin: 0 auto;"> <script>let giscusTheme=localStorage.getItem("theme"),giscusAttributes={src:"https://giscus.app/client.js","data-repo":"pasu/pasu.github.io","data-repo-id":"","data-category":"Comments","data-category-id":"","data-mapping":"title","data-strict":"1","data-reactions-enabled":"1","data-emit-metadata":"0","data-input-position":"bottom","data-theme":giscusTheme,"data-lang":"en",crossorigin:"anonymous",async:""},giscusScript=document.createElement("script");Object.entries(giscusAttributes).forEach(([t,e])=>giscusScript.setAttribute(t,e)),document.getElementById("giscus_thread").appendChild(giscusScript);</script> <noscript>Please enable JavaScript to view the <a href="http://giscus.app/?ref_noscript" rel="external nofollow noopener" target="_blank">comments powered by giscus.</a> </noscript> </div> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Guowei Lu. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script defer src="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?2930004b8d7fcd0a8e00fdcfc8fc9f24"></script> <script defer src="/assets/js/common.js?da39b660470d1ba6e6b8bf5f37070b6e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>