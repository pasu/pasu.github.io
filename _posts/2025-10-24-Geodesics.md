---
layout: post
title: DDG Geodesics
\mathrm{d}Ate: 2025-10-24 10:27:00
tags: Geometry
categories: DDG
giscus_comments: true
related_posts: true
pretty_table: true
---

原课件来自：https://brickisland.net/ddg-web/

## 测地线（Geodesics）

测地线（Geodesics）是微分几何中的核心概念，它将“直线”的概念推广到弯曲的空间中。我们将从历史背景出发，逐步介绍测地线的基本性质、在不同几何空间中的表现，以及在离散曲面上的推广。

### Euclidean Geometry

欧几里得在《几何原本》中提出了五条基本公设，构建了整个平面几何的基础：

1. 两点之间可连一条直线段  
2. 线段可无限延伸成直线  
3. 可作圆  
4. 所有直角都相等  
5. 过直线外一点有且仅有一条平行线  

这些公设成为几何学的基石，直到两千年后人们才发现，第五条公设并非必然成立。

### Non-Euclidean Geometry

19世纪，罗巴切夫斯基、波约、高斯等人发现，平行公设无法由前四条公设推导得出，从而诞生了**非欧几何**：

- **椭圆几何**：过直线外一点没有平行线，所有直线都会相交  
- **双曲几何**：过直线外一点有无数条平行线  

这些几何空间中，“直线”即测地线，其行为与平面中截然不同。

### 带边界的区域上的测地线

在有边界的区域中，最短路径不一定是“直”的，它可能会沿着边界走。在内部区域中，测地线仍然是“最直”且“最短”的路径。

此时此刻，我正在听《悬日》，看到这张图，也会有一些莫名的失落。前阵子和高中同学闲聊，看到一个二中（我的高中）的学生拍的，其实一个镜头，在书桌上一张一张的整理试卷。面对时空，如果曾经熟悉的知识不再记得，还有必要再重学吗，就好像那些曾经解不出来的题，答案还那么重要吗。

### 等距不变性（Isometry Invariance）

等距变换是指保持内在几何不变的变形（如卷起地图）。**测地线在等距变换下保持不变**，即两点之间的最短路径不会因为曲面的等距变形而改变。

### 离散测地线（Discrete Geodesics）

在离散曲面（如三角网格）上，我们如何定义测地线？可以从以下几个角度出发：

- **最直**（零曲率/加速度）  
- **局部最短**  
- **无测地曲率**  
- **距离函数的梯度**  

然而，在离散情形下，**“最直”和“最短”这两个性质并不总是一致的**，这导致我们需要不同的数值算法来求解。

### 局部最短路径

在欧几里得空间中，一条线段可以被定义为两点之间的**最短路径**。但是，我们如何描述一整条**直线**呢？直线是没有端点的。

这里的答案在于 **“局部”** 的视角：

*   **局部最短**：对于路径上的任意两个“足够近”的点，你都无法找到一条连接它们且更短的路径。
    *   “足够近”在这里有一个技术性的要求：即在这两点之间，**最短路径是唯一的**。
*   **从局部到整体**：这条性质为我们定义（光滑或弯曲空间中的）测地线提供了一种可能的方式：**测地线是一条局部最短的曲线**。

**至关重要的区别：**
*   **局部最短**并不等同于**全局最短**。
*   一条连接A和B的曲线，可能在其上的每一小段都是最短的，但整体来看，可能存在一条从A直接到B的、更短的完全不同的路径。

**结论：**
无论是全局最短还是局部最短的路径，在它们的局部范围内，都属于**测地线**。

### 狄利克雷能量与曲线长度

对于一条平面曲线 $\gamma: [0, 1] \rightarrow \mathbb{R}^2$，其**狄利克雷能量**定义为：
$$
E_D(\gamma) = \int_0^1 |\gamma'(t)|^2  dt
$$

可以将任何曲线 $\gamma$ 表示为单位速度曲线的重新参数化：

$$
\begin{align*}
\text{单位速度曲线} & \quad \hat{\gamma}: [0, L] \rightarrow \mathbb{R}^2 \\
\text{速度函数} & \quad c: [0, 1] \rightarrow \mathbb{R}, \quad c(0) = 0,  c(1) = L \\
\text{参数化} & \quad \gamma(t) = \hat{\gamma}(c(t)) \\
\text{速度大小} & \quad |\gamma'(t)| = |c'(t)|
\end{align*}
$$

寻找最平滑的曲线：
$$
\min_{\gamma} E_D(\gamma) = \min_{\hat{\gamma}} \left( \min_{c} \int_0^1 \frac{(c'(t))^2}{L}  dt \right) = \min_{\hat{\gamma}} L^2
$$

> **关键洞察**：对于一条曲线，最小化狄利克雷能量等价于最小化其长度
> $$
> \min E_D(\gamma) \iff \min \text{Length}(\gamma)
> $$

在弯曲流形 $(M, g)$ 上，狄利克雷能量为：
$$
E_D(\gamma) = \int_0^1 |\gamma'(t)|^2  dt = \int_0^1 g\left( \gamma'(t), \gamma'(t) \right)  dt
$$

**几何意义**：测地线是狄利克雷能量的临界点（谐和曲线），但在弯曲空间中可能不再是全局最小点。

### 最短测地线 --- 变分视角

#### 平面情形

考虑曲线 $\gamma(t): [0,1] \rightarrow \mathbb{R}^2$，通过最小化狄利克雷能量来寻找固定端点 $\gamma(0)=p$，$\gamma(1)=q$ 的最短路径：

$$
\min_{\gamma} \int_{0}^{1} |\gamma'(t)|^2  dt
$$

**推导过程：**
- 通过分部积分可得等价形式：
  $$
  \min_{\gamma} - \int_{0}^{1} \langle \gamma(t), \gamma''(t) \rangle  dt
  $$
- 对 $\gamma$ 取梯度，得到一维泊松方程

> **核心思想**：测地线是调和函数

#### 弯曲曲面情形

在弯曲流形 $(M, g)$ 上，故事本质上相同：

- 考虑可微曲线 $\gamma: [0,1] \rightarrow M$
- 狄利克雷能量为：
  $$
  E_D(\gamma) = \int_0^1 |\gamma'(t)|^2  dt = \int_0^1 g\left( \gamma'(t), \gamma'(t) \right)  dt
  $$

**重要结论：**
- 测地线仍然是临界点（**调和**的）
- 但可能不再是**全局最小点**

**关键难点：** 测地线不再通过求解简单的线性方程（拉普拉斯方程）得到，**需要数值算法**。

**变分视角总结：**
- 平面中：测地线 = 线性函数 = 狄利克雷能量的最小化子
- 弯曲曲面中：测地线 = 狄利克雷能量的临界点（调和曲线）
- 从线性到非线性：需要从解析解转向数值计算

#### 离散最短路径---边值问题

- **局部最短路径：** 可以通过迭代拉直Dijkstra路径直到无法进一步改进
- **全局最短路径：** 需要更复杂的方法

#### 离散最短路径---顶点处的行为

在顶点附近，即使是局部最短路径也需要特别注意---行为取决于**角缺陷** $\Omega$：

**平坦顶点 ($\Omega = 0$)**
- 最短路径直接穿过顶点
- $\Omega_i = 2\pi - \sum_{ijk} \theta_i^{jk}$

**锥形顶点 ($\Omega > 0$)**
- 总是从一侧绕行更快
- **从不穿过**顶点

**鞍点顶点 ($\Omega < 0$)**
- 总是有**许多**局部最短路径通过鞍点顶点

#### 多面体最短测地线算法

将Dijkstra算法推广到包含穿过三角形的路径:

- **MMP算法** (Mitchell, Mount, Papadimitriou, 1986)
- 复杂度：$O(n^2 \log n)$
- **核心思想：** 跟踪公共测地线路径的区间或"窗口"

#### 最短测地线---光滑vs离散对比

##### 光滑情形

从源点 $p$ 到不同点 $p_1, p_2$ 的两条最小测地线 $\gamma_1, \gamma_2$：

- 仅当 $\gamma_1 \subseteq \gamma_2$ 或 $\gamma_2 \subseteq \gamma_1$ 时才会相交

##### 离散情形

- 多条测地线可以在鞍点顶点处重合（"伪源点"）

> **重要提示：** 多面体最短测地线可能无法忠实捕捉光滑测地线的行为

### 闭合测地线

#### 光滑曲面理论

**定理** (Birkhoff, 1917)
- 每个光滑凸曲面都包含一条**简单闭合测地线**
- 即：不自交的测地线环（"Birkhoff赤道"）

**定理** (Lyusternik & Schnirelmann, 1929)  
- 实际上，**至少存在三条**简单闭合测地线
- 这个结果是**尖锐的**：在某些光滑曲面上确实只有三条

#### 离散情形的根本差异

**定理** (Galperin, 2002)
- **大多数**凸多面体**没有**简单闭合测地线
- （基于离散**最短**测地线的定义）

> **核心问题**：离散测地线的"最短"特征再次无法捕捉光滑情形的性质

**为什么离散情形不同？**

**约束1：** 最短测地线**不能**穿过凸顶点

**约束2：** 根据**高斯-博内定理**：

$$
\sum_{i \in V} \Omega_i + \sum_{i \in \partial V} \kappa_i = 2\pi\chi
$$

对于闭合测地线：
- 必须将顶点划分为两个集合
- 每个集合的**总角缺陷必须恰好等于 $2\pi$**

**结论：** 光滑微分几何中的经典定理在离散设定中往往不再成立，这推动了离散微分几何发展自身特有的理论体系。

### 割迹与单射半径

**割迹定义**

- 对于光滑曲面 $M$ 上的源点 $p$，**割迹**是所有满足以下条件的点 $q$ 的集合：
  - 在 $p$ 和 $q$ 之间**不存在唯一**的（全局）最短测地线

**单射半径定义**

- **单射半径**是到割迹上最近点的距离
- 衡量了从 $p$ 出发的测地线保持最短性的最大范围

#### 经典例子：球面

- 球面上任意点 $+p$ 的割迹是**对跖点** $-p$
- 单射半径覆盖整个半球面

### 离散割迹

**关键观察**
- 绕行**锥形顶点**（正曲率顶点，$\Omega_i > 0$）总是更短
- 因此，**永远不要直接穿过**锥形顶点

**理论意义**：割迹的研究揭示了离散度量几何与光滑微分几何之间的深刻差异，强调了在离散设定中重新审视经典概念的必要性。

### 中轴（Medial Axis）

**定义**
- 与割迹类似，区域（或曲面）的**中轴**是所有不具有**唯一**最近边界点的点 $p$ 的集合

**中轴球**
- 以中轴上点为球心
- 半径为到最近边界点的距离
- 是包含在区域内的最大内切球

**结构特点**
- 与割迹一样，结构可能**非常复杂**
- 通常具有**三个分支**

**对偶表示**
中轴提供了一种"对偶"的形状表示，可以从以下两者恢复原始形状：
- **中轴拓扑结构**
- **半径函数**

### 离散中轴

- **正方形**：由对角线和中线组成的骨架
- **圆形**：单一中心点
- **矩形**：类似正方形但比例不同的骨架
- **椭圆**：主要轴线

**非凸多边形的惊喜**
- 不再只是直线段！
- 出现抛物线弧等复杂曲线

### 三维中轴

**维度无关性**
- 定义适用于任意维度
- 提供形状的"骨架"概念

**计算挑战**
- 精确计算困难（涉及二次曲面片）
- 通常用**单纯复形**近似

#### 中轴计算算法

Voronoi图方法

1. 在边界上采样点
2. 计算Voronoi图
3. 保留"高瘦"单元的"短"面片

**收敛性**
- 采样足够密时，可获得正确的拓扑结构

#### 中轴与曲面重建

**从点云重建曲面**
- 连接沿"长边"相遇的"瘦长"单元中心
- 在三维中提供具有拓扑保证的曲面重建

**理论保证**
- 在足够多的采样点下，能够正确恢复原始曲面的拓扑

**总结**：中轴作为形状的内在骨架表示，在几何处理、形状分析和曲面重建中具有重要应用，但在离散设定中需要特殊的算法和理论来处理其与光滑情形的差异。

### 最直路径 (Straightest Paths)

在欧几里得空间中，直线可以被描述为"尽可能直"的曲线。如何将这一概念精确化并推广到流形中的曲线？

**两种等价描述：**
- **几何视角**：无曲率
- **动力学视角**：无加速度

**流形中的推广：**
- **几何视角**：无**测地曲率**
- **动力学视角**：**协变导数**为零

#### 几何视角详解

考虑曲面上的曲线 $\gamma(s)$，其切向量为 $T$，曲面法向量为 $N$，定义 $B := T \times N$。

**曲率分解：**
可以将曲线的"弯曲"分解为两个分量：

$$
\begin{align*}
k_n &:= \langle N, \frac{d}{ds} T \rangle \quad \text{法曲率} \\
k_g &:= \langle B, \frac{d}{ds} T \rangle \quad \text{测地曲率}
\end{align*}
$$

**几何解释：**
- **法曲率**：由曲面 $M$ 本身的曲率"强制"产生
- **测地曲率**：超出这一最小弯曲量的任何额外弯曲

> **核心思想**：测地线是满足 $k_g = 0$ 的曲线

**可视化对比：**
- **大法曲率 $k_n$，小测地曲率 $k_g$**：曲线紧密贴合曲面弯曲
- **大测地曲率 $k_g$，小法曲率 $k_n$**：曲线在曲面上额外弯曲

这一分解揭示了：
1. **内在vs外在**：测地曲率衡量曲线在曲面上的"内在"弯曲，与曲面在空间中的嵌入方式无关
2. **最直性**：测地线在曲面上尽可能直地行进，仅因曲面本身的弯曲而偏离"直线"路径
3. **局部特征**：测地曲率为零提供了判断曲线是否"直"的局部准则

这一几何视角为在离散曲面上定义"最直"路径奠定了理论基础。

### 离散曲面上的离散曲线

- 在单纯曲面 $M$ 上，离散曲线是**在每个单形内分段线性**的连续曲线 $\gamma$

**重要特性：**
- **不必是边路径**：可以穿过面片，在单个面片内有多个顶点等
- **灵活表示**：能够处理不同维度的单形序列

**编码方式：**
使用单形序列和重心坐标表示：

```
单形类型 | 重心坐标
---------|-----------
三角形 ilj | (0.1, 0.7, 0.2)  
边 ij    | (0.45, 0.55)
三角形 ijk | (0.40, 0.15, 0.45)  
顶点 k   | (1.00)
```
### 离散测地曲率

**平面曲线的离散曲率：**
- 定义为**转向角** $\kappa_i$

**单纯曲面上的推广：**
- 由于单纯曲面的大部分点**内在地平坦**，可以采用相同的定义
- **面片内**：直接测量线段间夹角
- **边穿越**："展开"相邻面片并测量角度
- **顶点处**：问题复杂——无法展开！

#### 从光滑到离散的转换

**光滑情形的挑战：**
- 光滑设定中：测地线 = 零测地曲率
- 离散设定中：在顶点处遇到困难（无法展开，某些顶点无最短路径）

**替代特征：**
光滑情形的另一种描述：曲线两侧具有相同角度

**离散自然推广：**
- 在曲线两侧具有**相等的角度和**
- 这提供了离散**最直**测地线的定义（Polthier & Schmies, 1998）