---
layout: post
title: DDG Conformal Geometry
\mathrm{d}Ate: 2025-09-24 10:27:00
tags: Geometry
categories: DDG
giscus_comments: true
related_posts: true
pretty_table: true
---

原课件来自：https://brickisland.net/ddg-web/

## 共形几何

### 从地图制作的难题说起

你是否曾想过一个问题：**我们如何将一颗圆圆的地球，摊平做成一张地图？**

这听起来简单，实则是一个困扰了人类几个世纪的几何难题。试着想象一下：如果你拿到一个完整的、饱满的橙子，现在要你把它的皮完整地剥下来，并且**不留任何褶皱或撕裂地摊平在桌面上**。你会发现，这几乎是不可能的。

这就是地图制作（Cartography）所面临的核心挑战：**球面在几何上是“不可展平”的**。任何一个试图将球面变为平面的过程，都不可避免地会引入以下一种或多种失真：

- **距离失真**（Distortion of Distances）
- **面积失真**（Distortion of Areas）
- **角度失真**（Distortion of Angles）
- **形状失真**（Distortion of Shapes）

如果你坚持“完全不切割、不撕裂”，那么你**必须接受某种形式的变形**。历史上所有经典的地图投影法——无论是墨卡托投影、等积投影还是方位投影，都只能**保留某些几何属性，而牺牲其他**。

例如，**墨卡托投影**保持了方向和角度（因此非常适合航海），但却严重扭曲了面积——这就是为什么在地图上格陵兰岛看起来比澳大利亚还要大，而实际上后者面积是前者的3.5倍。

那么，有没有一种映射方法，能够至少保证**角度是完全正确的**呢？

答案是：**有，这就是“共形映射”（Conformal Mapping）**。

共形映射是一类特殊的几何变换，它能够在每个局部保持**角度不变**。换句话说，在任何一点处，映射的效果都相当于一个**旋转加上均匀缩放**，而不会产生“剪切”或“拉扯”式的变形。

### 为什么偏偏是角度

在了解了地图制作中不可避免的失真之后，我们很自然地会问：在距离、面积、角度等多种几何属性中，**为什么数学家与工程师对“保持角度”如此情有独钟？**

共形映射之所以成为几何处理的核心工具，并非偶然。它集四大优势于一身：**质量高、简化性强、计算高效、理论完备**。

#### 1. 质量

**“保持角度”这一看似简单的条件，本身就蕴含了极强的正则性。**

- **无限光滑性**：任何一个共形映射都自动是无限次可微的。这意味着映射结果极其光滑，不会出现突兀的拐点或畸变。
- **调和尺度分布**：尽管长度会发生缩放，但这种缩放因子在整个区域上的分布是**调和函数**，满足拉普拉斯方程。这使得缩放是平滑、自然的，而非杂乱无章。

> 可以说，当你得到一个共形映射时，你得到的已经是一个“质量上乘”的映射了。

#### 2. 简化

在几何分析中，我们总是希望坐标系能尽可能简化问题。

- **对于曲线**，最理想的是**弧长参数化**，它让曲线的导数直接是单位切向量，极大简化计算。
- **对于曲面**，要实现弧长参数化（即等距映射）几乎是不可能的——除非曲面本身可展平，如圆柱面。

那么，曲面的“次优选择”是什么？**答案就是共形坐标**。

共形坐标允许曲面上的度量张量（用来测量长度和角度的尺子）在每个点处都只是一个**单一的缩放因子**，而不是一个复杂的2x2矩阵。你只需要跟踪一个标量函数（尺度函数），而不需要处理一个完整的雅可比矩阵。

> 这使得许多复杂的曲面微分方程在共形坐标下变得线性化、可求解，让“纸笔演算”成为可能。

#### 3. 效率

从数值计算的角度看，共形映射问题通常可以转化为：

- **稀疏线性系统**
- **稀疏特征值问题**
- **凸优化问题**

这些是数值分析中研究最透彻、求解最高效的问题类型。相比之下，追求“有界失真”或“局部单射”等更复杂的映射目标，往往会导致非线性、非凸的优化问题（如二阶锥规划SOCP），计算成本高昂，难以应用于实时或大规模场景。

> 共形映射在**效率**与**质量**之间取得了绝佳的平衡。

#### 4. 理论保障

共形几何不是一个新兴的、缺乏理论支撑的领域。相反，它背后有超过一个世纪的经典数学理论作为基石：

- **柯西-黎曼方程**将共形条件表述为清晰的偏微分方程。
- **黎曼映射定理**保证了单连通区域共形映射的存在性与唯一性。
- **单值化定理**指出任何曲面都可以共形地映射到三种标准几何之一（球面、欧氏平面、双曲平面），这为许多几何算法提供了**典则定义域**。

这些坚实的理论为我们提供了强大的保证，例如极值原理、Delaunay性质等，使得算法设计有章可循。

一个非常自然的疑问是：**既然无法完美保留所有属性，那为什么选择角度？保留面积不是同样有用吗？**

答案是：**仅保持面积的映射可以非常“糟糕”！**

- **极度不光滑**：面积保持映射甚至不需要是连续的。想象一下漩涡中不可压缩流体的运动：它保持体积（在2D中即面积），但可以产生极其复杂、甚至混沌的变形。
- **可能性空间过大**：满足面积不变的映射家族过于庞大，缺乏结构性。这反而使得寻找一个“优质”的面积保持映射变得异常困难。

> 就像一池被搅动的水，虽然每个水团的体积不变，但其形状和位置可以变得无比复杂，这显然不是我们想要的地图或参数化结果。

相比之下，**角度保持这一约束，自然而然地诱导出了光滑性、结构性和可计算性**。

#### 角度--几何的“指纹”

保持角度，看似放弃了对长度和面积的严格控制，实则**抓住了局部几何形态最核心的特征**。它就像是一个几何形状的“指纹”，在允许整体伸缩的自由度下，唯一地确定了形状的局部相似结构。

这种约束既不过于宽松（如仅保持面积会导致映射极度不规则），也不过于严格（如试图同时保持所有属性通常不可能），而是处于一个“恰到好处”的甜点区，使其成为几何处理中不可或缺的理想工具。

## 平滑理论

我们看到了二维共形映射的丰富性与灵活性。无论是平面到平面，还是曲面到平面，都存在大量非平凡的共形映射。这自然引出一个问题：**在三维或更高维的空间中，共形映射是否同样丰富？**

答案出乎意料地否定性的。高维空间中的共形映射具有极强的“刚性”，这由经典的**刘维尔定理**所揭示。

### **刘维尔定理**

> **定理（Liouville）**：当空间维数 $ n \geq 3 $ 时，任何从 $ \mathbb{R}^n $ 的一个区域到 $ \mathbb{R}^n $ 自身的共形映射，都必然是**莫比乌斯变换**。

莫比乌斯变换是我们熟悉的球极投影、平移、旋转、缩放和球面反演的复合。在三维空间中，这意味着所有可能的共形映射，其变换模式都已被完全分类，**除此之外，别无他物**。

这一定理背后的核心思想是：**在高维空间中，“保持角度”这一条件要苛刻得多。**

### 平面到平面的共形映射

#### 映射的微分

要理解共形性，首先需要理解映射的**微分**（differential）概念。对于一个可微映射 $ f: \mathbb{R}^2 \to \mathbb{R}^2 $，其微分 $ df $ 描述了如何将点 $ p $ 处的一个切向量 $ X $ “推前”到像点 $ f(p) $ 处。

- **几何直观**：想象在点 $ p $ 有一个无限小的箭头 $ X $。映射 $ f $ 会将点 $ p $ 移动到 $ f(p) $，同时也会以某种方式拉伸和旋转这个无限小的箭头。这个操作就是 $ df(X) $。
- **坐标表示**：微分 $ df $ 在坐标下就是映射的**雅可比矩阵**。它包含了所有关于局部伸缩和扭曲的信息。

#### 共形映射的等价定义

共形性有一个非常直观的几何定义：

> 一个映射是共形的，当且仅当以下两个操作的最终结果相同：
> 1.  先对一个切向量做**旋转**，再推前它。
> 2.  先推前这个切向量，再对它做**旋转**。

换句话说，**映射与旋转操作是可交换的**。这意味着，映射在局部所做的唯一事情就是**均匀缩放**和**旋转**，而不会产生“剪切”变形。

#### 用复数语言精确刻画

复数为表达这个条件提供了最自然的语言。我们将平面视为复平面 $ \mathbb{C} $，点的坐标用复数 $ z $ 表示。复数的乘法 $ z \cdot X $ 天然地表示了对向量 $ X $ 进行**旋转和缩放**。

于是，我们可以将共形条件精炼为：

> 考虑一个映射 $ f: \mathbb{C} \to \mathbb{C} $。那么 $ f $ 是共形的，当且仅当它的微分是**复线性**的，即对于所有切向量 $ X $ 和所有复数 $ z $，满足：
> $$
> df(z \cdot X) = z \cdot df(X)
> $$

这完美地捕捉了“先旋转缩放再推前”等于“先推前再旋转缩放”的思想。

#### 全纯 vs. 共形

这里有一个重要的术语区分：

- **全纯函数**：是复可微的函数，即导数 $ f'(z) $ 存在。这等价于满足**柯西-黎曼方程**。
- **共形映射**：是全纯函数，且其导数处处不为零（$ f'(z) \neq 0 $）。

**关键点**：在导数不为零的点，全纯函数确实是共形的（保持角度且定向）。但在导数 $ f'(z) = 0 $ 的点（称为临界点），角度保持性会被破坏（例如 $ f(z) = z^2 $ 在原点将角度加倍）。因此，**共形映射是处处保持角度的全纯映射**。

#### 例子：莫比乌斯变换

**莫比乌斯变换**是共形映射中最重要、最美丽的例子之一。

- **几何定义**：它是保持**定向**并将**圆周和直线**映射为**圆周或直线**的变换。（在复分析中，直线可视为半径为无穷大的圆）。
- **代数形式**：任何莫比乌斯变换都可以写成：
  
  $$
  z \mapsto \frac{a z + b}{c z + d}
  $$
  
  其中 $ a, b, c, d $ 是复数，且满足 $ ad - bc \neq 0 $（以保证非退化）。

莫比乌斯变换包括平移、旋转、缩放和**球极投影**等基本变换的复合。它们是复平面上共形自同构群的主要组成部分，并且在黎曼映射定理中扮演着核心角色。